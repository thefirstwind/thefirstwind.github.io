<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="https://thefirstwind.github.io//feed.xml" rel="self" type="application/atom+xml" /><link href="https://thefirstwind.github.io//" rel="alternate" type="text/html" /><updated>2020-11-03T17:46:32+08:00</updated><id>https://thefirstwind.github.io//feed.xml</id><title type="html">kei’s blog</title><subtitle>An amazing website of kei.</subtitle><author><name>kei gosling</name></author><entry><title type="html">订单与结算逻辑 后台batch</title><link href="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E5%90%8E%E5%8F%B0batch/" rel="alternate" type="text/html" title="订单与结算逻辑 后台batch" /><published>2020-10-03T00:00:00+08:00</published><updated>2020-10-03T00:00:00+08:00</updated><id>https://thefirstwind.github.io//%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E5%90%8E%E5%8F%B0batch</id><content type="html" xml:base="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E5%90%8E%E5%8F%B0batch/">&lt;h1 id=&quot;01-订单与结算逻辑结算与支付&quot;&gt;01. 订单与结算逻辑.结算与支付&lt;/h1&gt;

&lt;blockquote&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;时间&lt;/strong&gt;：2018年8月23日&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;@[订单, 结算逻辑]&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;[TOC]&lt;/p&gt;

&lt;h2 id=&quot;数据字典&quot;&gt;数据字典&lt;/h2&gt;

&lt;h3 id=&quot;系统角色&quot;&gt;系统角色&lt;/h3&gt;
&lt;p&gt;| 端  |    用户群体 |    终端类型 | 终端名称  |
| :——– |:——–| :–: |:——–|
| 用户端  |患者、消费者 | 微信公众号 | E护通  |
| 护工端  |院内护工、居家护工 |  微信公众号  | E护通|护工  |
| 护士端  |提供上门服务的在册护士 | 微信公众号/APP  | 护通|专护 |
| POS机端 |擎浩医院管理老师| POS机  |  |
| PC端 |财务、运营、系统管理员等| PC电脑端 |   |
| 统计端|院方高层、护理界高层| 微信公众号  | 擎浩护理  |&lt;/p&gt;

&lt;h3 id=&quot;院内订单类型&quot;&gt;院内订单类型&lt;/h3&gt;
&lt;p&gt;| 订单类型  | 前提条件 |  工资计算说明|
| :——– |:——–| :–: |
| 1对1订单 | 院内有机动护工 | 系统计算、每日按照比例分配 |
| 1对多订单 | 当前病区绑定了护工 |  系统计算、每日按照比例分配   |
| 团队制订单| 当前病区支持团队制 | 不统计报表  |
| 单项订单 |擎浩医院管理老师| 待定 |&lt;/p&gt;

&lt;h3 id=&quot;订单状态&quot;&gt;订单状态&lt;/h3&gt;
&lt;p&gt;| 状态  | 状态名称 |  说明|
| :——– |:——–| :– |
| 0  | 无状态 | 空状态，冗余字段 |
| 1  | 预约中 | 院外抢单用状态 |
| 2  | 预约成功 | POS机管理老师代接单，并且派工之后的状态 |
| 3  | 待支付（在2小时内付款，超时被取消） | 院内订单下单之后的状态 |
| 4  | 已支付（支付成功） | 支付成功的状态 |
| 5  | 待服务（等待上门服务，计时） | 支付成功之后，2个小时之内保持待服务状态 |
| 6  | 服务中（服务进度） | 支付成功之后，2个小时之后进入服务中状态 |
| 7  | 待结算 | 用户(POS机)发起结算 （等待结算并提示用户结算，超时关闭订单）|
| 8  | 已完成 | 用户(POS机)发起结算之后，如果判断退款成功，状态变为完成 |
| 9  | 待评价 | 冗余状态 |
| 10  | 已评价 | 用户评价完成之后 |
| 11  | 已取消（取消成功） | 超时支付，自动变为取消|
| 12  | 申请退款（发起退款申请） | 待服务状态，申请全额退款的状态 |
| 13  | 退款中（退款已受理，并进行退款程序） | 发起退款的状态 |
| 14  | 退款成功 （退款额转入用户账户） | 用户(POS机)发起退款，如果确认退款成功，状态变为退款成功 |
| 15  | 退款失败（提示失败原因） | 用户(POS机)发起退款，如果确认退款失败，状态变为退款失败 |
| 16  | 变更待服务 | 发起订单变更之后的状态 |
| 17  | 结算中 | 用户(POS机)发起结算，状态变为结算中 |
| 18  | 结算完成 | 用户(POS机)发起结算，如果确认结算成功，状态变为结算完成 |
| 19  | 结算失败 | 用户(POS机)发起结算，如果确认结算失败，状态变为结算失败 |&lt;/p&gt;

&lt;h2 id=&quot;数据库设计&quot;&gt;数据库设计&lt;/h2&gt;

&lt;h3 id=&quot;订单主表&quot;&gt;订单主表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：用户下单、POS机下单、发生支付的订单变更
2 修改条件：支付、超时未支付、补录患者信息、订单变更、订单结算（用户或者POS发起的结算）、其他影响状态变化的节点
3 终止条件：超时未支付、订单完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| orduid|String|必须| 订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| ordid|String|必须| 订单ID|1804050053004W|
| uopid|String|必须| 患者openid| ooDqLwHXcSIFoMZxTX3DtHkLtaOM|
| tradeno|String|必须| 支付UID| TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| ptorduid|String|必须| 患者姓名| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| rlnm|String|必须| 父订单号，续单用，初始值为其本身如果有续单或者纠纷负单则为其父单orduid| 王根娣|
| startday|date|必须| 服务开始时间 默认当前日期| 2018-04-05|
| svcday|Integer|必须| 服务天数| 10|
| statncd|String|必须| 护工站代码| 31010700052|
| statnnm|String|必须| 护工站| 上海市同济大学附属同济医院(同济医院)|
| amount|Integer|必须| 订单初始预收金额| 90000|
| ordlessfee|Integer|| 订单剩余金额| 0|
| status1|Integer|| 0 无状态  &lt;br /&gt;1 预约中 &lt;br /&gt;2 预约成功 &lt;br /&gt;3 待支付（在2小时内付款，超时被取消） &lt;br /&gt;4 已支付（支付成功）&lt;br /&gt;5 待服务（等待上门服务，计时）&lt;br /&gt;6 服务中（服务进度）&lt;br /&gt;7 待结算（等待结算并提示用户结算，超时关闭订单）&lt;br /&gt;8 已完成 &lt;br /&gt;9 待评价 &lt;br /&gt;10 已评价&lt;br /&gt; 11 已取消（取消成功） &lt;br /&gt;12 申请退款（发起退款申请） &lt;br /&gt;13 退款中（退款已受理，并进行退款程序） &lt;br /&gt;14 退款成功 （退款额转入用户账户） &lt;br /&gt;15 退款失败（提示失败原因） &lt;br /&gt;16 变更待服务 &lt;br /&gt;17 结算中 &lt;br /&gt;18 结算完成 &lt;br /&gt;19结算失败 &lt;br /&gt;| 5|
| status1nm|String|| 同上| 待服务|
| usrconftm|datetime||用户确认完成时间| 2018-04-14 14:54:50|
| splitsttlfg|Integer|| 拆分结算标识0：未拆分结算，1已拆分结算| 0|
| continufee|Integer|| 结转金额| 0|
| chgstatus|Integer||  1 变更未开始 &lt;br /&gt;2 变更已开始&lt;br /&gt;| 0|
| sttlefg|Integer|| 结算标识：给用户退款订单结算掉，成功结算更新 0默认,1已结算| 0|&lt;/p&gt;

&lt;h3 id=&quot;订单详情表&quot;&gt;订单详情表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：用户下单、POS机下单、不发生支付的订单变更
2 修改条件：订单变更、订单结算（用户或POS发起的订单结算）、护工结束服务、其他影响状态变化的节点
3 终止条件：超时未支付、订单完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| orduid|String|必须| 订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| wuid|String|必须| 护工Uid| WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| wstatncd|String|必须| 所属网点 该护工所属网点|31010700052 |
| statncd|String|必须|服务网点 订单服务网点（非网点，没有代码） |31010700052 |
| hospnm|String|必须| 服务医院 医院名称| 上海市同济大学附属同济医院(同济医院)|
| sitmid|Integer|必须| 服务项目 当ordtp属于院内时| |
| svctp|String|必须| 交易号| TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| startday|date|必须| 服务开始时间 默认当前日期| 2018-04-05|
| svcday|Integer|必须| 服务天数| 10|
| unitprice|Integer|必须|  服务项目单价| 9000|
| amount|Integer|必须| 服务项目小计 服务项目单价 X 服务天数（精算）| 90000|
| adjustday|decimal(4,2)|| 调整天数 -0.5 0  0.5 三个值，在最后一天结算| 0|
| status1|Integer|| 0 无状态&lt;br /&gt;1 预约中 &lt;br /&gt;2 预约成功&lt;br /&gt;3 待支付（在15分钟内付款，超时被取消） &lt;br /&gt;4 已支付（支付成功）.&lt;br /&gt;5 待服务（等待上门服务，计时）&lt;br /&gt;6 服务中（服务进度）&lt;br /&gt;7 待结算（等待结算并提示用户结算，超时关闭订单）&lt;br /&gt;8 已完成&lt;br /&gt;9 待评价 &lt;br /&gt;10 已评价&lt;br /&gt;11 已取消（取消成功） &lt;br /&gt;12 申请退款（发起退款申请） &lt;br /&gt;13 退款中（退款已受理，并进行退款程序） &lt;br /&gt;14 退款成功 （退款额转入用户账户） &lt;br /&gt;15 退款失败（提示失败原因）&lt;br /&gt;16 变更待服务&lt;br /&gt;17 结算中 &lt;br /&gt;18 结算完成 &lt;br /&gt;19结算失败 | 5|
| status1nm|String||同上 | 待服务|
| status3|Integer|| 状态-完成 0 无状态 1 完成 | 1|
| status3nm|String|| 状态-完成-说明 保存护工的做工状态 | 完成|
| factsvcfg|Integer|| 子单实际服务标识：0 是默认，1 是结算退款记录， 2 是退款记录{tips:该子单是否是实际服务单} | 0|&lt;/p&gt;

&lt;h3 id=&quot;支付信息表&quot;&gt;支付信息表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：支付、退款、结算等，有金额流转的情况
2 修改条件：支付成功后状态 paid状态更新，结算申请发起、结算状态更新、退款状态发起、退款状态更新。
3 终止条件：超时未支付、支付完成、结算完成、退款完成、
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| tradeno|String|必须| 支付订单号 tr+”-“+36位UUID（带-）&lt;br /&gt;微信线上支付 pt开头&lt;br /&gt;微信扫码支付 td开头&lt;br /&gt;银联支付 tr开头|TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| orduid|String|必须| 订单UID 订单主表ID| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| uopid|String|| 用户UID 支付者UID，不一定是被服务的患者|ooDqLwHXcSIFoMZxTX3DtHkLtaOM|
| fopid|String|| 推荐者UID 推荐者UID||
| ttype|Integer|| 订单类型 1医院 2医院单项 3居家|1|
| paid|Integer|| 是否已支付 &lt;br /&gt;0 未支付 &lt;br /&gt;1 线上支付 &lt;br /&gt;2 现金支付&lt;br /&gt;3 退款成功&lt;br /&gt;4 退款失败|1|
| paidtm|datetime|| 支付时间 非0的时候 才有值|2018-04-05 10:58:56|
| payment|Integer|| 支付方式 &lt;br /&gt;1 微信 &lt;br /&gt;2 刷卡（借记卡） &lt;br /&gt;3 刷卡（信用卡） &lt;br /&gt;4 现金（线下支付）&lt;br /&gt; 5 支付宝|1|
| amount|Integer|| 支付金额|90000|
| outorderno|String|| 外部订单号 外部订单号||
| outtransno|String|| 外部流水号 外部流水号|4200000095201804052560224795|
| resttlfg|Integer|| 预结算标志位：0未结算，1已结算||
| sttlfg|Integer|| 已结算标志 0未结算 1 已结算||
| sttlamt|Integer|| 结算金额||
| invoicetm|datetime|| 预分账标志位||
| reinvfg|Integer|| 分账标志||
| invoicefg|Integer|| ||
| refund|Integer|| 退款标志 现阶段价格统一。&lt;br /&gt;该字段为空，当每个省价格不同时，会用到。&lt;br /&gt;0是付款 1是退款|0|
| cardNo|String|| 银联支付用字段: 支付时所用的卡号(该字段当银联支付退款时使用)||
| transChnName|String|| 支付渠道名称||
| transEngName|String|| 支付渠道||
| refNo|String|| 银联支付用参考号||
| merchantNo|String|| 根据支付时的，商户编号||
| terminalNo|String|| pos机终端号码||
| traceNo|String|| 银联商务支付的记录号(每一个pos机从1开始计数)||&lt;/p&gt;

&lt;h3 id=&quot;日结表&quot;&gt;日结表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：开始服务的订单，每日12:30/23:30 进行结算
2 修改条件：无
3 终止条件：预付款消耗完为止
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| daysttuid|String|必须| 日结算UID|DST_VwACGXWSvbwTfEm9I_6dPyvWKkw2|
| orduid|String|必须| 订单UID 订单主表ID| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| porduid|String|必须| 母单orduid| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| sttdate|date|必须| 结算日期| 2018-04-05|
| wuid|String|必须| 护工wuid|WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| daysttfee|Integer|| 日结算金额|9000|
| lessordfee|Integer|| 订单剩余金额(结余金额)|81000|
| daystttm|datetime|| 结算时间|2018-04-09 23:30:00|
| unitprice|Integer|| 单价 | 9000 |
| statncd|String|| 做单护工站 | 31010700052 |
| plusfee|String|| 增收 | 450 |
| wrkfee|String|| 护工工资 | 5400 |
| hospfee|String|| 医院管理费 | 900 |
| companyfee|String|| 管理费（公司管理费:statncd=wstatncd的时候该字段和服务项目单价拆分的公司管理费一致，如果statncd&amp;lt;&amp;gt;wstatncd三七开的订单，则此字段记录总利润 即=sttamount - wrkfee - recomfee） | 2033 |
| platamount|String|| 平台费用 | 0 |
| deptfee|String|| 科室费 | 100 |
| insuranfee|String|| 保险费 | 0 |
| recomfee|String|| 推荐有奖金额 | 0 |
| platformfee|String|| 护工点击结束后用户遗留平台金额 | 0 |
| payfee|String|| 支付金额 | 90000 |
| usrnewordfee|String|| 用户续单结转 | 0 |
| refundfee|String|| 退款金额 | 0 |&lt;/p&gt;

&lt;h3 id=&quot;结算表&quot;&gt;结算表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：结算完成
2 修改条件：无
3 终止条件：结算完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;字段名&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;必须&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sttuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;日结算UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ST_o9wTyvpiSuSqmbjsMonkilWvm7qXz&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orduid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单UID 订单主表ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;subid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单Subid, 子单号&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;statncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;需求方所在护工站，如果院外非网点或居家为空&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工所在护工站&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工wuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sttamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;结算金额(合算=医院管理费+护工工资+毛利润)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;90000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unitprice&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;单价 护工身价*系数（目前100%）+保险&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svcday&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务天数&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;10&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;plusfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;增收&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工工资&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;54000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;hospfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;医院管理费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;companyfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;管理费（公司管理费:statncd=wstatncd的时候该字段和服务项目单价拆分的公司管理费一致，如果statncd&amp;lt;&amp;gt;wstatncd三七开的订单，则此字段记录总利润 即=sttamount - wrkfee - recomfee）&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;21383&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;平台费用&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;deptfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;科室费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;insuranfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;保险费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;recomfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;推荐有奖金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platformfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工点击结束后用户遗留平台金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;payfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;支付金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;90000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;usrnewordfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;用户续单结转&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;invoicefg&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;分账标识0未分账，1已分账 针对是否分账到qo_ord_fin_statn_invoice表而标识&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;isdowrkfeefg&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工工资标识&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;护工站分账明细&quot;&gt;护工站分账明细&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：结算完成
2 修改条件：无
3 终止条件：结算完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;字段名&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;必须&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;finuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;利益分账UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FI_5NN3QewfIAJPKvTANe2xwG8nPFmUM&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sttuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;日结算UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ST_o9wTyvpiSuSqmbjsMonkilWvm7qXz&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orduid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单UID 订单主表ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;requirstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;发单方statncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;requirfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;发单方收益&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;派单方statncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkstatnfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;派单方收益&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工工资&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;54000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;hospfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;医院管理费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;recomfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;推荐有奖金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;insurfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;保险费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;plusfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;增收&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;suplid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;加盟商cd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;suplfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;发单方加盟商收益&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;21383&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platfeee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;平台遗留金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;平台费用&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;护工工资表&quot;&gt;护工工资表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：护工点击完成服务，+15天之后分账
2 修改条件：无
3 终止条件：护工点击完成服务，+15天之后分账
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| wiuid|String|必须| 收入UIDWI开头32位UUID|WI_DxhX4TG2DPkqMyCLLETeUoa4nbtJ0|
| wuid|String|必须| 护工编号UIDWK开头32位UUID|WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| witp|Integer|必须| 收入类型收入类型 1 订单 2 推荐分享 3 奖励 4 积分换取 |1|
| income|Integer|必须| 收入单位是分 |54000|
| status|Integer|必须| 状态&lt;br /&gt;0 订单服务中 &lt;br /&gt;1 等待结算  &lt;br /&gt;2 系统审核中 &lt;br /&gt;9已生效&lt;br /&gt; (订单服务中状态为0，&lt;br /&gt;订单服务截止之间到但未被结算状态为1,&lt;br /&gt;订单被投诉 状态为2，&lt;br /&gt;订单结束并结算再加14天 状态为9，) |2|
| cashed|Integer|必须| 是否已提现0 未体现 1 已提现 |1|
| cashtm|DateTime|必须| 提现时间提现的时间 |2018-04-09 23:30:00|&lt;/p&gt;

&lt;h2 id=&quot;订单状态变化与结算数据的流程&quot;&gt;订单状态变化与结算数据的流程&lt;/h2&gt;
&lt;h3 id=&quot;订单状态变化时序图&quot;&gt;订单状态变化(时序图):&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-sequence&quot;&gt;用户端-&amp;gt;[数据库]: 1 用户自主下单(院外订单)
用户端-&amp;gt;[数据库]: 2 用户自主下单(院内订单)
POS机-&amp;gt;[数据库]: POS机管理老师接单、并且派工
[批处理]-&amp;gt;[数据库]: 2小时无人反映，取消订单
用户端-&amp;gt;[数据库]: [￥支付 微信 ]
POS机-&amp;gt;[数据库]: [￥收款：微信/支付宝/银行卡/现金]
[批处理]-&amp;gt;[批处理]: 30分钟内不支付，支付状态超时
[批处理]--&amp;gt;[数据库]: 取消订单
[批处理]-&amp;gt;[批处理]: 支付成功之后，2小时内处于待服务状态，超过2小时进入服务中
[批处理]--&amp;gt;[数据库]: 待服务-&amp;gt;服务中
[数据库]--&amp;gt;用户端: 查看订单信息
[数据库]-&amp;gt;PC端: 查看订单信息
[数据库]-&amp;gt;护工端: 查看订单信息
护工端--&amp;gt;用户端: 推送服务日志
用户端-&amp;gt;[数据库]: 发起结算
[批处理]--&amp;gt;[批处理]: 发起结算、向银行请求数据、进入结算中状态
[批处理]--&amp;gt;[批处理]: 判断结算申请的结果、
[批处理]--&amp;gt;[数据库]: 结算成功/结算失败 -&amp;gt; 更新状态
[数据库]-&amp;gt;[数据库]: 服务结束时间判断
用户端--&amp;gt;护工端: 订单结算
护工端--&amp;gt;[数据库]: 服务结算
POS机--&amp;gt;用户端: 订单强制结算
POS机--&amp;gt;护工端: 订单强制结算
用户端-&amp;gt;[数据库]:用户评价、状态进入已评价状态
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;后台批处理接口说明&quot;&gt;后台批处理接口说明&lt;/h2&gt;

&lt;h3 id=&quot;01-支付超时的处理&quot;&gt;01. 支付超时的处理&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderCancelUnpaid&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 清理超过2小时的订单未支付的订单
 2 订单变更的处理，当2个小时内不支付，已经申请变更的订单自动变成过期未支付状态
 3 每天 8-20点之间，每分钟执行&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;02-订单变更审核超时的处理&quot;&gt;02. 订单变更审核超时的处理&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/cancelUnaplyToUnPayOrd&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 次日生效 24小时后 不审批 取消并且退款
 2 当日及时生效 6小时后 遍生效 取消并且退款&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;03-订单变更待服务的处理&quot;&gt;03. 订单变更待服务的处理&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderChangeSerStart&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 修改变更服务变成待服务(立即执行) 没有支付的订单变更
 2 只有审批通过的变更待服务才能进入服务状态，否者停留在永远待服务的状态
 3 每分钟执行&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;04-退款给用户的处理微信&quot;&gt;04. 退款给用户的处理（微信）&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderRefundToUser&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 判断订单状态为7，立即退款给用户
 2 每分钟执行&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;05-退款给用户的处理银联&quot;&gt;05. 退款给用户的处理（银联）&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/doRefundToUserUpay&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 判断订单状态为7，立即退款给用户
 2 每分钟执行&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;06-待服务进入服务中无需支付&quot;&gt;06. 待服务进入服务中(无需支付)&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderWaitSerToSer&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 订单支付成功2小时后，待服务进入服务中
 2 每分钟执行，订单支付时间到当前时间有2小时的订单&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;07-变更待服务进入服务中有支付&quot;&gt;07. 变更待服务进入服务中(有支付)&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderChangeWaitSerToSer&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 变更订单的等待状态变成开始服务 有支付状态的订单变更
 2 只有审批通过的变更待服务才能进入服务状态，否者停留在永远待服务的状态
 3 每分钟执行，订单支付时间到当前时间有2小时的订单&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;08-订单拆分&quot;&gt;08. 订单拆分&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/finSplitSttle&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 针对每个订单的拆分细则，拆分 护工工资、平台费、科室费、保险费、公司所得等费用&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;09-分账给护工站&quot;&gt;09. 分账给护工站&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/finInvoiceToStatn&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 针对每个订单的拆分细则，拆分 护工工资、平台费、科室费、保险费、公司所得等费用到具体的护工站&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;10-日结脚本&quot;&gt;10. 日结脚本&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/ordDayStt&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 针对每个订单做当日结算，消耗当天费用，并且拆分 护工工资、平台费、科室费、保险费、公司所得等费用
 2 每天12:30 23:30 跑该脚本&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;11-护工工资结算改变状态脚本&quot;&gt;11. 护工工资结算改变状态脚本&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/doSettleWrkfee&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 根据日结结果，计算每日护工工资
 2 每天1点15分 跑该脚本&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;12-订单逾期脚本&quot;&gt;12. 订单逾期脚本&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/ordFinishStt&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 结算到期订单用户未点击的订单 ，结算成逾期，并且释放床位
 2 每天1点30分 跑该脚本&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;13-订单结算状态脚本&quot;&gt;13. 订单结算状态脚本&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/doSttlement&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 对于用户已经点击结算，护工已经点击结束服务的订单，跑的脚本
 2 分钟跑该脚本&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>kei gosling</name></author><summary type="html">01. 订单与结算逻辑.结算与支付</summary></entry><entry><title type="html">订单与结算逻辑 减免与优惠</title><link href="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E5%87%8F%E5%85%8D%E4%B8%8E%E4%BC%98%E6%83%A0/" rel="alternate" type="text/html" title="订单与结算逻辑 减免与优惠" /><published>2020-10-03T00:00:00+08:00</published><updated>2020-10-03T00:00:00+08:00</updated><id>https://thefirstwind.github.io//%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E5%87%8F%E5%85%8D%E4%B8%8E%E4%BC%98%E6%83%A0</id><content type="html" xml:base="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E5%87%8F%E5%85%8D%E4%B8%8E%E4%BC%98%E6%83%A0/">&lt;h1 id=&quot;04-订单与结算逻辑减免与优惠&quot;&gt;04. 订单与结算逻辑.减免与优惠&lt;/h1&gt;

&lt;blockquote&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;时间&lt;/strong&gt;：2018年9月8日&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;@[订单, 结算逻辑,减免与优惠]&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;[TOC]&lt;/p&gt;

&lt;h2 id=&quot;减免与优惠业务范围&quot;&gt;减免与优惠业务范围&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;1 订单类型： 服务中-&amp;gt;结算申请&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;2 适用场景：&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;订单完结的时候，对订单结算金额 加减0.5天&lt;/li&gt;
    &lt;li&gt;订单完结的时候，减免应结算的 平台管理费、医院管理费等费用&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;数据字典&quot;&gt;数据字典&lt;/h2&gt;
&lt;h3 id=&quot;系统角色&quot;&gt;系统角色&lt;/h3&gt;
&lt;p&gt;| 端  |    用户群体 |    终端类型 | 终端名称  |
| :——– |:——–| :–: |:——–|
| 用户端  |患者、消费者 | 微信公众号 | E护通  |
| 护工端  |院内护工、居家护工 |  微信公众号  | E护通|护工  |
| 护士端  |提供上门服务的在册护士 | 微信公众号/APP  | 护通|专护 |
| POS机端 |擎浩医院管理老师| POS机  |  |
| PC端 |财务、运营、系统管理员等| PC电脑端 |   |
| 统计端|院方高层、护理界高层| 微信公众号  | 擎浩护理  |&lt;/p&gt;

&lt;h3 id=&quot;院内订单类型&quot;&gt;院内订单类型&lt;/h3&gt;
&lt;p&gt;| 订单类型  | 前提条件 |  工资计算说明|
| :——– |:——–| :–: |
| 1对1订单 | 院内有机动护工 | 系统计算、每日按照比例分配 |
| 1对多订单 | 当前病区绑定了护工 |  系统计算、每日按照比例分配   |
| 团队制订单| 当前病区支持团队制 | 不统计报表  |
| 单项订单 |擎浩医院管理老师| 待定 |&lt;/p&gt;

&lt;h3 id=&quot;订单状态&quot;&gt;订单状态&lt;/h3&gt;
&lt;p&gt;| 状态  | 状态名称 |  说明|
| :——– |:——–| :– |
| 0  | 无状态 | 空状态，冗余字段 |
| 1  | 预约中 | 院外抢单用状态 |
| 2  | 预约成功 | POS机管理老师代接单，并且派工之后的状态 |
| 3  | 待支付（在2小时内付款，超时被取消） | 院内订单下单之后的状态 |
| 4  | 已支付（支付成功） | 支付成功的状态 |
| 5  | 待服务（等待上门服务，计时） | 支付成功之后，2个小时之内保持待服务状态 |
| 6  | 服务中（服务进度） | 支付成功之后，2个小时之后进入服务中状态 |
| 7  | 待结算 | 用户(POS机)发起结算 （等待结算并提示用户结算，超时关闭订单）|
| 8  | 已完成 | 用户(POS机)发起结算之后，如果判断退款成功，状态变为完成 |
| 9  | 待评价 | 冗余状态 |
| 10  | 已评价 | 用户评价完成之后 |
| 11  | 已取消（取消成功） | 超时支付，自动变为取消|
| 12  | 申请退款（发起退款申请） | 待服务状态，申请全额退款的状态 |
| 13  | 退款中（退款已受理，并进行退款程序） | 发起退款的状态 |
| 14  | 退款成功 （退款额转入用户账户） | 用户(POS机)发起退款，如果确认退款成功，状态变为退款成功 |
| 15  | 退款失败（提示失败原因） | 用户(POS机)发起退款，如果确认退款失败，状态变为退款失败 |
| 16  | 变更待服务 | 发起订单变更之后的状态 |
| 17  | 结算中 | 用户(POS机)发起结算，状态变为结算中 |
| 18  | 结算完成 | 用户(POS机)发起结算，如果确认结算成功，状态变为结算完成 |
| 19  | 结算失败 | 用户(POS机)发起结算，如果确认结算失败，状态变为结算失败 |&lt;/p&gt;

&lt;h2 id=&quot;数据库设计&quot;&gt;数据库设计&lt;/h2&gt;

&lt;h3 id=&quot;订单主表&quot;&gt;订单主表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：无
2 修改条件：结算申请，调整结算金额
3 终止条件：结算申请，调整结算金额
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| orduid|String|必须| 订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| ordid|String|必须| 订单ID|1804050053004W|
| uopid|String|必须| 患者openid| ooDqLwHXcSIFoMZxTX3DtHkLtaOM|
| tradeno|String|必须| 支付UID| TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| ptorduid|String|必须| 患者姓名| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| rlnm|String|必须| 父订单号，续单用，初始值为其本身如果有续单或者纠纷负单则为其父单orduid| 王根娣|
| startday|date|必须| 服务开始时间 默认当前日期| 2018-04-05|
| svcday|Integer|必须| 服务天数| 10|
| statncd|String|必须| 护工站代码| 31010700052|
| statnnm|String|必须| 护工站| 上海市同济大学附属同济医院(同济医院)|
| amount|Integer|必须| 订单初始预收金额| 90000|
| ordlessfee|Integer|| 订单剩余金额| 0|
| status1|Integer|| 0 无状态  &lt;br /&gt;1 预约中 &lt;br /&gt;2 预约成功 &lt;br /&gt;3 待支付（在2小时内付款，超时被取消） &lt;br /&gt;4 已支付（支付成功）&lt;br /&gt;5 待服务（等待上门服务，计时）&lt;br /&gt;6 服务中（服务进度）&lt;br /&gt;7 待结算（等待结算并提示用户结算，超时关闭订单）&lt;br /&gt;8 已完成 &lt;br /&gt;9 待评价 &lt;br /&gt;10 已评价&lt;br /&gt; 11 已取消（取消成功） &lt;br /&gt;12 申请退款（发起退款申请） &lt;br /&gt;13 退款中（退款已受理，并进行退款程序） &lt;br /&gt;14 退款成功 （退款额转入用户账户） &lt;br /&gt;15 退款失败（提示失败原因） &lt;br /&gt;16 变更待服务 &lt;br /&gt;17 结算中 &lt;br /&gt;18 结算完成 &lt;br /&gt;19结算失败 &lt;br /&gt;| 5|
| status1nm|String|| 同上| 待服务|
| usrconftm|datetime||用户确认完成时间| 2018-04-14 14:54:50|
| splitsttlfg|Integer|| 拆分结算标识0：未拆分结算，1已拆分结算| 0|
| continufee|Integer|| 结转金额| 0|
| chgstatus|Integer||  1 变更未开始 &lt;br /&gt;2 变更已开始&lt;br /&gt;| 0|
| discfg|String||  优惠标识discfg：&lt;br /&gt;0：无优惠，&lt;br /&gt;1：全免，&lt;br /&gt;2：减免医院管理费，&lt;br /&gt;3：减免公司收入，&lt;br /&gt;4：减免增收,&lt;br /&gt;5：团队制减免| 0|
| discamount|Integer|| 优惠金额| 300|
| sttlefg|Integer|| 结算标识：给用户退款订单结算掉，成功结算更新 0默认,1已结算| 0|&lt;/p&gt;

&lt;h3 id=&quot;订单详情表&quot;&gt;订单详情表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：无
2 修改条件：结算申请，调整结算金额
3 终止条件：结算申请，调整结算金额
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| orduid|String|必须| 订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| wuid|String|必须| 护工Uid| WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| wstatncd|String|必须| 所属网点 该护工所属网点|31010700052 |
| statncd|String|必须|服务网点 订单服务网点（非网点，没有代码） |31010700052 |
| hospnm|String|必须| 服务医院 医院名称| 上海市同济大学附属同济医院(同济医院)|
| sitmid|Integer|必须| 服务项目 当ordtp属于院内时| |
| svctp|String|必须| 交易号| TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| startday|date|必须| 服务开始时间 默认当前日期| 2018-04-05|
| svcday|Integer|必须| 服务天数| 10|
| unitprice|Integer|必须|  服务项目单价| 9000|
| amount|Integer|必须| 服务项目小计 服务项目单价 X 服务天数（精算）| 90000|
| adjustday|decimal(4,2)|| 调整天数 -0.5 0  0.5 三个值，在最后一天结算| 0|
| status1|Integer|| 0 无状态&lt;br /&gt;1 预约中 &lt;br /&gt;2 预约成功&lt;br /&gt;3 待支付（在15分钟内付款，超时被取消） &lt;br /&gt;4 已支付（支付成功）.&lt;br /&gt;5 待服务（等待上门服务，计时）&lt;br /&gt;6 服务中（服务进度）&lt;br /&gt;7 待结算（等待结算并提示用户结算，超时关闭订单）&lt;br /&gt;8 已完成&lt;br /&gt;9 待评价 &lt;br /&gt;10 已评价&lt;br /&gt;11 已取消（取消成功） &lt;br /&gt;12 申请退款（发起退款申请） &lt;br /&gt;13 退款中（退款已受理，并进行退款程序） &lt;br /&gt;14 退款成功 （退款额转入用户账户） &lt;br /&gt;15 退款失败（提示失败原因）&lt;br /&gt;16 变更待服务&lt;br /&gt;17 结算中 &lt;br /&gt;18 结算完成 &lt;br /&gt;19结算失败 | 5|
| status1nm|String||同上 | 待服务|
| status3|Integer|| 状态-完成 0 无状态 1 完成 | 1|
| status3nm|String|| 状态-完成-说明 保存护工的做工状态 | 完成|
| factsvcfg|Integer|| 子单实际服务标识：0 是默认，1 是结算退款记录， 2 是退款记录{tips:该子单是否是实际服务单} | 0|&lt;/p&gt;

&lt;h3 id=&quot;支付信息表&quot;&gt;支付信息表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：支付、退款、结算等，有金额流转的情况
2 修改条件：支付成功后状态 paid状态更新，结算申请发起、结算状态更新、退款状态发起、退款状态更新。
3 终止条件：超时未支付、支付完成、结算完成、退款完成、
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| tradeno|String|必须| 支付订单号 tr+”-“+36位UUID（带-）&lt;br /&gt;微信线上支付 pt开头&lt;br /&gt;微信扫码支付 td开头&lt;br /&gt;银联支付 tr开头|TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| orduid|String|必须| 订单UID 订单主表ID| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| uopid|String|| 用户UID 支付者UID，不一定是被服务的患者|ooDqLwHXcSIFoMZxTX3DtHkLtaOM|
| fopid|String|| 推荐者UID 推荐者UID||
| ttype|Integer|| 订单类型 1医院 2医院单项 3居家|1|
| paid|Integer|| 是否已支付 &lt;br /&gt;0 未支付 &lt;br /&gt;1 线上支付 &lt;br /&gt;2 现金支付&lt;br /&gt;3 退款成功&lt;br /&gt;4 退款失败|1|
| paidtm|datetime|| 支付时间 非0的时候 才有值|2018-04-05 10:58:56|
| payment|Integer|| 支付方式 &lt;br /&gt;1 微信 &lt;br /&gt;2 刷卡（借记卡） &lt;br /&gt;3 刷卡（信用卡） &lt;br /&gt;4 现金（线下支付）&lt;br /&gt; 5 支付宝|1|
| amount|Integer|| 支付金额|90000|
| outorderno|String|| 外部订单号 外部订单号||
| outtransno|String|| 外部流水号 外部流水号|4200000095201804052560224795|
| resttlfg|Integer|| 预结算标志位：0未结算，1已结算||
| sttlfg|Integer|| 已结算标志 0未结算 1 已结算||
| sttlamt|Integer|| 结算金额||
| invoicetm|datetime|| 预分账标志位||
| reinvfg|Integer|| 分账标志||
| invoicefg|Integer|| ||
| refund|Integer|| 退款标志 现阶段价格统一。&lt;br /&gt;该字段为空，当每个省价格不同时，会用到。&lt;br /&gt;0是付款 1是退款|0|
| cardNo|String|| 银联支付用字段: 支付时所用的卡号(该字段当银联支付退款时使用)||
| transChnName|String|| 支付渠道名称||
| transEngName|String|| 支付渠道||
| refNo|String|| 银联支付用参考号||
| merchantNo|String|| 根据支付时的，商户编号||
| terminalNo|String|| pos机终端号码||
| traceNo|String|| 银联商务支付的记录号(每一个pos机从1开始计数)||&lt;/p&gt;

&lt;h3 id=&quot;日结表&quot;&gt;日结表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：开始服务的订单，每日12:30/23:30 进行结算
2 修改条件：无
3 终止条件：预付款消耗完为止
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| daysttuid|String|必须| 日结算UID|DST_VwACGXWSvbwTfEm9I_6dPyvWKkw2|
| orduid|String|必须| 订单UID 订单主表ID| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| porduid|String|必须| 母单orduid| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| sttdate|date|必须| 结算日期| 2018-04-05|
| wuid|String|必须| 护工wuid|WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| daysttfee|Integer|| 日结算金额|9000|
| lessordfee|Integer|| 订单剩余金额(结余金额)|81000|
| daystttm|datetime|| 结算时间|2018-04-09 23:30:00|
| unitprice|Integer|| 单价 | 9000 |
| statncd|String|| 做单护工站 | 31010700052 |
| plusfee|String|| 增收 | 450 |
| wrkfee|String|| 护工工资 | 5400 |
| hospfee|String|| 医院管理费 | 900 |
| companyfee|String|| 管理费（公司管理费:statncd=wstatncd的时候该字段和服务项目单价拆分的公司管理费一致，如果statncd&amp;lt;&amp;gt;wstatncd三七开的订单，则此字段记录总利润 即=sttamount - wrkfee - recomfee） | 2033 |
| platamount|String|| 平台费用 | 0 |
| deptfee|String|| 科室费 | 100 |
| insuranfee|String|| 保险费 | 0 |
| recomfee|String|| 推荐有奖金额 | 0 |
| platformfee|String|| 护工点击结束后用户遗留平台金额 | 0 |
| payfee|String|| 支付金额 | 90000 |
| usrnewordfee|String|| 用户续单结转 | 0 |
| refundfee|String|| 退款金额 | 0 |&lt;/p&gt;

&lt;h3 id=&quot;结算表&quot;&gt;结算表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：结算完成
2 修改条件：无
3 终止条件：结算完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;字段名&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;必须&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sttuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;日结算UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ST_o9wTyvpiSuSqmbjsMonkilWvm7qXz&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orduid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单UID 订单主表ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;subid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单Subid, 子单号&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;statncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;需求方所在护工站，如果院外非网点或居家为空&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工所在护工站&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工wuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sttamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;结算金额(合算=医院管理费+护工工资+毛利润)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;90000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unitprice&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;单价 护工身价*系数（目前100%）+保险&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svcday&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务天数&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;10&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;plusfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;增收&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工工资&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;54000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;hospfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;医院管理费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;companyfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;管理费（公司管理费:statncd=wstatncd的时候该字段和服务项目单价拆分的公司管理费一致，如果statncd&amp;lt;&amp;gt;wstatncd三七开的订单，则此字段记录总利润 即=sttamount - wrkfee - recomfee）&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;21383&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;平台费用&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;deptfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;科室费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;insuranfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;保险费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;recomfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;推荐有奖金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platformfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工点击结束后用户遗留平台金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;payfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;支付金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;90000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;usrnewordfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;用户续单结转&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;invoicefg&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;分账标识0未分账，1已分账 针对是否分账到qo_ord_fin_statn_invoice表而标识&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;isdowrkfeefg&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工工资标识&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;护工站分账明细&quot;&gt;护工站分账明细&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：结算完成
2 修改条件：无
3 终止条件：结算完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;字段名&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;必须&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;finuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;利益分账UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FI_5NN3QewfIAJPKvTANe2xwG8nPFmUM&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sttuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;日结算UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ST_o9wTyvpiSuSqmbjsMonkilWvm7qXz&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orduid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单UID 订单主表ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;requirstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;发单方statncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;requirfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;发单方收益&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;派单方statncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkstatnfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;派单方收益&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工工资&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;54000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;hospfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;医院管理费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;recomfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;推荐有奖金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;insurfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;保险费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;plusfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;增收&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;suplid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;加盟商cd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;suplfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;发单方加盟商收益&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;21383&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platfeee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;平台遗留金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;平台费用&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;护工工资表&quot;&gt;护工工资表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：护工点击完成服务，+15天之后分账
2 修改条件：无
3 终止条件：护工点击完成服务，+15天之后分账
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| wiuid|String|必须| 收入UIDWI开头32位UUID|WI_DxhX4TG2DPkqMyCLLETeUoa4nbtJ0|
| wuid|String|必须| 护工编号UIDWK开头32位UUID|WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| witp|Integer|必须| 收入类型收入类型 1 订单 2 推荐分享 3 奖励 4 积分换取 |1|
| income|Integer|必须| 收入单位是分 |54000|
| status|Integer|必须| 状态&lt;br /&gt;0 订单服务中 &lt;br /&gt;1 等待结算  &lt;br /&gt;2 系统审核中 &lt;br /&gt;9已生效&lt;br /&gt; (订单服务中状态为0，&lt;br /&gt;订单服务截止之间到但未被结算状态为1,&lt;br /&gt;订单被投诉 状态为2，&lt;br /&gt;订单结束并结算再加14天 状态为9，) |2|
| cashed|Integer|必须| 是否已提现0 未体现 1 已提现 |1|
| cashtm|DateTime|必须| 提现时间提现的时间 |2018-04-09 23:30:00|&lt;/p&gt;

&lt;h2 id=&quot;订单减免的流程&quot;&gt;订单减免的流程&lt;/h2&gt;
&lt;h3 id=&quot;加减05天的结算时序图&quot;&gt;加减0.5天的结算(时序图):&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-sequence&quot;&gt;POS机-&amp;gt;[数据库]: 管理老师带用户发起结算申请、加减0.5天
[批处理]--&amp;gt;[数据库]: 查找发起结算的订单
[批处理]--&amp;gt;[批处理]: 发起结算、向银行请求数据、进入结算中状态
[批处理]--&amp;gt;[批处理]: 判断结算申请的结果、
[批处理]--&amp;gt;[数据库]: 结算成功/结算失败 -&amp;gt; 更新状态
[批处理]-&amp;gt;[批处理]: 服务结束时间判断
[批处理]--&amp;gt;用户端: 通知用户服务结束
[批处理]--&amp;gt;护工端: 通知护工服务结束
护工端--&amp;gt;[数据库]: 确认结算状态
用户端--&amp;gt;[数据库]: 确认结算状态

&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;优惠单的结算&quot;&gt;优惠单的结算:&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-sequence&quot;&gt;POS机-&amp;gt;[数据库]: 1 发起结算申请（无优惠)
POS机-&amp;gt;[数据库]: 2 发起结算申请（全部费用免除)
POS机-&amp;gt;[数据库]: 3 发起结算申请（减免医院管理费)
POS机-&amp;gt;[数据库]: 4 发起结算申请（减免公司收入)
POS机-&amp;gt;[数据库]: 5 发起结算申请（减免增收)
POS机-&amp;gt;[数据库]: 6 发起结算申请（团队制减免)
[批处理]--&amp;gt;[数据库]: 查找发起结算的订单
[[批处理]--&amp;gt;[批处理]: 发起结算、向银行请求数据、进入结算中状态
[批处理]--&amp;gt;[批处理]: 判断结算申请的结果、
[批处理]--&amp;gt;[数据库]: 结算成功/结算失败 -&amp;gt; 更新状态
[批处理]--&amp;gt;用户端: 通知用户服务已开始
[批处理]--&amp;gt;护工端: 通知旧护工服务已结束
[批处理]--&amp;gt;护工端: 通知新护工服务已开始
[数据库]--&amp;gt;用户端: 查看订单信息
[数据库]-&amp;gt;PC端: 查看订单信息
[数据库]-&amp;gt;护工端: 查看订单信息
用户端-&amp;gt;[数据库]:用户评价、状态进入已评价状态
&lt;/code&gt;&lt;/pre&gt;</content><author><name>kei gosling</name></author><summary type="html">04. 订单与结算逻辑.减免与优惠</summary></entry><entry><title type="html">订单与结算逻辑 代下单</title><link href="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E4%BB%A3%E4%B8%8B%E5%8D%95/" rel="alternate" type="text/html" title="订单与结算逻辑 代下单" /><published>2020-10-03T00:00:00+08:00</published><updated>2020-10-03T00:00:00+08:00</updated><id>https://thefirstwind.github.io//%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E4%BB%A3%E4%B8%8B%E5%8D%95</id><content type="html" xml:base="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E4%BB%A3%E4%B8%8B%E5%8D%95/">&lt;h1 id=&quot;01-订单与结算逻辑结算与支付&quot;&gt;01. 订单与结算逻辑.结算与支付&lt;/h1&gt;

&lt;blockquote&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;时间&lt;/strong&gt;：2018年8月23日&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;@[订单, 结算逻辑]&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;[TOC]&lt;/p&gt;

&lt;h2 id=&quot;数据字典&quot;&gt;数据字典&lt;/h2&gt;

&lt;h3 id=&quot;系统角色&quot;&gt;系统角色&lt;/h3&gt;
&lt;p&gt;| 端  |    用户群体 |    终端类型 | 终端名称  |
| :——– |:——–| :–: |:——–|
| 用户端  |患者、消费者 | 微信公众号 | E护通  |
| 护工端  |院内护工、居家护工 |  微信公众号  | E护通|护工  |
| 护士端  |提供上门服务的在册护士 | 微信公众号/APP  | 护通|专护 |
| POS机端 |擎浩医院管理老师| POS机  |  |
| PC端 |财务、运营、系统管理员等| PC电脑端 |   |
| 统计端|院方高层、护理界高层| 微信公众号  | 擎浩护理  |&lt;/p&gt;

&lt;h3 id=&quot;院内订单类型&quot;&gt;院内订单类型&lt;/h3&gt;
&lt;p&gt;| 订单类型  | 前提条件 |  工资计算说明|
| :——– |:——–| :–: |
| 1对1订单 | 院内有机动护工 | 系统计算、每日按照比例分配 |
| 1对多订单 | 当前病区绑定了护工 |  系统计算、每日按照比例分配   |
| 团队制订单| 当前病区支持团队制 | 不统计报表  |
| 单项订单 |擎浩医院管理老师| 待定 |&lt;/p&gt;

&lt;h3 id=&quot;订单状态&quot;&gt;订单状态&lt;/h3&gt;
&lt;p&gt;| 状态  | 状态名称 |  说明|
| :——– |:——–| :– |
| 0  | 无状态 | 空状态，冗余字段 |
| 1  | 预约中 | 院外抢单用状态 |
| 2  | 预约成功 | POS机管理老师代接单，并且派工之后的状态 |
| 3  | 待支付（在2小时内付款，超时被取消） | 院内订单下单之后的状态 |
| 4  | 已支付（支付成功） | 支付成功的状态 |
| 5  | 待服务（等待上门服务，计时） | 支付成功之后，2个小时之内保持待服务状态 |
| 6  | 服务中（服务进度） | 支付成功之后，2个小时之后进入服务中状态 |
| 7  | 待结算 | 用户(POS机)发起结算 （等待结算并提示用户结算，超时关闭订单）|
| 8  | 已完成 | 用户(POS机)发起结算之后，如果判断退款成功，状态变为完成 |
| 9  | 待评价 | 冗余状态 |
| 10  | 已评价 | 用户评价完成之后 |
| 11  | 已取消（取消成功） | 超时支付，自动变为取消|
| 12  | 申请退款（发起退款申请） | 待服务状态，申请全额退款的状态 |
| 13  | 退款中（退款已受理，并进行退款程序） | 发起退款的状态 |
| 14  | 退款成功 （退款额转入用户账户） | 用户(POS机)发起退款，如果确认退款成功，状态变为退款成功 |
| 15  | 退款失败（提示失败原因） | 用户(POS机)发起退款，如果确认退款失败，状态变为退款失败 |
| 16  | 变更待服务 | 发起订单变更之后的状态 |
| 17  | 结算中 | 用户(POS机)发起结算，状态变为结算中 |
| 18  | 结算完成 | 用户(POS机)发起结算，如果确认结算成功，状态变为结算完成 |
| 19  | 结算失败 | 用户(POS机)发起结算，如果确认结算失败，状态变为结算失败 |&lt;/p&gt;

&lt;h2 id=&quot;数据库设计&quot;&gt;数据库设计&lt;/h2&gt;

&lt;h3 id=&quot;订单主表&quot;&gt;订单主表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：用户下单、POS机下单、发生支付的订单变更
2 修改条件：支付、超时未支付、补录患者信息、订单变更、订单结算（用户或者POS发起的结算）、其他影响状态变化的节点
3 终止条件：超时未支付、订单完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| orduid|String|必须| 订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| ordid|String|必须| 订单ID|1804050053004W|
| uopid|String|必须| 患者openid| ooDqLwHXcSIFoMZxTX3DtHkLtaOM|
| tradeno|String|必须| 支付UID| TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| ptorduid|String|必须| 患者姓名| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| rlnm|String|必须| 父订单号，续单用，初始值为其本身如果有续单或者纠纷负单则为其父单orduid| 王根娣|
| startday|date|必须| 服务开始时间 默认当前日期| 2018-04-05|
| svcday|Integer|必须| 服务天数| 10|
| statncd|String|必须| 护工站代码| 31010700052|
| statnnm|String|必须| 护工站| 上海市同济大学附属同济医院(同济医院)|
| amount|Integer|必须| 订单初始预收金额| 90000|
| ordlessfee|Integer|| 订单剩余金额| 0|
| status1|Integer|| 0 无状态  &lt;br /&gt;1 预约中 &lt;br /&gt;2 预约成功 &lt;br /&gt;3 待支付（在2小时内付款，超时被取消） &lt;br /&gt;4 已支付（支付成功）&lt;br /&gt;5 待服务（等待上门服务，计时）&lt;br /&gt;6 服务中（服务进度）&lt;br /&gt;7 待结算（等待结算并提示用户结算，超时关闭订单）&lt;br /&gt;8 已完成 &lt;br /&gt;9 待评价 &lt;br /&gt;10 已评价&lt;br /&gt; 11 已取消（取消成功） &lt;br /&gt;12 申请退款（发起退款申请） &lt;br /&gt;13 退款中（退款已受理，并进行退款程序） &lt;br /&gt;14 退款成功 （退款额转入用户账户） &lt;br /&gt;15 退款失败（提示失败原因） &lt;br /&gt;16 变更待服务 &lt;br /&gt;17 结算中 &lt;br /&gt;18 结算完成 &lt;br /&gt;19结算失败 &lt;br /&gt;| 5|
| status1nm|String|| 同上| 待服务|
| usrconftm|datetime||用户确认完成时间| 2018-04-14 14:54:50|
| splitsttlfg|Integer|| 拆分结算标识0：未拆分结算，1已拆分结算| 0|
| continufee|Integer|| 结转金额| 0|
| chgstatus|Integer||  1 变更未开始 &lt;br /&gt;2 变更已开始&lt;br /&gt;| 0|
| sttlefg|Integer|| 结算标识：给用户退款订单结算掉，成功结算更新 0默认,1已结算| 0|&lt;/p&gt;

&lt;h3 id=&quot;订单详情表&quot;&gt;订单详情表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：用户下单、POS机下单、不发生支付的订单变更
2 修改条件：订单变更、订单结算（用户或POS发起的订单结算）、护工结束服务、其他影响状态变化的节点
3 终止条件：超时未支付、订单完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| orduid|String|必须| 订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| wuid|String|必须| 护工Uid| WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| wstatncd|String|必须| 所属网点 该护工所属网点|31010700052 |
| statncd|String|必须|服务网点 订单服务网点（非网点，没有代码） |31010700052 |
| hospnm|String|必须| 服务医院 医院名称| 上海市同济大学附属同济医院(同济医院)|
| sitmid|Integer|必须| 服务项目 当ordtp属于院内时| |
| svctp|String|必须| 交易号| TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| startday|date|必须| 服务开始时间 默认当前日期| 2018-04-05|
| svcday|Integer|必须| 服务天数| 10|
| unitprice|Integer|必须|  服务项目单价| 9000|
| amount|Integer|必须| 服务项目小计 服务项目单价 X 服务天数（精算）| 90000|
| adjustday|decimal(4,2)|| 调整天数 -0.5 0  0.5 三个值，在最后一天结算| 0|
| status1|Integer|| 0 无状态&lt;br /&gt;1 预约中 &lt;br /&gt;2 预约成功&lt;br /&gt;3 待支付（在15分钟内付款，超时被取消） &lt;br /&gt;4 已支付（支付成功）.&lt;br /&gt;5 待服务（等待上门服务，计时）&lt;br /&gt;6 服务中（服务进度）&lt;br /&gt;7 待结算（等待结算并提示用户结算，超时关闭订单）&lt;br /&gt;8 已完成&lt;br /&gt;9 待评价 &lt;br /&gt;10 已评价&lt;br /&gt;11 已取消（取消成功） &lt;br /&gt;12 申请退款（发起退款申请） &lt;br /&gt;13 退款中（退款已受理，并进行退款程序） &lt;br /&gt;14 退款成功 （退款额转入用户账户） &lt;br /&gt;15 退款失败（提示失败原因）&lt;br /&gt;16 变更待服务&lt;br /&gt;17 结算中 &lt;br /&gt;18 结算完成 &lt;br /&gt;19结算失败 | 5|
| status1nm|String||同上 | 待服务|
| status3|Integer|| 状态-完成 0 无状态 1 完成 | 1|
| status3nm|String|| 状态-完成-说明 保存护工的做工状态 | 完成|
| factsvcfg|Integer|| 子单实际服务标识：0 是默认，1 是结算退款记录， 2 是退款记录{tips:该子单是否是实际服务单} | 0|&lt;/p&gt;

&lt;h3 id=&quot;支付信息表&quot;&gt;支付信息表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：支付、退款、结算等，有金额流转的情况
2 修改条件：支付成功后状态 paid状态更新，结算申请发起、结算状态更新、退款状态发起、退款状态更新。
3 终止条件：超时未支付、支付完成、结算完成、退款完成、
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| tradeno|String|必须| 支付订单号 tr+”-“+36位UUID（带-）&lt;br /&gt;微信线上支付 pt开头&lt;br /&gt;微信扫码支付 td开头&lt;br /&gt;银联支付 tr开头|TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| orduid|String|必须| 订单UID 订单主表ID| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| uopid|String|| 用户UID 支付者UID，不一定是被服务的患者|ooDqLwHXcSIFoMZxTX3DtHkLtaOM|
| fopid|String|| 推荐者UID 推荐者UID||
| ttype|Integer|| 订单类型 1医院 2医院单项 3居家|1|
| paid|Integer|| 是否已支付 &lt;br /&gt;0 未支付 &lt;br /&gt;1 线上支付 &lt;br /&gt;2 现金支付&lt;br /&gt;3 退款成功&lt;br /&gt;4 退款失败|1|
| paidtm|datetime|| 支付时间 非0的时候 才有值|2018-04-05 10:58:56|
| payment|Integer|| 支付方式 &lt;br /&gt;1 微信 &lt;br /&gt;2 刷卡（借记卡） &lt;br /&gt;3 刷卡（信用卡） &lt;br /&gt;4 现金（线下支付）&lt;br /&gt; 5 支付宝|1|
| amount|Integer|| 支付金额|90000|
| outorderno|String|| 外部订单号 外部订单号||
| outtransno|String|| 外部流水号 外部流水号|4200000095201804052560224795|
| resttlfg|Integer|| 预结算标志位：0未结算，1已结算||
| sttlfg|Integer|| 已结算标志 0未结算 1 已结算||
| sttlamt|Integer|| 结算金额||
| invoicetm|datetime|| 预分账标志位||
| reinvfg|Integer|| 分账标志||
| invoicefg|Integer|| ||
| refund|Integer|| 退款标志 现阶段价格统一。&lt;br /&gt;该字段为空，当每个省价格不同时，会用到。&lt;br /&gt;0是付款 1是退款|0|
| cardNo|String|| 银联支付用字段: 支付时所用的卡号(该字段当银联支付退款时使用)||
| transChnName|String|| 支付渠道名称||
| transEngName|String|| 支付渠道||
| refNo|String|| 银联支付用参考号||
| merchantNo|String|| 根据支付时的，商户编号||
| terminalNo|String|| pos机终端号码||
| traceNo|String|| 银联商务支付的记录号(每一个pos机从1开始计数)||&lt;/p&gt;

&lt;h3 id=&quot;日结表&quot;&gt;日结表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：开始服务的订单，每日12:30/23:30 进行结算
2 修改条件：无
3 终止条件：预付款消耗完为止
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| daysttuid|String|必须| 日结算UID|DST_VwACGXWSvbwTfEm9I_6dPyvWKkw2|
| orduid|String|必须| 订单UID 订单主表ID| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| porduid|String|必须| 母单orduid| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| sttdate|date|必须| 结算日期| 2018-04-05|
| wuid|String|必须| 护工wuid|WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| daysttfee|Integer|| 日结算金额|9000|
| lessordfee|Integer|| 订单剩余金额(结余金额)|81000|
| daystttm|datetime|| 结算时间|2018-04-09 23:30:00|
| unitprice|Integer|| 单价 | 9000 |
| statncd|String|| 做单护工站 | 31010700052 |
| plusfee|String|| 增收 | 450 |
| wrkfee|String|| 护工工资 | 5400 |
| hospfee|String|| 医院管理费 | 900 |
| companyfee|String|| 管理费（公司管理费:statncd=wstatncd的时候该字段和服务项目单价拆分的公司管理费一致，如果statncd&amp;lt;&amp;gt;wstatncd三七开的订单，则此字段记录总利润 即=sttamount - wrkfee - recomfee） | 2033 |
| platamount|String|| 平台费用 | 0 |
| deptfee|String|| 科室费 | 100 |
| insuranfee|String|| 保险费 | 0 |
| recomfee|String|| 推荐有奖金额 | 0 |
| platformfee|String|| 护工点击结束后用户遗留平台金额 | 0 |
| payfee|String|| 支付金额 | 90000 |
| usrnewordfee|String|| 用户续单结转 | 0 |
| refundfee|String|| 退款金额 | 0 |&lt;/p&gt;

&lt;h3 id=&quot;结算表&quot;&gt;结算表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：结算完成
2 修改条件：无
3 终止条件：结算完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;字段名&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;必须&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sttuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;日结算UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ST_o9wTyvpiSuSqmbjsMonkilWvm7qXz&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orduid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单UID 订单主表ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;subid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单Subid, 子单号&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;statncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;需求方所在护工站，如果院外非网点或居家为空&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工所在护工站&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工wuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sttamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;结算金额(合算=医院管理费+护工工资+毛利润)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;90000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unitprice&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;单价 护工身价*系数（目前100%）+保险&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svcday&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务天数&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;10&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;plusfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;增收&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工工资&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;54000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;hospfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;医院管理费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;companyfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;管理费（公司管理费:statncd=wstatncd的时候该字段和服务项目单价拆分的公司管理费一致，如果statncd&amp;lt;&amp;gt;wstatncd三七开的订单，则此字段记录总利润 即=sttamount - wrkfee - recomfee）&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;21383&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;平台费用&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;deptfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;科室费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;insuranfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;保险费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;recomfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;推荐有奖金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platformfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工点击结束后用户遗留平台金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;payfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;支付金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;90000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;usrnewordfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;用户续单结转&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;invoicefg&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;分账标识0未分账，1已分账 针对是否分账到qo_ord_fin_statn_invoice表而标识&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;isdowrkfeefg&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工工资标识&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;护工站分账明细&quot;&gt;护工站分账明细&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：结算完成
2 修改条件：无
3 终止条件：结算完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;字段名&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;必须&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;finuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;利益分账UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FI_5NN3QewfIAJPKvTANe2xwG8nPFmUM&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sttuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;日结算UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ST_o9wTyvpiSuSqmbjsMonkilWvm7qXz&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orduid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单UID 订单主表ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;requirstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;发单方statncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;requirfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;发单方收益&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;派单方statncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkstatnfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;派单方收益&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工工资&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;54000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;hospfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;医院管理费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;recomfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;推荐有奖金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;insurfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;保险费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;plusfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;增收&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;suplid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;加盟商cd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;suplfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;发单方加盟商收益&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;21383&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platfeee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;平台遗留金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;平台费用&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;护工工资表&quot;&gt;护工工资表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：护工点击完成服务，+15天之后分账
2 修改条件：无
3 终止条件：护工点击完成服务，+15天之后分账
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| wiuid|String|必须| 收入UIDWI开头32位UUID|WI_DxhX4TG2DPkqMyCLLETeUoa4nbtJ0|
| wuid|String|必须| 护工编号UIDWK开头32位UUID|WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| witp|Integer|必须| 收入类型收入类型 1 订单 2 推荐分享 3 奖励 4 积分换取 |1|
| income|Integer|必须| 收入单位是分 |54000|
| status|Integer|必须| 状态&lt;br /&gt;0 订单服务中 &lt;br /&gt;1 等待结算  &lt;br /&gt;2 系统审核中 &lt;br /&gt;9已生效&lt;br /&gt; (订单服务中状态为0，&lt;br /&gt;订单服务截止之间到但未被结算状态为1,&lt;br /&gt;订单被投诉 状态为2，&lt;br /&gt;订单结束并结算再加14天 状态为9，) |2|
| cashed|Integer|必须| 是否已提现0 未体现 1 已提现 |1|
| cashtm|DateTime|必须| 提现时间提现的时间 |2018-04-09 23:30:00|&lt;/p&gt;

&lt;h2 id=&quot;订单状态变化与结算数据的流程&quot;&gt;订单状态变化与结算数据的流程&lt;/h2&gt;
&lt;h3 id=&quot;订单状态变化时序图&quot;&gt;订单状态变化(时序图):&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-sequence&quot;&gt;用户端-&amp;gt;[数据库]: 1 用户自主下单(院外订单)
用户端-&amp;gt;[数据库]: 2 用户自主下单(院内订单)
POS机-&amp;gt;[数据库]: POS机管理老师接单、并且派工
[批处理]-&amp;gt;[数据库]: 2小时无人反映，取消订单
用户端-&amp;gt;[数据库]: [￥支付 微信 ]
POS机-&amp;gt;[数据库]: [￥收款：微信/支付宝/银行卡/现金]
[批处理]-&amp;gt;[批处理]: 30分钟内不支付，支付状态超时
[批处理]--&amp;gt;[数据库]: 取消订单
[批处理]-&amp;gt;[批处理]: 支付成功之后，2小时内处于待服务状态，超过2小时进入服务中
[批处理]--&amp;gt;[数据库]: 待服务-&amp;gt;服务中
[数据库]--&amp;gt;用户端: 查看订单信息
[数据库]-&amp;gt;PC端: 查看订单信息
[数据库]-&amp;gt;护工端: 查看订单信息
护工端--&amp;gt;用户端: 推送服务日志
用户端-&amp;gt;[数据库]: 发起结算
[批处理]--&amp;gt;[批处理]: 发起结算、向银行请求数据、进入结算中状态
[批处理]--&amp;gt;[批处理]: 判断结算申请的结果、
[批处理]--&amp;gt;[数据库]: 结算成功/结算失败 -&amp;gt; 更新状态
[数据库]-&amp;gt;[数据库]: 服务结束时间判断
用户端--&amp;gt;护工端: 订单结算
护工端--&amp;gt;[数据库]: 服务结算
POS机--&amp;gt;用户端: 订单强制结算
POS机--&amp;gt;护工端: 订单强制结算
用户端-&amp;gt;[数据库]:用户评价、状态进入已评价状态
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;后台批处理接口说明&quot;&gt;后台批处理接口说明&lt;/h2&gt;

&lt;h3 id=&quot;01-支付超时的处理&quot;&gt;01. 支付超时的处理&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderCancelUnpaid&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 清理超过2小时的订单未支付的订单
 2 订单变更的处理，当2个小时内不支付，已经申请变更的订单自动变成过期未支付状态
 3 每天 8-20点之间，每分钟执行&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;02-订单变更审核超时的处理&quot;&gt;02. 订单变更审核超时的处理&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/cancelUnaplyToUnPayOrd&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 次日生效 24小时后 不审批 取消并且退款
 2 当日及时生效 6小时后 遍生效 取消并且退款&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;03-订单变更待服务的处理&quot;&gt;03. 订单变更待服务的处理&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderChangeSerStart&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 修改变更服务变成待服务(立即执行) 没有支付的订单变更
 2 只有审批通过的变更待服务才能进入服务状态，否者停留在永远待服务的状态
 3 每分钟执行&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;04-退款给用户的处理微信&quot;&gt;04. 退款给用户的处理（微信）&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderRefundToUser&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 判断订单状态为7，立即退款给用户
 2 每分钟执行&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;05-退款给用户的处理银联&quot;&gt;05. 退款给用户的处理（银联）&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/doRefundToUserUpay&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 判断订单状态为7，立即退款给用户
 2 每分钟执行&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;06-待服务进入服务中无需支付&quot;&gt;06. 待服务进入服务中(无需支付)&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderWaitSerToSer&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 订单支付成功2小时后，待服务进入服务中
 2 每分钟执行，订单支付时间到当前时间有2小时的订单&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;07-变更待服务进入服务中有支付&quot;&gt;07. 变更待服务进入服务中(有支付)&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderChangeWaitSerToSer&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 变更订单的等待状态变成开始服务 有支付状态的订单变更
 2 只有审批通过的变更待服务才能进入服务状态，否者停留在永远待服务的状态
 3 每分钟执行，订单支付时间到当前时间有2小时的订单&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;08-订单拆分&quot;&gt;08. 订单拆分&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/finSplitSttle&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 针对每个订单的拆分细则，拆分 护工工资、平台费、科室费、保险费、公司所得等费用&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;09-分账给护工站&quot;&gt;09. 分账给护工站&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/finInvoiceToStatn&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 针对每个订单的拆分细则，拆分 护工工资、平台费、科室费、保险费、公司所得等费用到具体的护工站&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;10-日结脚本&quot;&gt;10. 日结脚本&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/ordDayStt&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 针对每个订单做当日结算，消耗当天费用，并且拆分 护工工资、平台费、科室费、保险费、公司所得等费用
 2 每天12:30 23:30 跑该脚本&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;11-护工工资结算改变状态脚本&quot;&gt;11. 护工工资结算改变状态脚本&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/doSettleWrkfee&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 根据日结结果，计算每日护工工资
 2 每天1点15分 跑该脚本&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;12-订单逾期脚本&quot;&gt;12. 订单逾期脚本&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/ordFinishStt&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 结算到期订单用户未点击的订单 ，结算成逾期，并且释放床位
 2 每天1点30分 跑该脚本&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;13-订单结算状态脚本&quot;&gt;13. 订单结算状态脚本&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/doSttlement&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 对于用户已经点击结算，护工已经点击结束服务的订单，跑的脚本
 2 分钟跑该脚本&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>kei gosling</name></author><summary type="html">01. 订单与结算逻辑.结算与支付</summary></entry><entry><title type="html">启东团队制</title><link href="https://thefirstwind.github.io//2020-10-03-%E5%90%AF%E4%B8%9C%E5%9B%A2%E9%98%9F%E5%88%B6/" rel="alternate" type="text/html" title="启东团队制" /><published>2020-10-03T00:00:00+08:00</published><updated>2020-10-03T00:00:00+08:00</updated><id>https://thefirstwind.github.io//%E5%90%AF%E4%B8%9C%E5%9B%A2%E9%98%9F%E5%88%B6</id><content type="html" xml:base="https://thefirstwind.github.io//2020-10-03-%E5%90%AF%E4%B8%9C%E5%9B%A2%E9%98%9F%E5%88%B6/">&lt;p&gt;启东团队制的设计&lt;/p&gt;

&lt;h3 id=&quot;业务数据-病区表-qmgrqm_hosp_pstn&quot;&gt;业务数据 病区表 qmgr.qm_hosp_pstn&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 修改条件：POS机代下单的时候，如果有优惠金额， discfg 和 discamount将发生变化
2 当有优惠的时候，影响的字段只有 discfg和 discamount
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| pstnid|Integer|必须| 病区ID |1|
| statncd|Integer|必须| 护工站ID | 31010700052|
| statnnm|String|必须| 护工站名称 | 上海市同济大学附属同济医院(同济医院) |
| building|String|必须| 楼信息 | 观留 |
| floor|String|必须| 层信息 | 1 |
| distrct|String|必须| 病区 | 五官科 |
| &lt;b&gt;usvctp1fg&lt;/b&gt;|String|必须| 一对一订单是否可以在用户端 自主下单 0 不可以 1可以| 1 （启东是0）|
| &lt;b&gt;usvctp2fg&lt;/b&gt;|String|必须| 一对多订单是否可以在用户端 自主下单 0 不可以 1可以| 1 （启东是0）|
| &lt;b&gt;usvctp3fg&lt;/b&gt;|String|必须| 用户端是否可以自主下团队制订单 0 不可以 1可以| 0 （启东是1）|
| &lt;b&gt;grpfg&lt;/b&gt;|String|必须| pos机 团队制标签 0 非团队制 1可以团队制| 0 启东是1）|
| &lt;b&gt;grpprice&lt;/b&gt;|String|必须| 团队制默认价格| 0 启东是500）|&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;12.images/screencapture-localhost-8888-chosemode-2018-09-12-13_22_44.png&quot; alt=&quot;screencapture-localhost-8888-chosemode-2018-09-12-13_22_44&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;12.images/screencapture-localhost-8888-chosemode-2018-09-12-17_01_29.png&quot; alt=&quot;screencapture-localhost-8888-chosemode-2018-09-12-17_01_29&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;12.images/screencapture-localhost-8888-chosemode-2018-09-12-17_02_11.png&quot; alt=&quot;screencapture-localhost-8888-chosemode-2018-09-12-17_02_11&quot; /&gt;&lt;/p&gt;</content><author><name>kei gosling</name></author><summary type="html">启东团队制的设计</summary></entry><entry><title type="html">Oa3.0 账户中心</title><link href="https://thefirstwind.github.io//2020-10-03-oa3.0-%E8%B4%A6%E6%88%B7%E4%B8%AD%E5%BF%83/" rel="alternate" type="text/html" title="Oa3.0 账户中心" /><published>2020-10-03T00:00:00+08:00</published><updated>2020-10-03T00:00:00+08:00</updated><id>https://thefirstwind.github.io//oa3.0-%E8%B4%A6%E6%88%B7%E4%B8%AD%E5%BF%83</id><content type="html" xml:base="https://thefirstwind.github.io//2020-10-03-oa3.0-%E8%B4%A6%E6%88%B7%E4%B8%AD%E5%BF%83/">&lt;h1 id=&quot;oa30-账户中心设计&quot;&gt;OA3.0 账户中心设计&lt;/h1&gt;

&lt;blockquote&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;时间&lt;/strong&gt;：2020年11月2日&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;公司&lt;/strong&gt;：上海摩易科技发展有限公司&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;作者&lt;/strong&gt;：邢晓宁&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;版权声明&lt;/strong&gt;：著作权归上海摩易科技发展有限公司所有，未经允许请勿擅自分享给公司外部人员。&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;p&gt;[TOC]&lt;/p&gt;

&lt;h2 id=&quot;概要&quot;&gt;概要&lt;/h2&gt;

&lt;div class=&quot;plantuml&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; contentScriptType=&quot;application/ecmascript&quot; contentStyleType=&quot;text/css&quot; height=&quot;1321px&quot; preserveAspectRatio=&quot;none&quot; style=&quot;width:623px;height:1321px;&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 623 1321&quot; width=&quot;623px&quot; zoomAndPan=&quot;magnify&quot;&gt;&lt;defs&gt;&lt;filter height=&quot;300%&quot; id=&quot;f1ar4rdsewrgki&quot; width=&quot;300%&quot; x=&quot;-1&quot; y=&quot;-1&quot;&gt;&lt;feGaussianBlur result=&quot;blurOut&quot; stdDeviation=&quot;2.0&quot;/&gt;&lt;feColorMatrix in=&quot;blurOut&quot; result=&quot;blurOut2&quot; type=&quot;matrix&quot; values=&quot;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0&quot;/&gt;&lt;feOffset dx=&quot;4.0&quot; dy=&quot;4.0&quot; in=&quot;blurOut2&quot; result=&quot;blurOut3&quot;/&gt;&lt;feBlend in=&quot;SourceGraphic&quot; in2=&quot;blurOut3&quot; mode=&quot;normal&quot;/&gt;&lt;/filter&gt;&lt;/defs&gt;&lt;g&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;76&quot; x=&quot;10&quot; y=&quot;641.3711&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;20&quot; y=&quot;664.9063&quot;&gt;账户中心&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;76&quot; x=&quot;136&quot; y=&quot;76.4883&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;146&quot; y=&quot;100.0234&quot;&gt;账户金额&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;262&quot; y=&quot;20&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;272&quot; y=&quot;43.5352&quot;&gt;总额&lt;/text&gt;&lt;path d=&quot;M212,94.7324 L222,94.7324 C237,94.7324 237,38.2441 252,38.2441 L262,38.2441 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;76&quot; x=&quot;262&quot; y=&quot;76.4883&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;272&quot; y=&quot;100.0234&quot;&gt;可提现额&lt;/text&gt;&lt;path d=&quot;M212,94.7324 L222,94.7324 C237,94.7324 237,94.7324 252,94.7324 L262,94.7324 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;62&quot; x=&quot;262&quot; y=&quot;132.9766&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;272&quot; y=&quot;156.5117&quot;&gt;冻结额&lt;/text&gt;&lt;path d=&quot;M212,94.7324 L222,94.7324 C237,94.7324 237,151.2207 252,151.2207 L262,151.2207 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;path d=&quot;M86,659.6152 L96,659.6152 C111,659.6152 111,94.7324 126,94.7324 L136,94.7324 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;132&quot; x=&quot;136&quot; y=&quot;471.9063&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;112&quot; x=&quot;146&quot; y=&quot;495.4414&quot;&gt;账户额度变化快照&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;318&quot; y=&quot;302.4414&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;328&quot; y=&quot;325.9766&quot;&gt;角色&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;416&quot; y=&quot;189.4648&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;426&quot; y=&quot;213&quot;&gt;用户&lt;/text&gt;&lt;path d=&quot;M366,320.6855 L376,320.6855 C391,320.6855 391,207.709 406,207.709 L416,207.709 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;416&quot; y=&quot;245.9531&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;426&quot; y=&quot;269.4883&quot;&gt;护工&lt;/text&gt;&lt;path d=&quot;M366,320.6855 L376,320.6855 C391,320.6855 391,264.1973 406,264.1973 L416,264.1973 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;416&quot; y=&quot;302.4414&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;426&quot; y=&quot;325.9766&quot;&gt;护士&lt;/text&gt;&lt;path d=&quot;M366,320.6855 L376,320.6855 C391,320.6855 391,320.6855 406,320.6855 L416,320.6855 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;416&quot; y=&quot;358.9297&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;426&quot; y=&quot;382.4648&quot;&gt;商家&lt;/text&gt;&lt;path d=&quot;M366,320.6855 L376,320.6855 C391,320.6855 391,377.1738 406,377.1738 L416,377.1738 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;416&quot; y=&quot;415.418&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;426&quot; y=&quot;438.9531&quot;&gt;平台&lt;/text&gt;&lt;path d=&quot;M366,320.6855 L376,320.6855 C391,320.6855 391,433.6621 406,433.6621 L416,433.6621 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;path d=&quot;M268,490.1504 L278,490.1504 C293,490.1504 293,320.6855 308,320.6855 L318,320.6855 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;318&quot; y=&quot;613.127&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;328&quot; y=&quot;636.6621&quot;&gt;类型&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;416&quot; y=&quot;528.3945&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;426&quot; y=&quot;551.9297&quot;&gt;收入&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;90&quot; x=&quot;514&quot; y=&quot;471.9063&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;70&quot; x=&quot;524&quot; y=&quot;495.4414&quot;&gt;变化前额度&lt;/text&gt;&lt;path d=&quot;M464,546.6387 L474,546.6387 C489,546.6387 489,490.1504 504,490.1504 L514,490.1504 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;90&quot; x=&quot;514&quot; y=&quot;528.3945&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;70&quot; x=&quot;524&quot; y=&quot;551.9297&quot;&gt;变化后额度&lt;/text&gt;&lt;path d=&quot;M464,546.6387 L474,546.6387 C489,546.6387 489,546.6387 504,546.6387 L514,546.6387 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;76&quot; x=&quot;514&quot; y=&quot;584.8828&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;524&quot; y=&quot;608.418&quot;&gt;快照时间&lt;/text&gt;&lt;path d=&quot;M464,546.6387 L474,546.6387 C489,546.6387 489,603.127 504,603.127 L514,603.127 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;path d=&quot;M366,631.3711 L376,631.3711 C391,631.3711 391,546.6387 406,546.6387 L416,546.6387 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;416&quot; y=&quot;697.8594&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;426&quot; y=&quot;721.3945&quot;&gt;支出&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;90&quot; x=&quot;514&quot; y=&quot;641.3711&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;70&quot; x=&quot;524&quot; y=&quot;664.9063&quot;&gt;变化前额度&lt;/text&gt;&lt;path d=&quot;M464,716.1035 L474,716.1035 C489,716.1035 489,659.6152 504,659.6152 L514,659.6152 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;90&quot; x=&quot;514&quot; y=&quot;697.8594&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;70&quot; x=&quot;524&quot; y=&quot;721.3945&quot;&gt;变化后额度&lt;/text&gt;&lt;path d=&quot;M464,716.1035 L474,716.1035 C489,716.1035 489,716.1035 504,716.1035 L514,716.1035 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;76&quot; x=&quot;514&quot; y=&quot;754.3477&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;524&quot; y=&quot;777.8828&quot;&gt;快照时间&lt;/text&gt;&lt;path d=&quot;M464,716.1035 L474,716.1035 C489,716.1035 489,772.5918 504,772.5918 L514,772.5918 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;path d=&quot;M366,631.3711 L376,631.3711 C391,631.3711 391,716.1035 406,716.1035 L416,716.1035 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;path d=&quot;M268,490.1504 L278,490.1504 C293,490.1504 293,631.3711 308,631.3711 L318,631.3711 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;path d=&quot;M86,659.6152 L96,659.6152 C111,659.6152 111,490.1504 126,490.1504 L136,490.1504 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;76&quot; x=&quot;136&quot; y=&quot;923.8125&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;146&quot; y=&quot;947.3477&quot;&gt;明细流水&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;262&quot; y=&quot;867.3242&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;272&quot; y=&quot;890.8594&quot;&gt;收入&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;76&quot; x=&quot;360&quot; y=&quot;810.8359&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;370&quot; y=&quot;834.3711&quot;&gt;入账金额&lt;/text&gt;&lt;path d=&quot;M310,885.5684 L320,885.5684 C335,885.5684 335,829.0801 350,829.0801 L360,829.0801 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;76&quot; x=&quot;360&quot; y=&quot;867.3242&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;370&quot; y=&quot;890.8594&quot;&gt;入账时间&lt;/text&gt;&lt;path d=&quot;M310,885.5684 L320,885.5684 C335,885.5684 335,885.5684 350,885.5684 L360,885.5684 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;76&quot; x=&quot;360&quot; y=&quot;923.8125&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;370&quot; y=&quot;947.3477&quot;&gt;关联订单&lt;/text&gt;&lt;path d=&quot;M310,885.5684 L320,885.5684 C335,885.5684 335,942.0566 350,942.0566 L360,942.0566 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;path d=&quot;M212,942.0566 L222,942.0566 C237,942.0566 237,885.5684 252,885.5684 L262,885.5684 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;262&quot; y=&quot;1008.5449&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;272&quot; y=&quot;1032.0801&quot;&gt;支出&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;76&quot; x=&quot;360&quot; y=&quot;980.3008&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;370&quot; y=&quot;1003.8359&quot;&gt;支出金额&lt;/text&gt;&lt;path d=&quot;M310,1026.7891 L320,1026.7891 C335,1026.7891 335,998.5449 350,998.5449 L360,998.5449 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;76&quot; x=&quot;360&quot; y=&quot;1036.7891&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;370&quot; y=&quot;1060.3242&quot;&gt;支出时间&lt;/text&gt;&lt;path d=&quot;M310,1026.7891 L320,1026.7891 C335,1026.7891 335,1055.0332 350,1055.0332 L360,1055.0332 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;path d=&quot;M212,942.0566 L222,942.0566 C237,942.0566 237,1026.7891 252,1026.7891 L262,1026.7891 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;path d=&quot;M86,659.6152 L96,659.6152 C111,659.6152 111,942.0566 126,942.0566 L136,942.0566 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;136&quot; y=&quot;1121.5215&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;146&quot; y=&quot;1145.0566&quot;&gt;账单&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;62&quot; x=&quot;234&quot; y=&quot;1093.2773&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;244&quot; y=&quot;1116.8125&quot;&gt;日账单&lt;/text&gt;&lt;path d=&quot;M184,1139.7656 L194,1139.7656 C209,1139.7656 209,1111.5215 224,1111.5215 L234,1111.5215 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;62&quot; x=&quot;234&quot; y=&quot;1149.7656&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;244&quot; y=&quot;1173.3008&quot;&gt;月账单&lt;/text&gt;&lt;path d=&quot;M184,1139.7656 L194,1139.7656 C209,1139.7656 209,1168.0098 224,1168.0098 L234,1168.0098 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;path d=&quot;M86,659.6152 L96,659.6152 C111,659.6152 111,1139.7656 126,1139.7656 L136,1139.7656 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;136&quot; y=&quot;1234.498&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;146&quot; y=&quot;1258.0332&quot;&gt;动作&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;234&quot; y=&quot;1206.2539&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;244&quot; y=&quot;1229.7891&quot;&gt;提现&lt;/text&gt;&lt;path d=&quot;M184,1252.7422 L194,1252.7422 C209,1252.7422 209,1224.498 224,1224.498 L234,1224.498 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1ar4rdsewrgki)&quot; height=&quot;36.4883&quot; rx=&quot;12.5&quot; ry=&quot;12.5&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;48&quot; x=&quot;234&quot; y=&quot;1262.7422&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;244&quot; y=&quot;1286.2773&quot;&gt;充值&lt;/text&gt;&lt;path d=&quot;M184,1252.7422 L194,1252.7422 C209,1252.7422 209,1280.9863 224,1280.9863 L234,1280.9863 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;path d=&quot;M86,659.6152 L96,659.6152 C111,659.6152 111,1252.7422 126,1252.7422 L136,1252.7422 &quot; fill=&quot;none&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;!--MD5=[03e70f226b0754e779cb3dfb601706d1]
@startmindmap

* 账户中心
** 账户金额
*** 总额
*** 可提现额
*** 冻结额
** 账户额度变化快照
*** 角色
**** 用户
**** 护工
**** 护士
**** 商家
**** 平台
*** 类型
**** 收入
***** 变化前额度
***** 变化后额度
***** 快照时间
**** 支出
***** 变化前额度
***** 变化后额度
***** 快照时间
** 明细流水
*** 收入
**** 入账金额
**** 入账时间
**** 关联订单
*** 支出
**** 支出金额
**** 支出时间
** 账单
*** 日账单
*** 月账单
** 动作
*** 提现
*** 充值

@endmindmap

PlantUML version 1.2020.18(Thu Oct 01 03:40:44 CST 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: CN
--&gt;&lt;/g&gt;&lt;/svg&gt;&lt;/div&gt;
&lt;h2 id=&quot;用户相关的账户操作&quot;&gt;用户相关的账户操作&lt;/h2&gt;
&lt;div class=&quot;plantuml&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; contentScriptType=&quot;application/ecmascript&quot; contentStyleType=&quot;text/css&quot; height=&quot;1066px&quot; preserveAspectRatio=&quot;none&quot; style=&quot;width:606px;height:1066px;&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 606 1066&quot; width=&quot;606px&quot; zoomAndPan=&quot;magnify&quot;&gt;&lt;defs&gt;&lt;filter height=&quot;300%&quot; id=&quot;fn8blmq9gyplj&quot; width=&quot;300%&quot; x=&quot;-1&quot; y=&quot;-1&quot;&gt;&lt;feGaussianBlur result=&quot;blurOut&quot; stdDeviation=&quot;2.0&quot;/&gt;&lt;feColorMatrix in=&quot;blurOut&quot; result=&quot;blurOut2&quot; type=&quot;matrix&quot; values=&quot;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0&quot;/&gt;&lt;feOffset dx=&quot;4.0&quot; dy=&quot;4.0&quot; in=&quot;blurOut2&quot; result=&quot;blurOut3&quot;/&gt;&lt;feBlend in=&quot;SourceGraphic&quot; in2=&quot;blurOut3&quot; mode=&quot;normal&quot;/&gt;&lt;/filter&gt;&lt;/defs&gt;&lt;g&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;28&quot; x2=&quot;28&quot; y1=&quot;40.4883&quot; y2=&quot;1022.8047&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;130&quot; x2=&quot;130&quot; y1=&quot;40.4883&quot; y2=&quot;1022.8047&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;243&quot; x2=&quot;243&quot; y1=&quot;40.4883&quot; y2=&quot;1022.8047&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;340&quot; x2=&quot;340&quot; y1=&quot;40.4883&quot; y2=&quot;1022.8047&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;471&quot; x2=&quot;471&quot; y1=&quot;40.4883&quot; y2=&quot;1022.8047&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;557&quot; x2=&quot;557&quot; y1=&quot;40.4883&quot; y2=&quot;1022.8047&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;42&quot; x=&quot;5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;12&quot; y=&quot;25.5352&quot;&gt;用户&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;42&quot; x=&quot;5&quot; y=&quot;1021.8047&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;12&quot; y=&quot;1042.3398&quot;&gt;用户&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;42&quot; x=&quot;107&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;114&quot; y=&quot;25.5352&quot;&gt;充值&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;42&quot; x=&quot;107&quot; y=&quot;1021.8047&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;114&quot; y=&quot;1042.3398&quot;&gt;充值&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;70&quot; x=&quot;206&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;213&quot; y=&quot;25.5352&quot;&gt;账户入账&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;70&quot; x=&quot;206&quot; y=&quot;1021.8047&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;213&quot; y=&quot;1042.3398&quot;&gt;账户入账&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;70&quot; x=&quot;303&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;310&quot; y=&quot;25.5352&quot;&gt;账户余额&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;70&quot; x=&quot;303&quot; y=&quot;1021.8047&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;310&quot; y=&quot;1042.3398&quot;&gt;账户余额&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;70&quot; x=&quot;434&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;441&quot; y=&quot;25.5352&quot;&gt;账户出账&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;70&quot; x=&quot;434&quot; y=&quot;1021.8047&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;441&quot; y=&quot;1042.3398&quot;&gt;账户出账&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;70&quot; x=&quot;520&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;527&quot; y=&quot;25.5352&quot;&gt;企业支付&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;70&quot; x=&quot;520&quot; y=&quot;1021.8047&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;527&quot; y=&quot;1042.3398&quot;&gt;企业支付&lt;/text&gt;&lt;rect fill=&quot;#EEEEEE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;3&quot; style=&quot;stroke: #EEEEEE; stroke-width: 1.0;&quot; width=&quot;599&quot; x=&quot;0&quot; y=&quot;71.1436&quot;/&gt;&lt;line style=&quot;stroke: #000000; stroke-width: 1.0;&quot; x1=&quot;0&quot; x2=&quot;599&quot; y1=&quot;71.1436&quot; y2=&quot;71.1436&quot;/&gt;&lt;line style=&quot;stroke: #000000; stroke-width: 1.0;&quot; x1=&quot;0&quot; x2=&quot;599&quot; y1=&quot;74.1436&quot; y2=&quot;74.1436&quot;/&gt;&lt;rect fill=&quot;#EEEEEE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;23.3105&quot; style=&quot;stroke: #000000; stroke-width: 2.0;&quot; width=&quot;44&quot; x=&quot;277.5&quot; y=&quot;60.4883&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; font-weight=&quot;bold&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;26&quot; x=&quot;283.5&quot; y=&quot;77.0566&quot;&gt;充值&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;118,111.1094,128,115.1094,118,119.1094,122,115.1094&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;28&quot; x2=&quot;124&quot; y1=&quot;115.1094&quot; y2=&quot;115.1094&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;35&quot; y=&quot;110.3672&quot;&gt;调用充值接口&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;231,140.4199,241,144.4199,231,148.4199,235,144.4199&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;130&quot; x2=&quot;237&quot; y1=&quot;144.4199&quot; y2=&quot;144.4199&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;89&quot; x=&quot;137&quot; y=&quot;139.6777&quot;&gt;申请入账100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;328,169.7305,338,173.7305,328,177.7305,332,173.7305&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;243&quot; x2=&quot;334&quot; y1=&quot;173.7305&quot; y2=&quot;173.7305&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;73&quot; x=&quot;250&quot; y=&quot;168.9883&quot;&gt;余额+100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;39,199.041,29,203.041,39,207.041,35,203.041&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;33&quot; x2=&quot;339&quot; y1=&quot;203.041&quot; y2=&quot;203.041&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;45&quot; y=&quot;198.2988&quot;&gt;返回余额&lt;/text&gt;&lt;rect fill=&quot;#EEEEEE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;3&quot; style=&quot;stroke: #EEEEEE; stroke-width: 1.0;&quot; width=&quot;599&quot; x=&quot;0&quot; y=&quot;231.6963&quot;/&gt;&lt;line style=&quot;stroke: #000000; stroke-width: 1.0;&quot; x1=&quot;0&quot; x2=&quot;599&quot; y1=&quot;231.6963&quot; y2=&quot;231.6963&quot;/&gt;&lt;line style=&quot;stroke: #000000; stroke-width: 1.0;&quot; x1=&quot;0&quot; x2=&quot;599&quot; y1=&quot;234.6963&quot; y2=&quot;234.6963&quot;/&gt;&lt;rect fill=&quot;#EEEEEE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;23.3105&quot; style=&quot;stroke: #000000; stroke-width: 2.0;&quot; width=&quot;70&quot; x=&quot;264.5&quot; y=&quot;221.041&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; font-weight=&quot;bold&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;270.5&quot; y=&quot;237.6094&quot;&gt;账户支付&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;328,271.6621,338,275.6621,328,279.6621,332,275.6621&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;28&quot; x2=&quot;334&quot; y1=&quot;275.6621&quot; y2=&quot;275.6621&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;117&quot; x=&quot;35&quot; y=&quot;270.9199&quot;&gt;校验余额 &amp;gt;= 100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;459,300.9727,469,304.9727,459,308.9727,463,304.9727&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;340&quot; x2=&quot;465&quot; y1=&quot;304.9727&quot; y2=&quot;304.9727&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;89&quot; x=&quot;347&quot; y=&quot;300.2305&quot;&gt;申请出账100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;351,330.2832,341,334.2832,351,338.2832,347,334.2832&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;345&quot; x2=&quot;470&quot; y1=&quot;334.2832&quot; y2=&quot;334.2832&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;71&quot; x=&quot;357&quot; y=&quot;329.541&quot;&gt;余额-100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;39,359.5938,29,363.5938,39,367.5938,35,363.5938&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;33&quot; x2=&quot;339&quot; y1=&quot;363.5938&quot; y2=&quot;363.5938&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;45&quot; y=&quot;358.8516&quot;&gt;余额支付成功&lt;/text&gt;&lt;rect fill=&quot;#EEEEEE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;3&quot; style=&quot;stroke: #EEEEEE; stroke-width: 1.0;&quot; width=&quot;599&quot; x=&quot;0&quot; y=&quot;392.249&quot;/&gt;&lt;line style=&quot;stroke: #000000; stroke-width: 1.0;&quot; x1=&quot;0&quot; x2=&quot;599&quot; y1=&quot;392.249&quot; y2=&quot;392.249&quot;/&gt;&lt;line style=&quot;stroke: #000000; stroke-width: 1.0;&quot; x1=&quot;0&quot; x2=&quot;599&quot; y1=&quot;395.249&quot; y2=&quot;395.249&quot;/&gt;&lt;rect fill=&quot;#EEEEEE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;23.3105&quot; style=&quot;stroke: #000000; stroke-width: 2.0;&quot; width=&quot;176&quot; x=&quot;211.5&quot; y=&quot;381.5938&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; font-weight=&quot;bold&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;158&quot; x=&quot;217.5&quot; y=&quot;398.1621&quot;&gt;订单支付(充值 + 账户支付)&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;118,432.2148,128,436.2148,118,440.2148,122,436.2148&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;28&quot; x2=&quot;124&quot; y1=&quot;436.2148&quot; y2=&quot;436.2148&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;35&quot; y=&quot;431.4727&quot;&gt;调用支付接口&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;231,461.5254,241,465.5254,231,469.5254,235,465.5254&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;130&quot; x2=&quot;237&quot; y1=&quot;465.5254&quot; y2=&quot;465.5254&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;89&quot; x=&quot;137&quot; y=&quot;460.7832&quot;&gt;申请入账100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;328,490.8359,338,494.8359,328,498.8359,332,494.8359&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;243&quot; x2=&quot;334&quot; y1=&quot;494.8359&quot; y2=&quot;494.8359&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;73&quot; x=&quot;250&quot; y=&quot;490.0938&quot;&gt;余额+100元&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;340&quot; x2=&quot;382&quot; y1=&quot;524.1465&quot; y2=&quot;524.1465&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;382&quot; x2=&quot;382&quot; y1=&quot;524.1465&quot; y2=&quot;537.1465&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;341&quot; x2=&quot;382&quot; y1=&quot;537.1465&quot; y2=&quot;537.1465&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;351,533.1465,341,537.1465,351,541.1465,347,537.1465&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;117&quot; x=&quot;347&quot; y=&quot;519.4043&quot;&gt;校验余额 &amp;gt;= 100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;459,562.457,469,566.457,459,570.457,463,566.457&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;340&quot; x2=&quot;465&quot; y1=&quot;566.457&quot; y2=&quot;566.457&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;89&quot; x=&quot;347&quot; y=&quot;561.7148&quot;&gt;申请出账100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;351,591.7676,341,595.7676,351,599.7676,347,595.7676&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;345&quot; x2=&quot;470&quot; y1=&quot;595.7676&quot; y2=&quot;595.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;71&quot; x=&quot;357&quot; y=&quot;591.0254&quot;&gt;余额-100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;39,621.0781,29,625.0781,39,629.0781,35,625.0781&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;33&quot; x2=&quot;339&quot; y1=&quot;625.0781&quot; y2=&quot;625.0781&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;45&quot; y=&quot;620.3359&quot;&gt;余额支付成功&lt;/text&gt;&lt;rect fill=&quot;#EEEEEE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;3&quot; style=&quot;stroke: #EEEEEE; stroke-width: 1.0;&quot; width=&quot;599&quot; x=&quot;0&quot; y=&quot;653.7334&quot;/&gt;&lt;line style=&quot;stroke: #000000; stroke-width: 1.0;&quot; x1=&quot;0&quot; x2=&quot;599&quot; y1=&quot;653.7334&quot; y2=&quot;653.7334&quot;/&gt;&lt;line style=&quot;stroke: #000000; stroke-width: 1.0;&quot; x1=&quot;0&quot; x2=&quot;599&quot; y1=&quot;656.7334&quot; y2=&quot;656.7334&quot;/&gt;&lt;rect fill=&quot;#EEEEEE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;23.3105&quot; style=&quot;stroke: #000000; stroke-width: 2.0;&quot; width=&quot;70&quot; x=&quot;264.5&quot; y=&quot;643.0781&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; font-weight=&quot;bold&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;270.5&quot; y=&quot;659.6465&quot;&gt;账户退款&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;328,693.6992,338,697.6992,328,701.6992,332,697.6992&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;28&quot; x2=&quot;334&quot; y1=&quot;697.6992&quot; y2=&quot;697.6992&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;273&quot; x=&quot;35&quot; y=&quot;692.957&quot;&gt;用户或系统发起退款申请、校验余额 &amp;gt;= 100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;545,723.0098,555,727.0098,545,731.0098,549,727.0098&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;340&quot; x2=&quot;551&quot; y1=&quot;727.0098&quot; y2=&quot;727.0098&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;193&quot; x=&quot;347&quot; y=&quot;722.2676&quot;&gt;申请企业支付，退款100元给用户&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;482,752.3203,472,756.3203,482,760.3203,478,756.3203&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;476&quot; x2=&quot;556&quot; y1=&quot;756.3203&quot; y2=&quot;756.3203&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;488&quot; y=&quot;751.5781&quot;&gt;支付成功&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;351,781.6309,341,785.6309,351,789.6309,347,785.6309&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;345&quot; x2=&quot;470&quot; y1=&quot;785.6309&quot; y2=&quot;785.6309&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;45&quot; x=&quot;357&quot; y=&quot;780.8887&quot;&gt;-100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;39,810.9414,29,814.9414,39,818.9414,35,814.9414&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;33&quot; x2=&quot;339&quot; y1=&quot;814.9414&quot; y2=&quot;814.9414&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;104&quot; x=&quot;45&quot; y=&quot;810.1992&quot;&gt;通知用户退款成功&lt;/text&gt;&lt;rect fill=&quot;#EEEEEE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;3&quot; style=&quot;stroke: #EEEEEE; stroke-width: 1.0;&quot; width=&quot;599&quot; x=&quot;0&quot; y=&quot;843.5967&quot;/&gt;&lt;line style=&quot;stroke: #000000; stroke-width: 1.0;&quot; x1=&quot;0&quot; x2=&quot;599&quot; y1=&quot;843.5967&quot; y2=&quot;843.5967&quot;/&gt;&lt;line style=&quot;stroke: #000000; stroke-width: 1.0;&quot; x1=&quot;0&quot; x2=&quot;599&quot; y1=&quot;846.5967&quot; y2=&quot;846.5967&quot;/&gt;&lt;rect fill=&quot;#EEEEEE&quot; filter=&quot;url(#fn8blmq9gyplj)&quot; height=&quot;23.3105&quot; style=&quot;stroke: #000000; stroke-width: 2.0;&quot; width=&quot;119&quot; x=&quot;240&quot; y=&quot;832.9414&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; font-weight=&quot;bold&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;101&quot; x=&quot;246&quot; y=&quot;849.5098&quot;&gt;提现(同账户退款)&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;328,883.5625,338,887.5625,328,891.5625,332,887.5625&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;28&quot; x2=&quot;334&quot; y1=&quot;887.5625&quot; y2=&quot;887.5625&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;234&quot; x=&quot;35&quot; y=&quot;882.8203&quot;&gt;用户发起提现申请、校验余额 &amp;gt;= 100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;545,912.873,555,916.873,545,920.873,549,916.873&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;340&quot; x2=&quot;551&quot; y1=&quot;916.873&quot; y2=&quot;916.873&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;193&quot; x=&quot;347&quot; y=&quot;912.1309&quot;&gt;申请企业支付，提现100元给用户&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;482,942.1836,472,946.1836,482,950.1836,478,946.1836&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;476&quot; x2=&quot;556&quot; y1=&quot;946.1836&quot; y2=&quot;946.1836&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;488&quot; y=&quot;941.4414&quot;&gt;支付成功&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;351,971.4941,341,975.4941,351,979.4941,347,975.4941&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;345&quot; x2=&quot;470&quot; y1=&quot;975.4941&quot; y2=&quot;975.4941&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;45&quot; x=&quot;357&quot; y=&quot;970.752&quot;&gt;-100元&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;39,1000.8047,29,1004.8047,39,1008.8047,35,1004.8047&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;33&quot; x2=&quot;339&quot; y1=&quot;1004.8047&quot; y2=&quot;1004.8047&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;104&quot; x=&quot;45&quot; y=&quot;1000.0625&quot;&gt;通知用户提现成功&lt;/text&gt;&lt;!--MD5=[4bbe57803fbc17712babd9439e9e2e6f]
@startuml 

== 充值 ==
用户 -&gt; 充值 : 调用充值接口
充值 -&gt; 账户入账 : 申请入账100元
账户入账 -&gt; 账户余额 : 余额+100元
账户余额 -&gt; 用户: 返回余额
== 账户支付 ==
用户 -&gt; 账户余额: 校验余额 &gt;= 100元
账户余额 -&gt; 账户出账: 申请出账100元
账户出账 -&gt; 账户余额: 余额-100元
账户余额 -&gt; 用户: 余额支付成功
== 订单支付(充值 + 账户支付) ==
用户 -&gt; 充值 : 调用支付接口
充值 -&gt; 账户入账 : 申请入账100元
账户入账 -&gt; 账户余额 : 余额+100元
账户余额 -&gt; 账户余额: 校验余额 &gt;= 100元
账户余额 -&gt; 账户出账: 申请出账100元
账户出账 -&gt; 账户余额: 余额-100元
账户余额 -&gt; 用户: 余额支付成功
== 账户退款 ==
用户 -&gt; 账户余额: 用户或系统发起退款申请、校验余额 &gt;= 100元
账户余额 -&gt; 企业支付: 申请企业支付，退款100元给用户
企业支付 -&gt; 账户出账: 支付成功
账户出账 -&gt; 账户余额: -100元
账户余额 -&gt; 用户: 通知用户退款成功
== 提现(同账户退款) ==
用户 -&gt; 账户余额: 用户发起提现申请、校验余额 &gt;= 100元
账户余额 -&gt; 企业支付: 申请企业支付，提现100元给用户
企业支付 -&gt; 账户出账: 支付成功
账户出账 -&gt; 账户余额: -100元
账户余额 -&gt; 用户: 通知用户提现成功
@enduml

PlantUML version 1.2020.18(Thu Oct 01 03:40:44 CST 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: CN
--&gt;&lt;/g&gt;&lt;/svg&gt;&lt;/div&gt;
&lt;h2 id=&quot;数据字典&quot;&gt;数据字典&lt;/h2&gt;

&lt;h3 id=&quot;系统角色&quot;&gt;系统角色&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;端&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;用户群体&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;终端类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;终端名称&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;用户端&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者、消费者&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;微信公众号&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;E护通&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工端&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;院内护工、居家护工&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;微信公众号&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;E护通|护工&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护士端&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;提供上门服务的在册护士&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;微信公众号/APP&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护通|专护&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;POS机端&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;擎浩医院管理老师&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;POS机&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;PC端&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;财务、运营、系统管理员等&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;PC电脑端&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;统计端&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;院方高层、护理界高层&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;微信公众号&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;擎浩护理&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;院内订单类型&quot;&gt;院内订单类型&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;订单类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;前提条件&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;工资计算说明&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1对1订单&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;院内有机动护工&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;系统计算、每日按照比例分配&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1对多订单&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;当前病区绑定了护工&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;系统计算、每日按照比例分配&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;团队制订单&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;当前病区支持团队制&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;不统计报表&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;单项订单&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;擎浩医院管理老师&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;待定&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;下单相关流程&quot;&gt;下单相关流程&lt;/h2&gt;
&lt;h3 id=&quot;用户下单时序图&quot;&gt;用户下单(时序图):&lt;/h3&gt;

&lt;div class=&quot;plantuml&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; contentScriptType=&quot;application/ecmascript&quot; contentStyleType=&quot;text/css&quot; height=&quot;641px&quot; preserveAspectRatio=&quot;none&quot; style=&quot;width:598px;height:641px;&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 598 641&quot; width=&quot;598px&quot; zoomAndPan=&quot;magnify&quot;&gt;&lt;defs&gt;&lt;filter height=&quot;300%&quot; id=&quot;f1chjn0nnjwm9c&quot; width=&quot;300%&quot; x=&quot;-1&quot; y=&quot;-1&quot;&gt;&lt;feGaussianBlur result=&quot;blurOut&quot; stdDeviation=&quot;2.0&quot;/&gt;&lt;feColorMatrix in=&quot;blurOut&quot; result=&quot;blurOut2&quot; type=&quot;matrix&quot; values=&quot;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0&quot;/&gt;&lt;feOffset dx=&quot;4.0&quot; dy=&quot;4.0&quot; in=&quot;blurOut2&quot; result=&quot;blurOut3&quot;/&gt;&lt;feBlend in=&quot;SourceGraphic&quot; in2=&quot;blurOut3&quot; mode=&quot;normal&quot;/&gt;&lt;/filter&gt;&lt;/defs&gt;&lt;g&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;35&quot; x2=&quot;35&quot; y1=&quot;40.4883&quot; y2=&quot;597.7676&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;139.5&quot; x2=&quot;139.5&quot; y1=&quot;40.4883&quot; y2=&quot;597.7676&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;375&quot; x2=&quot;375&quot; y1=&quot;40.4883&quot; y2=&quot;597.7676&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;493&quot; x2=&quot;493&quot; y1=&quot;40.4883&quot; y2=&quot;597.7676&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;558&quot; x2=&quot;558&quot; y1=&quot;40.4883&quot; y2=&quot;597.7676&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;56&quot; x=&quot;5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;12&quot; y=&quot;25.5352&quot;&gt;用户端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;56&quot; x=&quot;5&quot; y=&quot;596.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;12&quot; y=&quot;617.3027&quot;&gt;用户端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;55&quot; x=&quot;110.5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;41&quot; x=&quot;117.5&quot; y=&quot;25.5352&quot;&gt;POS机&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;55&quot; x=&quot;110.5&quot; y=&quot;596.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;41&quot; x=&quot;117.5&quot; y=&quot;617.3027&quot;&gt;POS机&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;42&quot; x=&quot;352&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;359&quot; y=&quot;25.5352&quot;&gt;系统&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;42&quot; x=&quot;352&quot; y=&quot;596.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;359&quot; y=&quot;617.3027&quot;&gt;系统&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;46&quot; x=&quot;468&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;32&quot; x=&quot;475&quot; y=&quot;25.5352&quot;&gt;PC端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;46&quot; x=&quot;468&quot; y=&quot;596.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;32&quot; x=&quot;475&quot; y=&quot;617.3027&quot;&gt;PC端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;56&quot; x=&quot;528&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;535&quot; y=&quot;25.5352&quot;&gt;护工端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;56&quot; x=&quot;528&quot; y=&quot;596.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;535&quot; y=&quot;617.3027&quot;&gt;护工端&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;128,67.7988,138,71.7988,128,75.7988,132,71.7988&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;35&quot; x2=&quot;134&quot; y1=&quot;71.7988&quot; y2=&quot;71.7988&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;26&quot; x=&quot;42&quot; y=&quot;67.0566&quot;&gt;下单&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;128,97.1094,138,101.1094,128,105.1094,132,101.1094&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;35&quot; x2=&quot;134&quot; y1=&quot;101.1094&quot; y2=&quot;101.1094&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;81&quot; x=&quot;42&quot; y=&quot;96.3672&quot;&gt;[￥支付 微信 ]&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;363,126.4199,373,130.4199,363,134.4199,367,130.4199&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;35&quot; x2=&quot;369&quot; y1=&quot;130.4199&quot; y2=&quot;130.4199&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;42&quot; y=&quot;125.6777&quot;&gt;更新数据&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;151,155.7305,141,159.7305,151,163.7305,147,159.7305&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;145&quot; x2=&quot;374&quot; y1=&quot;159.7305&quot; y2=&quot;159.7305&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;157&quot; y=&quot;154.9883&quot;&gt;推送消息&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;363,185.041,373,189.041,363,193.041,367,189.041&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;140&quot; x2=&quot;369&quot; y1=&quot;189.041&quot; y2=&quot;189.041&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;117&quot; x=&quot;147&quot; y=&quot;184.2988&quot;&gt;评估、补录患者信息&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;363,214.3516,373,218.3516,363,222.3516,367,218.3516&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;140&quot; x2=&quot;369&quot; y1=&quot;218.3516&quot; y2=&quot;218.3516&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;211&quot; x=&quot;147&quot; y=&quot;213.6094&quot;&gt;[￥收款：微信/支付宝/银行卡/现金]&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;46,243.6621,36,247.6621,46,251.6621,42,247.6621&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;40&quot; x2=&quot;374&quot; y1=&quot;247.6621&quot; y2=&quot;247.6621&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;52&quot; y=&quot;242.9199&quot;&gt;查看订单信息&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;481,272.9727,491,276.9727,481,280.9727,485,276.9727&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;375&quot; x2=&quot;487&quot; y1=&quot;276.9727&quot; y2=&quot;276.9727&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;382&quot; y=&quot;272.2305&quot;&gt;查看订单信息&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;546,302.2832,556,306.2832,546,310.2832,550,306.2832&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;375&quot; x2=&quot;552&quot; y1=&quot;306.2832&quot; y2=&quot;306.2832&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;382&quot; y=&quot;301.541&quot;&gt;查看订单信息&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;375&quot; x2=&quot;417&quot; y1=&quot;335.5938&quot; y2=&quot;335.5938&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;417&quot; x2=&quot;417&quot; y1=&quot;335.5938&quot; y2=&quot;348.5938&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;376&quot; x2=&quot;417&quot; y1=&quot;348.5938&quot; y2=&quot;348.5938&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;386,344.5938,376,348.5938,386,352.5938,382,348.5938&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;104&quot; x=&quot;382&quot; y=&quot;330.8516&quot;&gt;服务开始时间判断&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;375&quot; x2=&quot;417&quot; y1=&quot;377.9043&quot; y2=&quot;377.9043&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;417&quot; x2=&quot;417&quot; y1=&quot;377.9043&quot; y2=&quot;390.9043&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;376&quot; x2=&quot;417&quot; y1=&quot;390.9043&quot; y2=&quot;390.9043&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;386,386.9043,376,390.9043,386,394.9043,382,390.9043&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;39&quot; x=&quot;382&quot; y=&quot;373.1621&quot;&gt;服务中&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;46,416.2148,36,420.2148,46,424.2148,42,420.2148&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;40&quot; x2=&quot;557&quot; y1=&quot;420.2148&quot; y2=&quot;420.2148&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;52&quot; y=&quot;415.4727&quot;&gt;推送服务日志&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;375&quot; x2=&quot;417&quot; y1=&quot;449.5254&quot; y2=&quot;449.5254&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;417&quot; x2=&quot;417&quot; y1=&quot;449.5254&quot; y2=&quot;462.5254&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;376&quot; x2=&quot;417&quot; y1=&quot;462.5254&quot; y2=&quot;462.5254&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;386,458.5254,376,462.5254,386,466.5254,382,462.5254&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;104&quot; x=&quot;382&quot; y=&quot;444.7832&quot;&gt;服务结束时间判断&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;546,487.8359,556,491.8359,546,495.8359,550,491.8359&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;35&quot; x2=&quot;552&quot; y1=&quot;491.8359&quot; y2=&quot;491.8359&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;42&quot; y=&quot;487.0938&quot;&gt;订单结算&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;386,517.1465,376,521.1465,386,525.1465,382,521.1465&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;380&quot; x2=&quot;557&quot; y1=&quot;521.1465&quot; y2=&quot;521.1465&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;392&quot; y=&quot;516.4043&quot;&gt;服务结算&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;46,546.457,36,550.457,46,554.457,42,550.457&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;40&quot; x2=&quot;139&quot; y1=&quot;550.457&quot; y2=&quot;550.457&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;52&quot; y=&quot;545.7148&quot;&gt;订单强制结算&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;546,575.7676,556,579.7676,546,583.7676,550,579.7676&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;140&quot; x2=&quot;552&quot; y1=&quot;579.7676&quot; y2=&quot;579.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;147&quot; y=&quot;575.0254&quot;&gt;订单强制结算&lt;/text&gt;&lt;!--MD5=[65f6bd65aa493c41f24ebf0887da110f]
@startuml
用户端 -&gt; POS机: 下单
用户端 -&gt; POS机: [￥支付 微信 ]
用户端 - -&gt; 系统: 更新数据
系统 - -&gt; POS机: 推送消息
POS机 -&gt; 系统: 评估、补录患者信息
POS机 -&gt; 系统: [￥收款：微信/支付宝/银行卡/现金]
系统 - -&gt; 用户端: 查看订单信息
系统 -&gt; PC端: 查看订单信息
系统 -&gt; 护工端: 查看订单信息
系统 -&gt; 系统: 服务开始时间判断
系统 -&gt; 系统: 服务中
护工端 - -&gt; 用户端: 推送服务日志
系统 -&gt; 系统: 服务结束时间判断
用户端 - -&gt; 护工端: 订单结算
护工端 - -&gt; 系统: 服务结算
POS机 - -&gt; 用户端: 订单强制结算
POS机 - -&gt; 护工端: 订单强制结算
@enduml

PlantUML version 1.2020.18(Thu Oct 01 03:40:44 CST 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: CN
--&gt;&lt;/g&gt;&lt;/svg&gt;&lt;/div&gt;
&lt;h3 id=&quot;pos机代下单时序图&quot;&gt;POS机代下单(时序图):&lt;/h3&gt;
&lt;div class=&quot;plantuml&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; contentScriptType=&quot;application/ecmascript&quot; contentStyleType=&quot;text/css&quot; height=&quot;465px&quot; preserveAspectRatio=&quot;none&quot; style=&quot;width:564px;height:465px;&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 564 465&quot; width=&quot;564px&quot; zoomAndPan=&quot;magnify&quot;&gt;&lt;defs&gt;&lt;filter height=&quot;300%&quot; id=&quot;f4nxb9snur6dg&quot; width=&quot;300%&quot; x=&quot;-1&quot; y=&quot;-1&quot;&gt;&lt;feGaussianBlur result=&quot;blurOut&quot; stdDeviation=&quot;2.0&quot;/&gt;&lt;feColorMatrix in=&quot;blurOut&quot; result=&quot;blurOut2&quot; type=&quot;matrix&quot; values=&quot;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0&quot;/&gt;&lt;feOffset dx=&quot;4.0&quot; dy=&quot;4.0&quot; in=&quot;blurOut2&quot; result=&quot;blurOut3&quot;/&gt;&lt;feBlend in=&quot;SourceGraphic&quot; in2=&quot;blurOut3&quot; mode=&quot;normal&quot;/&gt;&lt;/filter&gt;&lt;/defs&gt;&lt;g&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;34&quot; x2=&quot;34&quot; y1=&quot;40.4883&quot; y2=&quot;421.9043&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;269.5&quot; x2=&quot;269.5&quot; y1=&quot;40.4883&quot; y2=&quot;421.9043&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;387.5&quot; x2=&quot;387.5&quot; y1=&quot;40.4883&quot; y2=&quot;421.9043&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;459.5&quot; x2=&quot;459.5&quot; y1=&quot;40.4883&quot; y2=&quot;421.9043&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;524.5&quot; x2=&quot;524.5&quot; y1=&quot;40.4883&quot; y2=&quot;421.9043&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f4nxb9snur6dg)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;55&quot; x=&quot;5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;41&quot; x=&quot;12&quot; y=&quot;25.5352&quot;&gt;POS机&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f4nxb9snur6dg)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;55&quot; x=&quot;5&quot; y=&quot;420.9043&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;41&quot; x=&quot;12&quot; y=&quot;441.4395&quot;&gt;POS机&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f4nxb9snur6dg)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;42&quot; x=&quot;246.5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;253.5&quot; y=&quot;25.5352&quot;&gt;系统&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f4nxb9snur6dg)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;42&quot; x=&quot;246.5&quot; y=&quot;420.9043&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;253.5&quot; y=&quot;441.4395&quot;&gt;系统&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f4nxb9snur6dg)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;70&quot; x=&quot;350.5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;357.5&quot; y=&quot;25.5352&quot;&gt;用户手机&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f4nxb9snur6dg)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;70&quot; x=&quot;350.5&quot; y=&quot;420.9043&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;357.5&quot; y=&quot;441.4395&quot;&gt;用户手机&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f4nxb9snur6dg)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;46&quot; x=&quot;434.5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;32&quot; x=&quot;441.5&quot; y=&quot;25.5352&quot;&gt;PC端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f4nxb9snur6dg)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;46&quot; x=&quot;434.5&quot; y=&quot;420.9043&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;32&quot; x=&quot;441.5&quot; y=&quot;441.4395&quot;&gt;PC端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f4nxb9snur6dg)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;56&quot; x=&quot;494.5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;501.5&quot; y=&quot;25.5352&quot;&gt;护工端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f4nxb9snur6dg)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;56&quot; x=&quot;494.5&quot; y=&quot;420.9043&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;501.5&quot; y=&quot;441.4395&quot;&gt;护工端&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;257.5,67.7988,267.5,71.7988,257.5,75.7988,261.5,71.7988&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;34.5&quot; x2=&quot;263.5&quot; y1=&quot;71.7988&quot; y2=&quot;71.7988&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;117&quot; x=&quot;41.5&quot; y=&quot;67.0566&quot;&gt;填写用户信息、下单&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;257.5,97.1094,267.5,101.1094,257.5,105.1094,261.5,101.1094&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;34.5&quot; x2=&quot;263.5&quot; y1=&quot;101.1094&quot; y2=&quot;101.1094&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;211&quot; x=&quot;41.5&quot; y=&quot;96.3672&quot;&gt;[￥收款：微信/支付宝/银行卡/现金]&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;375.5,126.4199,385.5,130.4199,375.5,134.4199,379.5,130.4199&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;269.5&quot; x2=&quot;381.5&quot; y1=&quot;130.4199&quot; y2=&quot;130.4199&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;276.5&quot; y=&quot;125.6777&quot;&gt;推送短信&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;280.5,155.7305,270.5,159.7305,280.5,163.7305,276.5,159.7305&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;274.5&quot; x2=&quot;458.5&quot; y1=&quot;159.7305&quot; y2=&quot;159.7305&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;286.5&quot; y=&quot;154.9883&quot;&gt;查看订单信息&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;280.5,185.041,270.5,189.041,280.5,193.041,276.5,189.041&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;274.5&quot; x2=&quot;523.5&quot; y1=&quot;189.041&quot; y2=&quot;189.041&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;286.5&quot; y=&quot;184.2988&quot;&gt;查看订单信息&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;269.5&quot; x2=&quot;311.5&quot; y1=&quot;218.3516&quot; y2=&quot;218.3516&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;311.5&quot; x2=&quot;311.5&quot; y1=&quot;218.3516&quot; y2=&quot;231.3516&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;270.5&quot; x2=&quot;311.5&quot; y1=&quot;231.3516&quot; y2=&quot;231.3516&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;280.5,227.3516,270.5,231.3516,280.5,235.3516,276.5,231.3516&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;104&quot; x=&quot;276.5&quot; y=&quot;213.6094&quot;&gt;服务开始时间判断&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;269.5&quot; x2=&quot;311.5&quot; y1=&quot;260.6621&quot; y2=&quot;260.6621&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;311.5&quot; x2=&quot;311.5&quot; y1=&quot;260.6621&quot; y2=&quot;273.6621&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;270.5&quot; x2=&quot;311.5&quot; y1=&quot;273.6621&quot; y2=&quot;273.6621&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;280.5,269.6621,270.5,273.6621,280.5,277.6621,276.5,273.6621&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;39&quot; x=&quot;276.5&quot; y=&quot;255.9199&quot;&gt;服务中&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;269.5&quot; x2=&quot;311.5&quot; y1=&quot;302.9727&quot; y2=&quot;302.9727&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;311.5&quot; x2=&quot;311.5&quot; y1=&quot;302.9727&quot; y2=&quot;315.9727&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;270.5&quot; x2=&quot;311.5&quot; y1=&quot;315.9727&quot; y2=&quot;315.9727&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;280.5,311.9727,270.5,315.9727,280.5,319.9727,276.5,315.9727&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;104&quot; x=&quot;276.5&quot; y=&quot;298.2305&quot;&gt;服务结束时间判断&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;280.5,341.2832,270.5,345.2832,280.5,349.2832,276.5,345.2832&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;274.5&quot; x2=&quot;523.5&quot; y1=&quot;345.2832&quot; y2=&quot;345.2832&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;286.5&quot; y=&quot;340.541&quot;&gt;服务结算&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;375.5,370.5938,385.5,374.5938,375.5,378.5938,379.5,374.5938&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;34.5&quot; x2=&quot;381.5&quot; y1=&quot;374.5938&quot; y2=&quot;374.5938&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;143&quot; x=&quot;41.5&quot; y=&quot;369.8516&quot;&gt;订单强制结算、推送短信&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;512.5,399.9043,522.5,403.9043,512.5,407.9043,516.5,403.9043&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;34.5&quot; x2=&quot;518.5&quot; y1=&quot;403.9043&quot; y2=&quot;403.9043&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;41.5&quot; y=&quot;399.1621&quot;&gt;订单强制结算&lt;/text&gt;&lt;!--MD5=[f62b36b81f38d9a1713f56ac7ae9ca8a]
@startuml

POS机 -&gt; 系统 : 填写用户信息、下单
POS机 -&gt; 系统: [￥收款：微信/支付宝/银行卡/现金]
系统 - -&gt; 用户手机: 推送短信
PC端 -&gt; 系统: 查看订单信息
护工端 -&gt; 系统: 查看订单信息
系统 -&gt; 系统: 服务开始时间判断
系统-&gt; 系统: 服务中
系统-&gt; 系统: 服务结束时间判断
护工端 - -&gt; 系统: 服务结算
POS机 - -&gt; 用户手机: 订单强制结算、推送短信
POS机 - -&gt; 护工端: 订单强制结算

@enduml

PlantUML version 1.2020.18(Thu Oct 01 03:40:44 CST 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: CN
--&gt;&lt;/g&gt;&lt;/svg&gt;&lt;/div&gt;
&lt;h2 id=&quot;下单接口文档&quot;&gt;下单接口文档&lt;/h2&gt;

&lt;h3 id=&quot;1-用户端下单接口说明&quot;&gt;1. 用户端下单接口说明&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;请求URL&lt;/strong&gt;
    &lt;blockquote&gt;
      &lt;p&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8881/api/order/create&lt;/a&gt;&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;请求方式&lt;/strong&gt;
    &lt;blockquote&gt;
      &lt;p&gt;&lt;strong&gt;POST&lt;/strong&gt;&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;请求参数&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;请求参数&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;必须&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;uopid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;用户Uopid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;odkVKsyBVCiPkzsiJtmCaaAPs6Xc&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ordtp&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单类型&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svctp&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务类型：1 一对一 / 2 一对多 / 3 团队制&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svcday&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务天数&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;uphone&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者手机号码&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;18616579337&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;startday&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Date&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务开始时间&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;2018-08-13&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;pstnid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;病区ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;581&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bed&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;床位号&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;33&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sitmid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;价格ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;297&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svctp2&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务类型2&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;nightcare&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Boolean&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;夜陪标志&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;true&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;age&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;年龄&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;76&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;disease&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;疾病标签&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;rlnm&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者真实姓名&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者姓名&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sex&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;性别：0 女 1男&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;WK_cSjgwj5nIhdzJ_kfd83oNnH6I8yBZ&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;返回参数&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;返回参数&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;success&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;boolean&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;请求成功与否&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;code&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;执行结果code&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;message&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;执行结果&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;执行成功&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orduid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单号码&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ORD_48dj2B3vU1NkPOQjYpveN6YPOo05&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;返回示例&lt;/strong&gt;
    &lt;blockquote&gt;

      &lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;success&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;操作正确&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;orduid&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ORD_48dj2B3vU1NkPOQjYpveN6YPOo05&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;      &lt;/div&gt;
      &lt;h3 id=&quot;2-pos机代下单接口文档&quot;&gt;2. POS机代下单接口文档&lt;/h3&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;请求URL&lt;/strong&gt;
    &lt;blockquote&gt;
      &lt;p&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8883/api/posorder/replace&lt;/a&gt;&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;请求方式&lt;/strong&gt;
    &lt;blockquote&gt;
      &lt;p&gt;&lt;strong&gt;POST&lt;/strong&gt;&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;请求参数&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;请求参数&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;必须&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;所在护工站CD&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010900053&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svctp&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务类型：1 一对一 / 2 一对多 / 3 团队制&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svcday&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务天数&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;8&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;uphone&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者手机&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;18616579337&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;startday&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Date&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务开始时间&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;2018-08-13&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;pstnid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;病区ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;581&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bed&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;床位号&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;age&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;年龄&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;76&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;disease&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;疾病标签&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;rlnm&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者真实姓名&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者姓名&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sex&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;性别：0 女 1男&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;WK_cSjgwj5nIhdzJ_kfd83oNnH6I8yBZ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;uoipd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;用户uopid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;null&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sitmid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;价格ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;297&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;grpamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;团队制订单价格&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;null&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;返回参数&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;返回参数&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;success&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;boolean&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;请求成功与否&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;code&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;执行结果code&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;message&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;执行结果消息&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orduid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;执行结果消息&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ORD_X7IS7TYobMXybv9hfEqPFoavsrQw&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;返回示例&lt;/strong&gt;
    &lt;blockquote&gt;

      &lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;success&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;操作正确&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;orduid&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ORD_X7IS7TYobMXybv9hfEqPFoavsrQw&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;      &lt;/div&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>kei gosling</name></author><summary type="html">OA3.0 账户中心设计</summary></entry><entry><title type="html">订单与结算逻辑 订单变更</title><link href="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E8%AE%A2%E5%8D%95%E5%8F%98%E6%9B%B4/" rel="alternate" type="text/html" title="订单与结算逻辑 订单变更" /><published>2020-10-03T00:00:00+08:00</published><updated>2020-10-03T00:00:00+08:00</updated><id>https://thefirstwind.github.io//%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E8%AE%A2%E5%8D%95%E5%8F%98%E6%9B%B4</id><content type="html" xml:base="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E8%AE%A2%E5%8D%95%E5%8F%98%E6%9B%B4/">&lt;h1 id=&quot;03-订单与结算逻辑订单变更&quot;&gt;03. 订单与结算逻辑.订单变更&lt;/h1&gt;

&lt;blockquote&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;时间&lt;/strong&gt;：2018年9月7日&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;@[订单, 结算逻辑, 订单变更]&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;[TOC]&lt;/p&gt;

&lt;h2 id=&quot;订单变更业务范围&quot;&gt;订单变更业务范围&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;1 订单类型： 服务中&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;2 适用场景：&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;更换护工&lt;/li&gt;
    &lt;li&gt;更换服务项目&lt;/li&gt;
    &lt;li&gt;更换床位&lt;/li&gt;
    &lt;li&gt;更换病区&lt;/li&gt;
    &lt;li&gt;修改服务天数&lt;/li&gt;
    &lt;li&gt;续单&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;3 注意事项：&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;由于无法明确 当产生护工变更的情况下 工资如何发放，因此订单变更&lt;/li&gt;
    &lt;li&gt;不产生支付的情况下，POS机变更 无须POS机管理端审核&lt;/li&gt;
    &lt;li&gt;当产生支付的情况下，POS机变更 需要管理老师审核，如果6个小时内不审核的话，订单变更将无效&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;数据字典&quot;&gt;数据字典&lt;/h2&gt;

&lt;h3 id=&quot;系统角色&quot;&gt;系统角色&lt;/h3&gt;
&lt;p&gt;| 端  |    用户群体 |    终端类型 | 终端名称  |
| :——– |:——–| :–: |:——–|
| 用户端  |患者、消费者 | 微信公众号 | E护通  |
| 护工端  |院内护工、居家护工 |  微信公众号  | E护通|护工  |
| 护士端  |提供上门服务的在册护士 | 微信公众号/APP  | 护通|专护 |
| POS机端 |擎浩医院管理老师| POS机  |  |
| PC端 |财务、运营、系统管理员等| PC电脑端 |   |
| 统计端|院方高层、护理界高层| 微信公众号  | 擎浩护理  |&lt;/p&gt;

&lt;h3 id=&quot;订单状态&quot;&gt;订单状态&lt;/h3&gt;
&lt;p&gt;| 状态  | 状态名称 |  说明|
| :——– |:——–| :– |
| 0  | 无状态 | 空状态，冗余字段 |
| 1  | 预约中 | 院外抢单用状态 |
| 2  | 预约成功 | POS机管理老师代接单，并且派工之后的状态 |
| 3  | 待支付（在2小时内付款，超时被取消） | 院内订单下单之后的状态 |
| 4  | 已支付（支付成功） | 支付成功的状态 |
| 5  | 待服务（等待上门服务，计时） | 支付成功之后，2个小时之内保持待服务状态 |
| 6  | 服务中（服务进度） | 支付成功之后，2个小时之后进入服务中状态 |
| 7  | 待结算 | 用户(POS机)发起结算 （等待结算并提示用户结算，超时关闭订单）|
| 8  | 已完成 | 用户(POS机)发起结算之后，如果判断退款成功，状态变为完成 |
| 9  | 待评价 | 冗余状态 |
| 10  | 已评价 | 用户评价完成之后 |
| 11  | 已取消（取消成功） | 超时支付，自动变为取消|
| 12  | 申请退款（发起退款申请） | 待服务状态，申请全额退款的状态 |
| 13  | 退款中（退款已受理，并进行退款程序） | 发起退款的状态 |
| 14  | 退款成功 （退款额转入用户账户） | 用户(POS机)发起退款，如果确认退款成功，状态变为退款成功 |
| 15  | 退款失败（提示失败原因） | 用户(POS机)发起退款，如果确认退款失败，状态变为退款失败 |
| 16  | 变更待服务 | 发起订单变更之后的状态 |
| 17  | 结算中 | 用户(POS机)发起结算，状态变为结算中 |
| 18  | 结算完成 | 用户(POS机)发起结算，如果确认结算成功，状态变为结算完成 |
| 19  | 结算失败 | 用户(POS机)发起结算，如果确认结算失败，状态变为结算失败 |&lt;/p&gt;

&lt;h2 id=&quot;数据库设计&quot;&gt;数据库设计&lt;/h2&gt;
&lt;h3 id=&quot;订单变更表&quot;&gt;订单变更表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：服务中的订单，发生变化的情况
2 修改条件：POS机管理端管理老师审核之后aplfg会变化、过期不审核aplfg也会变化
3 终止条件：审核通过
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| id|Integer|必须| 订单变更ID|1|
| orduid|String|必须| 订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| neworduid|String|必须| 新订单号&lt;br /&gt;当有支付时，生成新订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| orgfg|Integer|必须| 原订单标志 1原始订单记录 2修改后的订单记录| 1|
| chgwrkfg|Integer|| 是否更换护工 0 不换人 1 换人| 1|
| wuid|String|必须| 护工UID| WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| svctp|String|必须| 交易号| TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| startday|date|必须| 服务开始时间 默认当前日期| 2018-04-05|
| svcday|Integer|必须| 服务天数| 10|
| unitprice|Integer|必须|  服务项目单价| 9000|
| amount|Integer|必须| 服务项目小计 服务项目单价 X 服务天数（精算）| 90000|
| statncd|String|必须|服务网点 订单服务网点（非网点，没有代码） |31010700052 |
| statnnm|String|必须| 服务医院 医院名称| 上海市同济大学附属同济医院(同济医院)|
| sitmid|Integer|必须| 服务价格ID| 835|
| needpayfg|Integer|必须| 是否需要支付| 1|
| ordlessfee|Integer|必须| 订单剩余价格| 90000|
| continufee|Integer|必须| 结转金额| 10000|
| payfee|Integer|必须| 支付金额| 80000|
| aplfg|Integer|必须| 申请状态 0 申请中 1 批准 2 驳回（过期）| 1|&lt;/p&gt;

&lt;h3 id=&quot;订单主表&quot;&gt;订单主表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：用户下单、POS机下单、发生支付的订单变更
2 修改条件：支付、超时未支付、补录患者信息、订单变更、订单结算（用户或者POS发起的结算）、其他影响状态变化的节点
3 终止条件：超时未支付、订单完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| orduid|String|必须| 订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| ordid|String|必须| 订单ID|1804050053004W|
| uopid|String|必须| 患者openid| ooDqLwHXcSIFoMZxTX3DtHkLtaOM|
| tradeno|String|必须| 支付UID| TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| ptorduid|String|必须| 患者姓名| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| rlnm|String|必须| 父订单号，续单用，初始值为其本身如果有续单或者纠纷负单则为其父单orduid| 王根娣|
| startday|date|必须| 服务开始时间 默认当前日期| 2018-04-05|
| svcday|Integer|必须| 服务天数| 10|
| statncd|String|必须| 护工站代码| 31010700052|
| statnnm|String|必须| 护工站| 上海市同济大学附属同济医院(同济医院)|
| amount|Integer|必须| 订单初始预收金额| 90000|
| ordlessfee|Integer|| 订单剩余金额| 0|
| status1|Integer|| 0 无状态  &lt;br /&gt;1 预约中 &lt;br /&gt;2 预约成功 &lt;br /&gt;3 待支付（在2小时内付款，超时被取消） &lt;br /&gt;4 已支付（支付成功）&lt;br /&gt;5 待服务（等待上门服务，计时）&lt;br /&gt;6 服务中（服务进度）&lt;br /&gt;7 待结算（等待结算并提示用户结算，超时关闭订单）&lt;br /&gt;8 已完成 &lt;br /&gt;9 待评价 &lt;br /&gt;10 已评价&lt;br /&gt; 11 已取消（取消成功） &lt;br /&gt;12 申请退款（发起退款申请） &lt;br /&gt;13 退款中（退款已受理，并进行退款程序） &lt;br /&gt;14 退款成功 （退款额转入用户账户） &lt;br /&gt;15 退款失败（提示失败原因） &lt;br /&gt;16 变更待服务 &lt;br /&gt;17 结算中 &lt;br /&gt;18 结算完成 &lt;br /&gt;19结算失败 &lt;br /&gt;| 5|
| status1nm|String|| 同上| 待服务|
| usrconftm|datetime||用户确认完成时间| 2018-04-14 14:54:50|
| splitsttlfg|Integer|| 拆分结算标识0：未拆分结算，1已拆分结算| 0|
| continufee|Integer|| 结转金额| 0|
| chgstatus|Integer||  1 变更未开始 &lt;br /&gt;2 变更已开始&lt;br /&gt;| 0|
| sttlefg|Integer|| 结算标识：给用户退款订单结算掉，成功结算更新 0默认,1已结算| 0|&lt;/p&gt;

&lt;h3 id=&quot;订单详情表&quot;&gt;订单详情表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：用户下单、POS机下单、不发生支付的订单变更
2 修改条件：订单变更、订单结算（用户或POS发起的订单结算）、护工结束服务、其他影响状态变化的节点
3 终止条件：超时未支付、订单完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| orduid|String|必须| 订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| wuid|String|必须| 护工Uid| WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| wstatncd|String|必须| 所属网点 该护工所属网点|31010700052 |
| statncd|String|必须|服务网点 订单服务网点（非网点，没有代码） |31010700052 |
| hospnm|String|必须| 服务医院 医院名称| 上海市同济大学附属同济医院(同济医院)|
| sitmid|Integer|必须| 服务项目 当ordtp属于院内时| |
| svctp|String|必须| 交易号| TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| startday|date|必须| 服务开始时间 默认当前日期| 2018-04-05|
| svcday|Integer|必须| 服务天数| 10|
| unitprice|Integer|必须|  服务项目单价| 9000|
| amount|Integer|必须| 服务项目小计 服务项目单价 X 服务天数（精算）| 90000|
| adjustday|decimal(4,2)|| 调整天数 -0.5 0  0.5 三个值，在最后一天结算| 0|
| status1|Integer|| 0 无状态&lt;br /&gt;1 预约中 &lt;br /&gt;2 预约成功&lt;br /&gt;3 待支付（在15分钟内付款，超时被取消） &lt;br /&gt;4 已支付（支付成功）.&lt;br /&gt;5 待服务（等待上门服务，计时）&lt;br /&gt;6 服务中（服务进度）&lt;br /&gt;7 待结算（等待结算并提示用户结算，超时关闭订单）&lt;br /&gt;8 已完成&lt;br /&gt;9 待评价 &lt;br /&gt;10 已评价&lt;br /&gt;11 已取消（取消成功） &lt;br /&gt;12 申请退款（发起退款申请） &lt;br /&gt;13 退款中（退款已受理，并进行退款程序） &lt;br /&gt;14 退款成功 （退款额转入用户账户） &lt;br /&gt;15 退款失败（提示失败原因）&lt;br /&gt;16 变更待服务&lt;br /&gt;17 结算中 &lt;br /&gt;18 结算完成 &lt;br /&gt;19结算失败 | 5|
| status1nm|String||同上 | 待服务|
| status3|Integer|| 状态-完成 0 无状态 1 完成 | 1|
| status3nm|String|| 状态-完成-说明 保存护工的做工状态 | 完成|
| factsvcfg|Integer|| 子单实际服务标识：0 是默认，1 是结算退款记录， 2 是退款记录{tips:该子单是否是实际服务单} | 0|&lt;/p&gt;

&lt;h3 id=&quot;支付信息表&quot;&gt;支付信息表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：支付、退款、结算等，有金额流转的情况
2 修改条件：支付成功后状态 paid状态更新，结算申请发起、结算状态更新、退款状态发起、退款状态更新。
3 终止条件：超时未支付、支付完成、结算完成、退款完成、
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| tradeno|String|必须| 支付订单号 tr+”-“+36位UUID（带-）&lt;br /&gt;微信线上支付 pt开头&lt;br /&gt;微信扫码支付 td开头&lt;br /&gt;银联支付 tr开头|TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| orduid|String|必须| 订单UID 订单主表ID| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| uopid|String|| 用户UID 支付者UID，不一定是被服务的患者|ooDqLwHXcSIFoMZxTX3DtHkLtaOM|
| fopid|String|| 推荐者UID 推荐者UID||
| ttype|Integer|| 订单类型 1医院 2医院单项 3居家|1|
| paid|Integer|| 是否已支付 &lt;br /&gt;0 未支付 &lt;br /&gt;1 线上支付 &lt;br /&gt;2 现金支付&lt;br /&gt;3 退款成功&lt;br /&gt;4 退款失败|1|
| paidtm|datetime|| 支付时间 非0的时候 才有值|2018-04-05 10:58:56|
| payment|Integer|| 支付方式 &lt;br /&gt;1 微信 &lt;br /&gt;2 刷卡（借记卡） &lt;br /&gt;3 刷卡（信用卡） &lt;br /&gt;4 现金（线下支付）&lt;br /&gt; 5 支付宝|1|
| amount|Integer|| 支付金额|90000|
| outorderno|String|| 外部订单号 外部订单号||
| outtransno|String|| 外部流水号 外部流水号|4200000095201804052560224795|
| resttlfg|Integer|| 预结算标志位：0未结算，1已结算||
| sttlfg|Integer|| 已结算标志 0未结算 1 已结算||
| sttlamt|Integer|| 结算金额||
| invoicetm|datetime|| 预分账标志位||
| reinvfg|Integer|| 分账标志||
| invoicefg|Integer|| ||
| refund|Integer|| 退款标志 现阶段价格统一。&lt;br /&gt;该字段为空，当每个省价格不同时，会用到。&lt;br /&gt;0是付款 1是退款|0|
| cardNo|String|| 银联支付用字段: 支付时所用的卡号(该字段当银联支付退款时使用)||
| transChnName|String|| 支付渠道名称||
| transEngName|String|| 支付渠道||
| refNo|String|| 银联支付用参考号||
| merchantNo|String|| 根据支付时的，商户编号||
| terminalNo|String|| pos机终端号码||
| traceNo|String|| 银联商务支付的记录号(每一个pos机从1开始计数)||&lt;/p&gt;

&lt;h2 id=&quot;订单变更的流程&quot;&gt;订单变更的流程&lt;/h2&gt;
&lt;h3 id=&quot;用户端发起订单变更无需支付&quot;&gt;用户端发起订单变更(无需支付):&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-sequence&quot;&gt;用户端-&amp;gt;[数据库]: 1 患者发起订单变更
用户端-&amp;gt;[数据库]: 2 变更订单（无支付）
POS机-&amp;gt;[数据库]: 确认变更申请
POS机-&amp;gt;[数据库]: 变更审核
[批处理]-&amp;gt;[批处理]: 是否超过6小时没有审核
[批处理]-&amp;gt;[数据库]: 超过6小时没有审核，变更自动作废
[批处理]-&amp;gt;[数据库]: 退款
[批处理]-&amp;gt;[批处理]: 新开始服务时间 &amp;lt; 当前时间
[批处理]-&amp;gt;[数据库]: 旧订单(服务中)、新订单(变更待服务)
[批处理]-&amp;gt;[批处理]: 新开始服务时间 &amp;gt;= 当前时间
[批处理]-&amp;gt;[数据库]: 旧订单(已完成)、新订单(服务中)
[批处理]--&amp;gt;用户端: 通知用户服务已开始
[批处理]--&amp;gt;护工端: 通知旧护工服务已结束
[批处理]--&amp;gt;护工端: 通知新护工服务已开始
[数据库]--&amp;gt;用户端: 查看订单信息
[数据库]-&amp;gt;PC端: 查看订单信息
[数据库]-&amp;gt;护工端: 查看订单信息
护工端--&amp;gt;用户端: 推送服务日志
用户端-&amp;gt;[数据库]: 发起结算
[批处理]--&amp;gt;[批处理]: 发起结算、向银行请求数据、进入结算中状态
[批处理]--&amp;gt;[批处理]: 判断结算申请的结果、
[批处理]--&amp;gt;[数据库]: 结算成功/结算失败 -&amp;gt; 更新状态
[数据库]-&amp;gt;[数据库]: 服务结束时间判断
用户端--&amp;gt;护工端: 订单结算
护工端--&amp;gt;[数据库]: 服务结束
POS机--&amp;gt;用户端: 订单强制结算
POS机--&amp;gt;护工端: 订单强制结算
用户端-&amp;gt;[数据库]:用户评价、状态进入已评价状态
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;用户端发起订单变更需支付&quot;&gt;用户端发起订单变更(需支付):&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-sequence&quot;&gt;用户端-&amp;gt;[数据库]: 1 患者发起订单变更
用户端-&amp;gt;[数据库]: 2 变更订单（需要支付）
用户端--&amp;gt;[数据库]: 3 支付
POS机-&amp;gt;[数据库]: 确认变更申请
POS机--&amp;gt;[数据库]: 支付
POS机-&amp;gt;[数据库]: 变更审核
[批处理]-&amp;gt;[批处理]: 是否超过6小时没有审核
[批处理]-&amp;gt;[数据库]: 超过6小时没有审核，变更自动作废
[批处理]-&amp;gt;[数据库]: 退款
[批处理]-&amp;gt;[批处理]: 新开始服务时间 &amp;lt; 当前时间
[批处理]-&amp;gt;[数据库]: 旧订单(服务中)、新订单(变更待服务)
[批处理]-&amp;gt;[批处理]: 新开始服务时间 &amp;gt;= 当前时间
[批处理]-&amp;gt;[数据库]: 旧订单(已完成)、新订单(服务中)
[批处理]--&amp;gt;用户端: 通知用户服务已开始
[批处理]--&amp;gt;护工端: 通知旧护工服务已结束
[批处理]--&amp;gt;护工端: 通知新护工服务已开始
[数据库]--&amp;gt;用户端: 查看订单信息
[数据库]-&amp;gt;PC端: 查看订单信息
[数据库]-&amp;gt;护工端: 查看订单信息
护工端--&amp;gt;用户端: 推送服务日志
用户端-&amp;gt;[数据库]: 发起结算
[批处理]--&amp;gt;[批处理]: 发起结算、向银行请求数据、进入结算中状态
[批处理]--&amp;gt;[批处理]: 判断结算申请的结果、
[批处理]--&amp;gt;[数据库]: 结算成功/结算失败 -&amp;gt; 更新状态
[数据库]-&amp;gt;[数据库]: 服务结束时间判断
用户端--&amp;gt;护工端: 订单结算
护工端--&amp;gt;[数据库]: 服务结束
POS机--&amp;gt;用户端: 订单强制结算
POS机--&amp;gt;护工端: 订单强制结算
用户端-&amp;gt;[数据库]:用户评价、状态进入已评价状态
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;pos机发起订单变更无需支付&quot;&gt;POS机发起订单变更(无需支付):&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-sequence&quot;&gt;POS机-&amp;gt;[数据库]: POS机发起订单变更
POS机-&amp;gt;[数据库]: 变更订单（无支付）
POS机-&amp;gt;[数据库]: 确认变更申请
POS机-&amp;gt;[数据库]: 变更直接生效
[批处理]-&amp;gt;[批处理]: 新开始服务时间 &amp;lt; 当前时间
[批处理]-&amp;gt;[数据库]: 旧订单(服务中)、新订单(变更待服务)
[批处理]-&amp;gt;[批处理]: 新开始服务时间 &amp;gt;= 当前时间
[批处理]-&amp;gt;[数据库]: 旧订单(已完成)、新订单(服务中)
[批处理]--&amp;gt;用户端: 通知用户服务已开始
[批处理]--&amp;gt;护工端: 通知旧护工服务已结束
[批处理]--&amp;gt;护工端: 通知新护工服务已开始
[数据库]--&amp;gt;用户端: 查看订单信息
[数据库]-&amp;gt;PC端: 查看订单信息
[数据库]-&amp;gt;护工端: 查看订单信息
护工端--&amp;gt;用户端: 推送服务日志
用户端-&amp;gt;[数据库]: 发起结算
[批处理]--&amp;gt;[批处理]: 发起结算、向银行请求数据、进入结算中状态
[批处理]--&amp;gt;[批处理]: 判断结算申请的结果、
[批处理]--&amp;gt;[数据库]: 结算成功/结算失败 -&amp;gt; 更新状态
[数据库]-&amp;gt;[数据库]: 服务结束时间判断
用户端--&amp;gt;护工端: 订单结算
护工端--&amp;gt;[数据库]: 服务结束
POS机--&amp;gt;用户端: 订单强制结算
POS机--&amp;gt;护工端: 订单强制结算
用户端-&amp;gt;[数据库]:用户评价、状态进入已评价状态
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;用户端发起订单变更需支付-1&quot;&gt;用户端发起订单变更(需支付):&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-sequence&quot;&gt;POS机-&amp;gt;[数据库]: 患者发起订单变更
POS机-&amp;gt;[数据库]: 变更订单（需要支付）
POS机--&amp;gt;[数据库]: 支付
POS机-&amp;gt;[数据库]: 确认变更申请
POS机-&amp;gt;[数据库]: 变更审核
[批处理]-&amp;gt;[批处理]: 是否超过6小时没有审核
[批处理]-&amp;gt;[数据库]: 超过6小时没有审核，变更自动作废
[批处理]-&amp;gt;[数据库]: 退款
[批处理]-&amp;gt;[批处理]: 新开始服务时间 &amp;lt; 当前时间
[批处理]-&amp;gt;[数据库]: 旧订单(服务中)、新订单(变更待服务)
[批处理]-&amp;gt;[批处理]: 新开始服务时间 &amp;gt;= 当前时间
[批处理]-&amp;gt;[数据库]: 旧订单(已完成)、新订单(服务中)
[批处理]--&amp;gt;用户端: 通知用户服务已开始
[批处理]--&amp;gt;护工端: 通知旧护工服务已结束
[批处理]--&amp;gt;护工端: 通知新护工服务已开始
[数据库]--&amp;gt;用户端: 查看订单信息
[数据库]-&amp;gt;PC端: 查看订单信息
[数据库]-&amp;gt;护工端: 查看订单信息
护工端--&amp;gt;用户端: 推送服务日志
用户端-&amp;gt;[数据库]: 发起结算
[批处理]--&amp;gt;[批处理]: 发起结算、向银行请求数据、进入结算中状态
[批处理]--&amp;gt;[批处理]: 判断结算申请的结果、
[批处理]--&amp;gt;[数据库]: 结算成功/结算失败 -&amp;gt; 更新状态
[数据库]-&amp;gt;[数据库]: 服务结束时间判断
用户端--&amp;gt;护工端: 订单结算
护工端--&amp;gt;[数据库]: 服务结束
POS机--&amp;gt;用户端: 订单强制结算
POS机--&amp;gt;护工端: 订单强制结算
用户端-&amp;gt;[数据库]:用户评价、状态进入已评价状态
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;后台批处理接口说明&quot;&gt;后台批处理接口说明&lt;/h2&gt;

&lt;h3 id=&quot;01-审核超时的退款处理&quot;&gt;01. 审核超时的退款处理&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/cancelUnaplyToUnPayOrd&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 清理6小时内审核未通过的订单
 2 如果有的话，直接退款&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;02-修改变更服务变成待服务立即执行-没有支付的订单变更&quot;&gt;02. 修改变更服务变成待服务(立即执行) 没有支付的订单变更&lt;/h3&gt;
&lt;p&gt;只有审批通过的变更待服务才能进入服务状态，否者6个小时后回恢复、并且退款&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderChangeSerStart&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 到了变更后的开始时间，
 2 老订单完结，新订单进入开始服务状态&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;03-变更订单的等待状态变成开始服务-有支付状态的订单变更&quot;&gt;03. 变更订单的等待状态变成开始服务 有支付状态的订单变更&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderChangeWaitSerToSer&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 到了变更后的开始时间，
 2 老订单完结，新订单进入开始服务状态&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>kei gosling</name></author><summary type="html">03. 订单与结算逻辑.订单变更</summary></entry><entry><title type="html">订单与结算逻辑 订单</title><link href="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E8%AE%A2%E5%8D%95/" rel="alternate" type="text/html" title="订单与结算逻辑 订单" /><published>2020-10-03T00:00:00+08:00</published><updated>2020-10-03T00:00:00+08:00</updated><id>https://thefirstwind.github.io//%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E8%AE%A2%E5%8D%95</id><content type="html" xml:base="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E8%AE%A2%E5%8D%95/">&lt;h1 id=&quot;01-订单与结算逻辑订单&quot;&gt;01. 订单与结算逻辑.订单&lt;/h1&gt;

&lt;blockquote&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;时间&lt;/strong&gt;：2018年8月9日
@[订单, 支付方式, 结算逻辑]&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;p&gt;[TOC]&lt;/p&gt;

&lt;h2 id=&quot;数据字典&quot;&gt;数据字典&lt;/h2&gt;

&lt;h3 id=&quot;系统角色&quot;&gt;系统角色&lt;/h3&gt;
&lt;p&gt;| 端  |    用户群体 |    终端类型 | 终端名称  |
| :——– |:——–| :–: |:——–|
| 用户端  |患者、消费者 | 微信公众号 | E护通  |
| 护工端  |院内护工、居家护工 |  微信公众号  | E护通|护工  |
| 护士端  |提供上门服务的在册护士 | 微信公众号/APP  | 护通|专护 |
| POS机端 |擎浩医院管理老师| POS机  |  |
| PC端 |财务、运营、系统管理员等| PC电脑端 |   |
| 统计端|院方高层、护理界高层| 微信公众号  | 擎浩护理  |&lt;/p&gt;

&lt;h3 id=&quot;院内订单类型&quot;&gt;院内订单类型&lt;/h3&gt;
&lt;p&gt;| 订单类型  | 前提条件 |  工资计算说明| 
| :——– |:——–| :–: |
| 1对1订单 | 院内有机动护工 | 系统计算、每日按照比例分配 |
| 1对多订单 | 当前病区绑定了护工 |  系统计算、每日按照比例分配   | 
| 团队制订单| 当前病区支持团队制 | 不统计报表  | 
| 单项订单 |擎浩医院管理老师| 待定 |&lt;/p&gt;

&lt;h2 id=&quot;下单相关流程&quot;&gt;下单相关流程&lt;/h2&gt;
&lt;h3 id=&quot;用户下单时序图&quot;&gt;用户下单(时序图):&lt;/h3&gt;

&lt;div class=&quot;plantuml&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; contentScriptType=&quot;application/ecmascript&quot; contentStyleType=&quot;text/css&quot; height=&quot;641px&quot; preserveAspectRatio=&quot;none&quot; style=&quot;width:598px;height:641px;&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 598 641&quot; width=&quot;598px&quot; zoomAndPan=&quot;magnify&quot;&gt;&lt;defs&gt;&lt;filter height=&quot;300%&quot; id=&quot;f1chjn0nnjwm9c&quot; width=&quot;300%&quot; x=&quot;-1&quot; y=&quot;-1&quot;&gt;&lt;feGaussianBlur result=&quot;blurOut&quot; stdDeviation=&quot;2.0&quot;/&gt;&lt;feColorMatrix in=&quot;blurOut&quot; result=&quot;blurOut2&quot; type=&quot;matrix&quot; values=&quot;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0&quot;/&gt;&lt;feOffset dx=&quot;4.0&quot; dy=&quot;4.0&quot; in=&quot;blurOut2&quot; result=&quot;blurOut3&quot;/&gt;&lt;feBlend in=&quot;SourceGraphic&quot; in2=&quot;blurOut3&quot; mode=&quot;normal&quot;/&gt;&lt;/filter&gt;&lt;/defs&gt;&lt;g&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;35&quot; x2=&quot;35&quot; y1=&quot;40.4883&quot; y2=&quot;597.7676&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;139.5&quot; x2=&quot;139.5&quot; y1=&quot;40.4883&quot; y2=&quot;597.7676&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;375&quot; x2=&quot;375&quot; y1=&quot;40.4883&quot; y2=&quot;597.7676&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;493&quot; x2=&quot;493&quot; y1=&quot;40.4883&quot; y2=&quot;597.7676&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;558&quot; x2=&quot;558&quot; y1=&quot;40.4883&quot; y2=&quot;597.7676&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;56&quot; x=&quot;5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;12&quot; y=&quot;25.5352&quot;&gt;用户端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;56&quot; x=&quot;5&quot; y=&quot;596.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;12&quot; y=&quot;617.3027&quot;&gt;用户端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;55&quot; x=&quot;110.5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;41&quot; x=&quot;117.5&quot; y=&quot;25.5352&quot;&gt;POS机&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;55&quot; x=&quot;110.5&quot; y=&quot;596.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;41&quot; x=&quot;117.5&quot; y=&quot;617.3027&quot;&gt;POS机&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;42&quot; x=&quot;352&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;359&quot; y=&quot;25.5352&quot;&gt;系统&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;42&quot; x=&quot;352&quot; y=&quot;596.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;359&quot; y=&quot;617.3027&quot;&gt;系统&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;46&quot; x=&quot;468&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;32&quot; x=&quot;475&quot; y=&quot;25.5352&quot;&gt;PC端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;46&quot; x=&quot;468&quot; y=&quot;596.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;32&quot; x=&quot;475&quot; y=&quot;617.3027&quot;&gt;PC端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;56&quot; x=&quot;528&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;535&quot; y=&quot;25.5352&quot;&gt;护工端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1chjn0nnjwm9c)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;56&quot; x=&quot;528&quot; y=&quot;596.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;535&quot; y=&quot;617.3027&quot;&gt;护工端&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;128,67.7988,138,71.7988,128,75.7988,132,71.7988&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;35&quot; x2=&quot;134&quot; y1=&quot;71.7988&quot; y2=&quot;71.7988&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;26&quot; x=&quot;42&quot; y=&quot;67.0566&quot;&gt;下单&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;128,97.1094,138,101.1094,128,105.1094,132,101.1094&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;35&quot; x2=&quot;134&quot; y1=&quot;101.1094&quot; y2=&quot;101.1094&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;81&quot; x=&quot;42&quot; y=&quot;96.3672&quot;&gt;[￥支付 微信 ]&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;363,126.4199,373,130.4199,363,134.4199,367,130.4199&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;35&quot; x2=&quot;369&quot; y1=&quot;130.4199&quot; y2=&quot;130.4199&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;42&quot; y=&quot;125.6777&quot;&gt;更新数据&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;151,155.7305,141,159.7305,151,163.7305,147,159.7305&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;145&quot; x2=&quot;374&quot; y1=&quot;159.7305&quot; y2=&quot;159.7305&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;157&quot; y=&quot;154.9883&quot;&gt;推送消息&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;363,185.041,373,189.041,363,193.041,367,189.041&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;140&quot; x2=&quot;369&quot; y1=&quot;189.041&quot; y2=&quot;189.041&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;117&quot; x=&quot;147&quot; y=&quot;184.2988&quot;&gt;评估、补录患者信息&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;363,214.3516,373,218.3516,363,222.3516,367,218.3516&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;140&quot; x2=&quot;369&quot; y1=&quot;218.3516&quot; y2=&quot;218.3516&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;211&quot; x=&quot;147&quot; y=&quot;213.6094&quot;&gt;[￥收款：微信/支付宝/银行卡/现金]&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;46,243.6621,36,247.6621,46,251.6621,42,247.6621&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;40&quot; x2=&quot;374&quot; y1=&quot;247.6621&quot; y2=&quot;247.6621&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;52&quot; y=&quot;242.9199&quot;&gt;查看订单信息&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;481,272.9727,491,276.9727,481,280.9727,485,276.9727&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;375&quot; x2=&quot;487&quot; y1=&quot;276.9727&quot; y2=&quot;276.9727&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;382&quot; y=&quot;272.2305&quot;&gt;查看订单信息&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;546,302.2832,556,306.2832,546,310.2832,550,306.2832&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;375&quot; x2=&quot;552&quot; y1=&quot;306.2832&quot; y2=&quot;306.2832&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;382&quot; y=&quot;301.541&quot;&gt;查看订单信息&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;375&quot; x2=&quot;417&quot; y1=&quot;335.5938&quot; y2=&quot;335.5938&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;417&quot; x2=&quot;417&quot; y1=&quot;335.5938&quot; y2=&quot;348.5938&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;376&quot; x2=&quot;417&quot; y1=&quot;348.5938&quot; y2=&quot;348.5938&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;386,344.5938,376,348.5938,386,352.5938,382,348.5938&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;104&quot; x=&quot;382&quot; y=&quot;330.8516&quot;&gt;服务开始时间判断&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;375&quot; x2=&quot;417&quot; y1=&quot;377.9043&quot; y2=&quot;377.9043&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;417&quot; x2=&quot;417&quot; y1=&quot;377.9043&quot; y2=&quot;390.9043&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;376&quot; x2=&quot;417&quot; y1=&quot;390.9043&quot; y2=&quot;390.9043&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;386,386.9043,376,390.9043,386,394.9043,382,390.9043&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;39&quot; x=&quot;382&quot; y=&quot;373.1621&quot;&gt;服务中&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;46,416.2148,36,420.2148,46,424.2148,42,420.2148&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;40&quot; x2=&quot;557&quot; y1=&quot;420.2148&quot; y2=&quot;420.2148&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;52&quot; y=&quot;415.4727&quot;&gt;推送服务日志&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;375&quot; x2=&quot;417&quot; y1=&quot;449.5254&quot; y2=&quot;449.5254&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;417&quot; x2=&quot;417&quot; y1=&quot;449.5254&quot; y2=&quot;462.5254&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;376&quot; x2=&quot;417&quot; y1=&quot;462.5254&quot; y2=&quot;462.5254&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;386,458.5254,376,462.5254,386,466.5254,382,462.5254&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;104&quot; x=&quot;382&quot; y=&quot;444.7832&quot;&gt;服务结束时间判断&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;546,487.8359,556,491.8359,546,495.8359,550,491.8359&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;35&quot; x2=&quot;552&quot; y1=&quot;491.8359&quot; y2=&quot;491.8359&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;42&quot; y=&quot;487.0938&quot;&gt;订单结算&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;386,517.1465,376,521.1465,386,525.1465,382,521.1465&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;380&quot; x2=&quot;557&quot; y1=&quot;521.1465&quot; y2=&quot;521.1465&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;392&quot; y=&quot;516.4043&quot;&gt;服务结算&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;46,546.457,36,550.457,46,554.457,42,550.457&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;40&quot; x2=&quot;139&quot; y1=&quot;550.457&quot; y2=&quot;550.457&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;52&quot; y=&quot;545.7148&quot;&gt;订单强制结算&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;546,575.7676,556,579.7676,546,583.7676,550,579.7676&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;140&quot; x2=&quot;552&quot; y1=&quot;579.7676&quot; y2=&quot;579.7676&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;147&quot; y=&quot;575.0254&quot;&gt;订单强制结算&lt;/text&gt;&lt;!--MD5=[65f6bd65aa493c41f24ebf0887da110f]
@startuml
用户端 -&gt; POS机: 下单
用户端 -&gt; POS机: [￥支付 微信 ]
用户端 - -&gt; 系统: 更新数据
系统 - -&gt; POS机: 推送消息
POS机 -&gt; 系统: 评估、补录患者信息
POS机 -&gt; 系统: [￥收款：微信/支付宝/银行卡/现金]
系统 - -&gt; 用户端: 查看订单信息
系统 -&gt; PC端: 查看订单信息
系统 -&gt; 护工端: 查看订单信息
系统 -&gt; 系统: 服务开始时间判断
系统 -&gt; 系统: 服务中
护工端 - -&gt; 用户端: 推送服务日志
系统 -&gt; 系统: 服务结束时间判断
用户端 - -&gt; 护工端: 订单结算
护工端 - -&gt; 系统: 服务结算
POS机 - -&gt; 用户端: 订单强制结算
POS机 - -&gt; 护工端: 订单强制结算
@enduml

PlantUML version 1.2020.18(Thu Oct 01 03:40:44 CST 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: CN
--&gt;&lt;/g&gt;&lt;/svg&gt;&lt;/div&gt;
&lt;p&gt;###用户下单(流程图):&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-flow&quot;&gt;st=&amp;gt;start: 开始
e=&amp;gt;end: 结束
e2=&amp;gt;end: 结束
op1=&amp;gt;operation: 填写患者信息
sub1=&amp;gt;subroutine: 选择1对1护工
sub2=&amp;gt;subroutine: 选择1对多护工
cond1=&amp;gt;condition: 选择下单方式（1对1）
cond2=&amp;gt;condition: 选择下单方式（1对多）
sub3=&amp;gt;subroutine: 微信、支付宝、银行卡、现金
cond3=&amp;gt;condition: 在线微信支付
op4=&amp;gt;operation: POS机收款
op5=&amp;gt;operation: POS机收款成功
op6=&amp;gt;operation: 支付成功


st-&amp;gt;op1-&amp;gt;cond1
cond1(no)-&amp;gt;cond2
cond1(yes)-&amp;gt;sub1-&amp;gt;cond3
cond2(yes)-&amp;gt;sub2-&amp;gt;cond3
cond2(no)-&amp;gt;e2
cond3(no,left)-&amp;gt;op4-&amp;gt;sub3-&amp;gt;op5-&amp;gt;e
cond3(yes)-&amp;gt;op6-&amp;gt;e2

&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;pos机代下单时序图&quot;&gt;POS机代下单(时序图):&lt;/h3&gt;
&lt;div class=&quot;plantuml&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; contentScriptType=&quot;application/ecmascript&quot; contentStyleType=&quot;text/css&quot; height=&quot;465px&quot; preserveAspectRatio=&quot;none&quot; style=&quot;width:564px;height:465px;&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 564 465&quot; width=&quot;564px&quot; zoomAndPan=&quot;magnify&quot;&gt;&lt;defs&gt;&lt;filter height=&quot;300%&quot; id=&quot;f1au66snwm2ajo&quot; width=&quot;300%&quot; x=&quot;-1&quot; y=&quot;-1&quot;&gt;&lt;feGaussianBlur result=&quot;blurOut&quot; stdDeviation=&quot;2.0&quot;/&gt;&lt;feColorMatrix in=&quot;blurOut&quot; result=&quot;blurOut2&quot; type=&quot;matrix&quot; values=&quot;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0&quot;/&gt;&lt;feOffset dx=&quot;4.0&quot; dy=&quot;4.0&quot; in=&quot;blurOut2&quot; result=&quot;blurOut3&quot;/&gt;&lt;feBlend in=&quot;SourceGraphic&quot; in2=&quot;blurOut3&quot; mode=&quot;normal&quot;/&gt;&lt;/filter&gt;&lt;/defs&gt;&lt;g&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;34&quot; x2=&quot;34&quot; y1=&quot;40.4883&quot; y2=&quot;421.9043&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;269.5&quot; x2=&quot;269.5&quot; y1=&quot;40.4883&quot; y2=&quot;421.9043&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;387.5&quot; x2=&quot;387.5&quot; y1=&quot;40.4883&quot; y2=&quot;421.9043&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;459.5&quot; x2=&quot;459.5&quot; y1=&quot;40.4883&quot; y2=&quot;421.9043&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;&quot; x1=&quot;524.5&quot; x2=&quot;524.5&quot; y1=&quot;40.4883&quot; y2=&quot;421.9043&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1au66snwm2ajo)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;55&quot; x=&quot;5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;41&quot; x=&quot;12&quot; y=&quot;25.5352&quot;&gt;POS机&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1au66snwm2ajo)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;55&quot; x=&quot;5&quot; y=&quot;420.9043&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;41&quot; x=&quot;12&quot; y=&quot;441.4395&quot;&gt;POS机&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1au66snwm2ajo)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;42&quot; x=&quot;246.5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;253.5&quot; y=&quot;25.5352&quot;&gt;系统&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1au66snwm2ajo)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;42&quot; x=&quot;246.5&quot; y=&quot;420.9043&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;28&quot; x=&quot;253.5&quot; y=&quot;441.4395&quot;&gt;系统&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1au66snwm2ajo)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;70&quot; x=&quot;350.5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;357.5&quot; y=&quot;25.5352&quot;&gt;用户手机&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1au66snwm2ajo)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;70&quot; x=&quot;350.5&quot; y=&quot;420.9043&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;56&quot; x=&quot;357.5&quot; y=&quot;441.4395&quot;&gt;用户手机&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1au66snwm2ajo)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;46&quot; x=&quot;434.5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;32&quot; x=&quot;441.5&quot; y=&quot;25.5352&quot;&gt;PC端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1au66snwm2ajo)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;46&quot; x=&quot;434.5&quot; y=&quot;420.9043&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;32&quot; x=&quot;441.5&quot; y=&quot;441.4395&quot;&gt;PC端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1au66snwm2ajo)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;56&quot; x=&quot;494.5&quot; y=&quot;5&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;501.5&quot; y=&quot;25.5352&quot;&gt;护工端&lt;/text&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f1au66snwm2ajo)&quot; height=&quot;30.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;56&quot; x=&quot;494.5&quot; y=&quot;420.9043&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;501.5&quot; y=&quot;441.4395&quot;&gt;护工端&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;257.5,67.7988,267.5,71.7988,257.5,75.7988,261.5,71.7988&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;34.5&quot; x2=&quot;263.5&quot; y1=&quot;71.7988&quot; y2=&quot;71.7988&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;117&quot; x=&quot;41.5&quot; y=&quot;67.0566&quot;&gt;填写用户信息、下单&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;257.5,97.1094,267.5,101.1094,257.5,105.1094,261.5,101.1094&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;34.5&quot; x2=&quot;263.5&quot; y1=&quot;101.1094&quot; y2=&quot;101.1094&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;211&quot; x=&quot;41.5&quot; y=&quot;96.3672&quot;&gt;[￥收款：微信/支付宝/银行卡/现金]&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;375.5,126.4199,385.5,130.4199,375.5,134.4199,379.5,130.4199&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;269.5&quot; x2=&quot;381.5&quot; y1=&quot;130.4199&quot; y2=&quot;130.4199&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;276.5&quot; y=&quot;125.6777&quot;&gt;推送短信&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;280.5,155.7305,270.5,159.7305,280.5,163.7305,276.5,159.7305&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;274.5&quot; x2=&quot;458.5&quot; y1=&quot;159.7305&quot; y2=&quot;159.7305&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;286.5&quot; y=&quot;154.9883&quot;&gt;查看订单信息&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;280.5,185.041,270.5,189.041,280.5,193.041,276.5,189.041&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;274.5&quot; x2=&quot;523.5&quot; y1=&quot;189.041&quot; y2=&quot;189.041&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;286.5&quot; y=&quot;184.2988&quot;&gt;查看订单信息&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;269.5&quot; x2=&quot;311.5&quot; y1=&quot;218.3516&quot; y2=&quot;218.3516&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;311.5&quot; x2=&quot;311.5&quot; y1=&quot;218.3516&quot; y2=&quot;231.3516&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;270.5&quot; x2=&quot;311.5&quot; y1=&quot;231.3516&quot; y2=&quot;231.3516&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;280.5,227.3516,270.5,231.3516,280.5,235.3516,276.5,231.3516&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;104&quot; x=&quot;276.5&quot; y=&quot;213.6094&quot;&gt;服务开始时间判断&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;269.5&quot; x2=&quot;311.5&quot; y1=&quot;260.6621&quot; y2=&quot;260.6621&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;311.5&quot; x2=&quot;311.5&quot; y1=&quot;260.6621&quot; y2=&quot;273.6621&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;270.5&quot; x2=&quot;311.5&quot; y1=&quot;273.6621&quot; y2=&quot;273.6621&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;280.5,269.6621,270.5,273.6621,280.5,277.6621,276.5,273.6621&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;39&quot; x=&quot;276.5&quot; y=&quot;255.9199&quot;&gt;服务中&lt;/text&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;269.5&quot; x2=&quot;311.5&quot; y1=&quot;302.9727&quot; y2=&quot;302.9727&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;311.5&quot; x2=&quot;311.5&quot; y1=&quot;302.9727&quot; y2=&quot;315.9727&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0;&quot; x1=&quot;270.5&quot; x2=&quot;311.5&quot; y1=&quot;315.9727&quot; y2=&quot;315.9727&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;280.5,311.9727,270.5,315.9727,280.5,319.9727,276.5,315.9727&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;104&quot; x=&quot;276.5&quot; y=&quot;298.2305&quot;&gt;服务结束时间判断&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;280.5,341.2832,270.5,345.2832,280.5,349.2832,276.5,345.2832&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;274.5&quot; x2=&quot;523.5&quot; y1=&quot;345.2832&quot; y2=&quot;345.2832&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;286.5&quot; y=&quot;340.541&quot;&gt;服务结算&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;375.5,370.5938,385.5,374.5938,375.5,378.5938,379.5,374.5938&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;34.5&quot; x2=&quot;381.5&quot; y1=&quot;374.5938&quot; y2=&quot;374.5938&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;143&quot; x=&quot;41.5&quot; y=&quot;369.8516&quot;&gt;订单强制结算、推送短信&lt;/text&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;512.5,399.9043,522.5,403.9043,512.5,407.9043,516.5,403.9043&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;line style=&quot;stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;&quot; x1=&quot;34.5&quot; x2=&quot;518.5&quot; y1=&quot;403.9043&quot; y2=&quot;403.9043&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;41.5&quot; y=&quot;399.1621&quot;&gt;订单强制结算&lt;/text&gt;&lt;!--MD5=[70ce2018eedc09740974ada6c8f31d34]
@startuml
POS机 -&gt; 系统 : 填写用户信息、下单
POS机 -&gt; 系统: [￥收款：微信/支付宝/银行卡/现金]
系统 - -&gt; 用户手机: 推送短信
PC端 -&gt; 系统: 查看订单信息
护工端 -&gt; 系统: 查看订单信息
系统 -&gt; 系统: 服务开始时间判断
系统-&gt; 系统: 服务中
系统-&gt; 系统: 服务结束时间判断
护工端 - -&gt; 系统: 服务结算
POS机 - -&gt; 用户手机: 订单强制结算、推送短信
POS机 - -&gt; 护工端: 订单强制结算
@enduml

PlantUML version 1.2020.18(Thu Oct 01 03:40:44 CST 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: CN
--&gt;&lt;/g&gt;&lt;/svg&gt;&lt;/div&gt;
&lt;h3 id=&quot;pos机代下单流程图&quot;&gt;POS机代下单(流程图):&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;language-flow&quot;&gt;st=&amp;gt;start: 开始
e=&amp;gt;end: 结束
e2=&amp;gt;end: 结束
op1=&amp;gt;operation: 填写患者信息
sub1=&amp;gt;subroutine: 选择1对1护工
sub2=&amp;gt;subroutine: 选择1对多护工
cond1=&amp;gt;condition: 选择下单方式（1对1）
cond2=&amp;gt;condition: 选择下单方式（1对多）
sub3=&amp;gt;subroutine: 微信、支付宝、银行卡、现金
cond3=&amp;gt;condition: 在线微信支付
op4=&amp;gt;operation: POS机收款
op5=&amp;gt;operation: POS机收款成功
op6=&amp;gt;operation: 支付成功


st-&amp;gt;op1-&amp;gt;cond1
cond1(no)-&amp;gt;cond2
cond1(yes)-&amp;gt;sub1-&amp;gt;cond3
cond2(yes)-&amp;gt;sub2-&amp;gt;cond3
cond2(no)-&amp;gt;e2
cond3(no,left)-&amp;gt;op4-&amp;gt;sub3-&amp;gt;op5-&amp;gt;e
cond3(yes)-&amp;gt;op6-&amp;gt;e2

&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;下单接口文档&quot;&gt;下单接口文档&lt;/h2&gt;

&lt;h3 id=&quot;1-用户端下单接口说明&quot;&gt;1. 用户端下单接口说明&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;请求URL&lt;/strong&gt;
    &lt;blockquote&gt;
      &lt;p&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8881/api/order/create&lt;/a&gt;&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;请求方式&lt;/strong&gt;
    &lt;blockquote&gt;
      &lt;p&gt;&lt;strong&gt;POST&lt;/strong&gt;&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;请求参数&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;请求参数&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;必须&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;uopid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;用户Uopid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;odkVKsyBVCiPkzsiJtmCaaAPs6Xc&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ordtp&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单类型&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svctp&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务类型：1 一对一 / 2 一对多 / 3 团队制&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svcday&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务天数&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;uphone&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者手机号码&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;18616579337&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;startday&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Date&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务开始时间&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;2018-08-13&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;pstnid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;病区ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;581&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bed&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;床位号&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;33&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sitmid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;价格ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;297&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svctp2&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务类型2&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;nightcare&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Boolean&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;夜陪标志&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;true&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;age&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;年龄&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;76&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;disease&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;疾病标签&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;rlnm&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者真实姓名&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者姓名&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sex&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;性别：0 女 1男&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;WK_cSjgwj5nIhdzJ_kfd83oNnH6I8yBZ&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;返回参数&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;返回参数&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;success&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;boolean&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;请求成功与否&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;code&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;执行结果code&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;message&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;执行结果&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;执行成功&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orduid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单号码&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ORD_48dj2B3vU1NkPOQjYpveN6YPOo05&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;返回示例&lt;/strong&gt;
    &lt;blockquote&gt;

      &lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;success&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;操作正确&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;orduid&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ORD_48dj2B3vU1NkPOQjYpveN6YPOo05&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;      &lt;/div&gt;
      &lt;h3 id=&quot;2-pos机代下单接口文档&quot;&gt;2. POS机代下单接口文档&lt;/h3&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;请求URL&lt;/strong&gt;
    &lt;blockquote&gt;
      &lt;p&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8883/api/posorder/replace&lt;/a&gt;&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;请求方式&lt;/strong&gt;
    &lt;blockquote&gt;
      &lt;p&gt;&lt;strong&gt;POST&lt;/strong&gt;&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;请求参数&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;请求参数&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;必须&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;所在护工站CD&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010900053&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svctp&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务类型：1 一对一 / 2 一对多 / 3 团队制&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svcday&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务天数&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;8&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;uphone&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者手机&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;18616579337&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;startday&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Date&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务开始时间&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;2018-08-13&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;pstnid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;病区ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;581&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;bed&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;床位号&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;age&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;年龄&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;76&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;disease&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;疾病标签&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;rlnm&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者真实姓名&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;患者姓名&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sex&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;性别：0 女 1男&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;WK_cSjgwj5nIhdzJ_kfd83oNnH6I8yBZ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;uoipd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;用户uopid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;null&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sitmid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;价格ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;297&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;grpamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;团队制订单价格&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;null&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;返回参数&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;返回参数&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;success&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;boolean&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;请求成功与否&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;code&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;执行结果code&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;message&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;执行结果消息&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orduid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;执行结果消息&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ORD_X7IS7TYobMXybv9hfEqPFoavsrQw&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;返回示例&lt;/strong&gt;
    &lt;blockquote&gt;

      &lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;success&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;操作正确&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;orduid&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ORD_X7IS7TYobMXybv9hfEqPFoavsrQw&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;      &lt;/div&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>kei gosling</name></author><summary type="html">01. 订单与结算逻辑.订单</summary></entry><entry><title type="html">订单与结算逻辑 结算与支付</title><link href="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E7%BB%93%E7%AE%97%E4%B8%8E%E6%94%AF%E4%BB%98/" rel="alternate" type="text/html" title="订单与结算逻辑 结算与支付" /><published>2020-10-03T00:00:00+08:00</published><updated>2020-10-03T00:00:00+08:00</updated><id>https://thefirstwind.github.io//%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E7%BB%93%E7%AE%97%E4%B8%8E%E6%94%AF%E4%BB%98</id><content type="html" xml:base="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E4%B8%8E%E7%BB%93%E7%AE%97%E9%80%BB%E8%BE%91-%E7%BB%93%E7%AE%97%E4%B8%8E%E6%94%AF%E4%BB%98/">&lt;h1 id=&quot;01-订单与结算逻辑结算与支付&quot;&gt;01. 订单与结算逻辑.结算与支付&lt;/h1&gt;

&lt;blockquote&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;时间&lt;/strong&gt;：2018年8月23日&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;@[订单, 结算逻辑]&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;[TOC]&lt;/p&gt;

&lt;h2 id=&quot;数据字典&quot;&gt;数据字典&lt;/h2&gt;

&lt;h3 id=&quot;系统角色&quot;&gt;系统角色&lt;/h3&gt;
&lt;p&gt;| 端  |    用户群体 |    终端类型 | 终端名称  |
| :——– |:——–| :–: |:——–|
| 用户端  |患者、消费者 | 微信公众号 | E护通  |
| 护工端  |院内护工、居家护工 |  微信公众号  | E护通|护工  |
| 护士端  |提供上门服务的在册护士 | 微信公众号/APP  | 护通|专护 |
| POS机端 |擎浩医院管理老师| POS机  |  |
| PC端 |财务、运营、系统管理员等| PC电脑端 |   |
| 统计端|院方高层、护理界高层| 微信公众号  | 擎浩护理  |&lt;/p&gt;

&lt;h3 id=&quot;院内订单类型&quot;&gt;院内订单类型&lt;/h3&gt;
&lt;p&gt;| 订单类型  | 前提条件 |  工资计算说明|
| :——– |:——–| :–: |
| 1对1订单 | 院内有机动护工 | 系统计算、每日按照比例分配 |
| 1对多订单 | 当前病区绑定了护工 |  系统计算、每日按照比例分配   |
| 团队制订单| 当前病区支持团队制 | 不统计报表  |
| 单项订单 |擎浩医院管理老师| 待定 |&lt;/p&gt;

&lt;h3 id=&quot;订单状态&quot;&gt;订单状态&lt;/h3&gt;
&lt;p&gt;| 状态  | 状态名称 |  说明|
| :——– |:——–| :– |
| 0  | 无状态 | 空状态，冗余字段 |
| 1  | 预约中 | 院外抢单用状态 |
| 2  | 预约成功 | POS机管理老师代接单，并且派工之后的状态 |
| 3  | 待支付（在2小时内付款，超时被取消） | 院内订单下单之后的状态 |
| 4  | 已支付（支付成功） | 支付成功的状态 |
| 5  | 待服务（等待上门服务，计时） | 支付成功之后，2个小时之内保持待服务状态 |
| 6  | 服务中（服务进度） | 支付成功之后，2个小时之后进入服务中状态 |
| 7  | 待结算 | 用户(POS机)发起结算 （等待结算并提示用户结算，超时关闭订单）|
| 8  | 已完成 | 用户(POS机)发起结算之后，如果判断退款成功，状态变为完成 |
| 9  | 待评价 | 冗余状态 |
| 10  | 已评价 | 用户评价完成之后 |
| 11  | 已取消（取消成功） | 超时支付，自动变为取消|
| 12  | 申请退款（发起退款申请） | 待服务状态，申请全额退款的状态 |
| 13  | 退款中（退款已受理，并进行退款程序） | 发起退款的状态 |
| 14  | 退款成功 （退款额转入用户账户） | 用户(POS机)发起退款，如果确认退款成功，状态变为退款成功 |
| 15  | 退款失败（提示失败原因） | 用户(POS机)发起退款，如果确认退款失败，状态变为退款失败 |
| 16  | 变更待服务 | 发起订单变更之后的状态 |
| 17  | 结算中 | 用户(POS机)发起结算，状态变为结算中 |
| 18  | 结算完成 | 用户(POS机)发起结算，如果确认结算成功，状态变为结算完成 |
| 19  | 结算失败 | 用户(POS机)发起结算，如果确认结算失败，状态变为结算失败 |&lt;/p&gt;

&lt;h2 id=&quot;数据库设计&quot;&gt;数据库设计&lt;/h2&gt;

&lt;h3 id=&quot;订单主表&quot;&gt;订单主表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：用户下单、POS机下单、发生支付的订单变更
2 修改条件：支付、超时未支付、补录患者信息、订单变更、订单结算（用户或者POS发起的结算）、其他影响状态变化的节点
3 终止条件：超时未支付、订单完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| orduid|String|必须| 订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| ordid|String|必须| 订单ID|1804050053004W|
| uopid|String|必须| 患者openid| ooDqLwHXcSIFoMZxTX3DtHkLtaOM|
| tradeno|String|必须| 支付UID| TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| ptorduid|String|必须| 患者姓名| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| rlnm|String|必须| 父订单号，续单用，初始值为其本身如果有续单或者纠纷负单则为其父单orduid| 王根娣|
| startday|date|必须| 服务开始时间 默认当前日期| 2018-04-05|
| svcday|Integer|必须| 服务天数| 10|
| statncd|String|必须| 护工站代码| 31010700052|
| statnnm|String|必须| 护工站| 上海市同济大学附属同济医院(同济医院)|
| amount|Integer|必须| 订单初始预收金额| 90000|
| ordlessfee|Integer|| 订单剩余金额| 0|
| status1|Integer|| 0 无状态  &lt;br /&gt;1 预约中 &lt;br /&gt;2 预约成功 &lt;br /&gt;3 待支付（在2小时内付款，超时被取消） &lt;br /&gt;4 已支付（支付成功）&lt;br /&gt;5 待服务（等待上门服务，计时）&lt;br /&gt;6 服务中（服务进度）&lt;br /&gt;7 待结算（等待结算并提示用户结算，超时关闭订单）&lt;br /&gt;8 已完成 &lt;br /&gt;9 待评价 &lt;br /&gt;10 已评价&lt;br /&gt; 11 已取消（取消成功） &lt;br /&gt;12 申请退款（发起退款申请） &lt;br /&gt;13 退款中（退款已受理，并进行退款程序） &lt;br /&gt;14 退款成功 （退款额转入用户账户） &lt;br /&gt;15 退款失败（提示失败原因） &lt;br /&gt;16 变更待服务 &lt;br /&gt;17 结算中 &lt;br /&gt;18 结算完成 &lt;br /&gt;19结算失败 &lt;br /&gt;| 5|
| status1nm|String|| 同上| 待服务|
| usrconftm|datetime||用户确认完成时间| 2018-04-14 14:54:50|
| splitsttlfg|Integer|| 拆分结算标识0：未拆分结算，1已拆分结算| 0|
| continufee|Integer|| 结转金额| 0|
| chgstatus|Integer||  1 变更未开始 &lt;br /&gt;2 变更已开始&lt;br /&gt;| 0|
| sttlefg|Integer|| 结算标识：给用户退款订单结算掉，成功结算更新 0默认,1已结算| 0|&lt;/p&gt;

&lt;h3 id=&quot;订单详情表&quot;&gt;订单详情表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：用户下单、POS机下单、不发生支付的订单变更
2 修改条件：订单变更、订单结算（用户或POS发起的订单结算）、护工结束服务、其他影响状态变化的节点
3 终止条件：超时未支付、订单完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| orduid|String|必须| 订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| wuid|String|必须| 护工Uid| WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| wstatncd|String|必须| 所属网点 该护工所属网点|31010700052 |
| statncd|String|必须|服务网点 订单服务网点（非网点，没有代码） |31010700052 |
| hospnm|String|必须| 服务医院 医院名称| 上海市同济大学附属同济医院(同济医院)|
| sitmid|Integer|必须| 服务项目 当ordtp属于院内时| |
| svctp|String|必须| 交易号| TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| startday|date|必须| 服务开始时间 默认当前日期| 2018-04-05|
| svcday|Integer|必须| 服务天数| 10|
| unitprice|Integer|必须|  服务项目单价| 9000|
| amount|Integer|必须| 服务项目小计 服务项目单价 X 服务天数（精算）| 90000|
| adjustday|decimal(4,2)|| 调整天数 -0.5 0  0.5 三个值，在最后一天结算| 0|
| status1|Integer|| 0 无状态&lt;br /&gt;1 预约中 &lt;br /&gt;2 预约成功&lt;br /&gt;3 待支付（在15分钟内付款，超时被取消） &lt;br /&gt;4 已支付（支付成功）.&lt;br /&gt;5 待服务（等待上门服务，计时）&lt;br /&gt;6 服务中（服务进度）&lt;br /&gt;7 待结算（等待结算并提示用户结算，超时关闭订单）&lt;br /&gt;8 已完成&lt;br /&gt;9 待评价 &lt;br /&gt;10 已评价&lt;br /&gt;11 已取消（取消成功） &lt;br /&gt;12 申请退款（发起退款申请） &lt;br /&gt;13 退款中（退款已受理，并进行退款程序） &lt;br /&gt;14 退款成功 （退款额转入用户账户） &lt;br /&gt;15 退款失败（提示失败原因）&lt;br /&gt;16 变更待服务&lt;br /&gt;17 结算中 &lt;br /&gt;18 结算完成 &lt;br /&gt;19结算失败 | 5|
| status1nm|String||同上 | 待服务|
| status3|Integer|| 状态-完成 0 无状态 1 完成 | 1|
| status3nm|String|| 状态-完成-说明 保存护工的做工状态 | 完成|
| factsvcfg|Integer|| 子单实际服务标识：0 是默认，1 是结算退款记录， 2 是退款记录{tips:该子单是否是实际服务单} | 0|&lt;/p&gt;

&lt;h3 id=&quot;支付信息表&quot;&gt;支付信息表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：支付、退款、结算等，有金额流转的情况
2 修改条件：支付成功后状态 paid状态更新，结算申请发起、结算状态更新、退款状态发起、退款状态更新。
3 终止条件：超时未支付、支付完成、结算完成、退款完成、
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| tradeno|String|必须| 支付订单号 tr+”-“+36位UUID（带-）&lt;br /&gt;微信线上支付 pt开头&lt;br /&gt;微信扫码支付 td开头&lt;br /&gt;银联支付 tr开头|TDU_Kn2yCIWlcOYD7V4KmcWfW76Ngynl|
| orduid|String|必须| 订单UID 订单主表ID| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| uopid|String|| 用户UID 支付者UID，不一定是被服务的患者|ooDqLwHXcSIFoMZxTX3DtHkLtaOM|
| fopid|String|| 推荐者UID 推荐者UID||
| ttype|Integer|| 订单类型 1医院 2医院单项 3居家|1|
| paid|Integer|| 是否已支付 &lt;br /&gt;0 未支付 &lt;br /&gt;1 线上支付 &lt;br /&gt;2 现金支付&lt;br /&gt;3 退款成功&lt;br /&gt;4 退款失败|1|
| paidtm|datetime|| 支付时间 非0的时候 才有值|2018-04-05 10:58:56|
| payment|Integer|| 支付方式 &lt;br /&gt;1 微信 &lt;br /&gt;2 刷卡（借记卡） &lt;br /&gt;3 刷卡（信用卡） &lt;br /&gt;4 现金（线下支付）&lt;br /&gt; 5 支付宝|1|
| amount|Integer|| 支付金额|90000|
| outorderno|String|| 外部订单号 外部订单号||
| outtransno|String|| 外部流水号 外部流水号|4200000095201804052560224795|
| resttlfg|Integer|| 预结算标志位：0未结算，1已结算||
| sttlfg|Integer|| 已结算标志 0未结算 1 已结算||
| sttlamt|Integer|| 结算金额||
| invoicetm|datetime|| 预分账标志位||
| reinvfg|Integer|| 分账标志||
| invoicefg|Integer|| ||
| refund|Integer|| 退款标志 现阶段价格统一。&lt;br /&gt;该字段为空，当每个省价格不同时，会用到。&lt;br /&gt;0是付款 1是退款|0|
| cardNo|String|| 银联支付用字段: 支付时所用的卡号(该字段当银联支付退款时使用)||
| transChnName|String|| 支付渠道名称||
| transEngName|String|| 支付渠道||
| refNo|String|| 银联支付用参考号||
| merchantNo|String|| 根据支付时的，商户编号||
| terminalNo|String|| pos机终端号码||
| traceNo|String|| 银联商务支付的记录号(每一个pos机从1开始计数)||&lt;/p&gt;

&lt;h3 id=&quot;日结表&quot;&gt;日结表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：开始服务的订单，每日12:30/23:30 进行结算
2 修改条件：无
3 终止条件：预付款消耗完为止
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| daysttuid|String|必须| 日结算UID|DST_VwACGXWSvbwTfEm9I_6dPyvWKkw2|
| orduid|String|必须| 订单UID 订单主表ID| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| subid|Integer|必须| 订单Subid, 子单号|1|
| porduid|String|必须| 母单orduid| ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| sttdate|date|必须| 结算日期| 2018-04-05|
| wuid|String|必须| 护工wuid|WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| daysttfee|Integer|| 日结算金额|9000|
| lessordfee|Integer|| 订单剩余金额(结余金额)|81000|
| daystttm|datetime|| 结算时间|2018-04-09 23:30:00|
| unitprice|Integer|| 单价 | 9000 |
| statncd|String|| 做单护工站 | 31010700052 |
| plusfee|String|| 增收 | 450 |
| wrkfee|String|| 护工工资 | 5400 |
| hospfee|String|| 医院管理费 | 900 |
| companyfee|String|| 管理费（公司管理费:statncd=wstatncd的时候该字段和服务项目单价拆分的公司管理费一致，如果statncd&amp;lt;&amp;gt;wstatncd三七开的订单，则此字段记录总利润 即=sttamount - wrkfee - recomfee） | 2033 |
| platamount|String|| 平台费用 | 0 |
| deptfee|String|| 科室费 | 100 |
| insuranfee|String|| 保险费 | 0 |
| recomfee|String|| 推荐有奖金额 | 0 |
| platformfee|String|| 护工点击结束后用户遗留平台金额 | 0 |
| payfee|String|| 支付金额 | 90000 |
| usrnewordfee|String|| 用户续单结转 | 0 |
| refundfee|String|| 退款金额 | 0 |&lt;/p&gt;

&lt;h3 id=&quot;结算表&quot;&gt;结算表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：结算完成
2 修改条件：无
3 终止条件：结算完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;字段名&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;必须&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sttuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;日结算UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ST_o9wTyvpiSuSqmbjsMonkilWvm7qXz&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orduid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单UID 订单主表ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;subid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单Subid, 子单号&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;statncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;需求方所在护工站，如果院外非网点或居家为空&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工所在护工站&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工wuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sttamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;结算金额(合算=医院管理费+护工工资+毛利润)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;90000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unitprice&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;单价 护工身价*系数（目前100%）+保险&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;svcday&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;服务天数&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;10&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;plusfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;增收&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工工资&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;54000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;hospfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;医院管理费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;companyfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;管理费（公司管理费:statncd=wstatncd的时候该字段和服务项目单价拆分的公司管理费一致，如果statncd&amp;lt;&amp;gt;wstatncd三七开的订单，则此字段记录总利润 即=sttamount - wrkfee - recomfee）&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;21383&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;平台费用&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;deptfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;科室费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;insuranfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;保险费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;recomfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;推荐有奖金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platformfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工点击结束后用户遗留平台金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;payfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;支付金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;90000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;usrnewordfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;用户续单结转&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;invoicefg&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;分账标识0未分账，1已分账 针对是否分账到qo_ord_fin_statn_invoice表而标识&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;isdowrkfeefg&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工工资标识&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;护工站分账明细&quot;&gt;护工站分账明细&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：结算完成
2 修改条件：无
3 终止条件：结算完成
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;字段名&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数类型&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;必须&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参数说明&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;参考值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;finuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;利益分账UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FI_5NN3QewfIAJPKvTANe2xwG8nPFmUM&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sttuid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;日结算UID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ST_o9wTyvpiSuSqmbjsMonkilWvm7qXz&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;orduid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;订单UID 订单主表ID&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;requirstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;发单方statncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;requirfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;发单方收益&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkstatncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;String&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;派单方statncd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;31010700052&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkstatnfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;必须&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;派单方收益&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wrkfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;护工工资&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;54000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;hospfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;医院管理费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;recomfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;推荐有奖金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;insurfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;保险费&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;plusfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;增收&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;suplid&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;加盟商cd&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;suplfee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;发单方加盟商收益&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;21383&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platfeee&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;平台遗留金额&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;platamount&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Integer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;平台费用&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;护工工资表&quot;&gt;护工工资表&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 插入条件：护工点击完成服务，+15天之后分账
2 修改条件：无
3 终止条件：护工点击完成服务，+15天之后分账
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| wiuid|String|必须| 收入UIDWI开头32位UUID|WI_DxhX4TG2DPkqMyCLLETeUoa4nbtJ0|
| wuid|String|必须| 护工编号UIDWK开头32位UUID|WK_bRyaLdFbHDI9VjxUhSar1BLFEHOSh|
| witp|Integer|必须| 收入类型收入类型 1 订单 2 推荐分享 3 奖励 4 积分换取 |1|
| income|Integer|必须| 收入单位是分 |54000|
| status|Integer|必须| 状态&lt;br /&gt;0 订单服务中 &lt;br /&gt;1 等待结算  &lt;br /&gt;2 系统审核中 &lt;br /&gt;9已生效&lt;br /&gt; (订单服务中状态为0，&lt;br /&gt;订单服务截止之间到但未被结算状态为1,&lt;br /&gt;订单被投诉 状态为2，&lt;br /&gt;订单结束并结算再加14天 状态为9，) |2|
| cashed|Integer|必须| 是否已提现0 未体现 1 已提现 |1|
| cashtm|DateTime|必须| 提现时间提现的时间 |2018-04-09 23:30:00|&lt;/p&gt;

&lt;h2 id=&quot;订单状态变化与结算数据的流程&quot;&gt;订单状态变化与结算数据的流程&lt;/h2&gt;
&lt;h3 id=&quot;订单状态变化时序图&quot;&gt;订单状态变化(时序图):&lt;/h3&gt;
&lt;div class=&quot;plantuml&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; contentScriptType=&quot;application/ecmascript&quot; contentStyleType=&quot;text/css&quot; height=&quot;394px&quot; preserveAspectRatio=&quot;none&quot; style=&quot;width:2486px;height:394px;&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 2486 394&quot; width=&quot;2486px&quot; zoomAndPan=&quot;magnify&quot;&gt;&lt;defs&gt;&lt;filter height=&quot;300%&quot; id=&quot;f11o32g18m4ht&quot; width=&quot;300%&quot; x=&quot;-1&quot; y=&quot;-1&quot;&gt;&lt;feGaussianBlur result=&quot;blurOut&quot; stdDeviation=&quot;2.0&quot;/&gt;&lt;feColorMatrix in=&quot;blurOut&quot; result=&quot;blurOut2&quot; type=&quot;matrix&quot; values=&quot;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0&quot;/&gt;&lt;feOffset dx=&quot;4.0&quot; dy=&quot;4.0&quot; in=&quot;blurOut2&quot; result=&quot;blurOut3&quot;/&gt;&lt;feBlend in=&quot;SourceGraphic&quot; in2=&quot;blurOut3&quot; mode=&quot;normal&quot;/&gt;&lt;/filter&gt;&lt;/defs&gt;&lt;g&gt;&lt;!--MD5=[a1368fdc07dcb533b725e63e195b713b]
entity 用户端--&gt;&lt;ellipse cx=&quot;456.7&quot; cy=&quot;123&quot; fill=&quot;#FEFECE&quot; filter=&quot;url(#f11o32g18m4ht)&quot; rx=&quot;8&quot; ry=&quot;8&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;435.7&quot; y=&quot;153.5352&quot;&gt;用户端&lt;/text&gt;&lt;!--MD5=[e9051c313fc9f3857705b0c7fe37fb42]
entity 数据库--&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f11o32g18m4ht)&quot; height=&quot;46.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;82&quot; x=&quot;856.7&quot; y=&quot;223&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; height=&quot;10&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;15&quot; x=&quot;918.7&quot; y=&quot;228&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; height=&quot;2&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;4&quot; x=&quot;916.7&quot; y=&quot;230&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; height=&quot;2&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;4&quot; x=&quot;916.7&quot; y=&quot;234&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;871.7&quot; y=&quot;256.5352&quot;&gt;数据库&lt;/text&gt;&lt;!--MD5=[a2b20c6bdf000a838dcd78e315cc1dca]
entity POS机--&gt;&lt;ellipse cx=&quot;915.7&quot; cy=&quot;14&quot; fill=&quot;#FEFECE&quot; filter=&quot;url(#f11o32g18m4ht)&quot; rx=&quot;8&quot; ry=&quot;8&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;41&quot; x=&quot;895.2&quot; y=&quot;44.5352&quot;&gt;POS机&lt;/text&gt;&lt;!--MD5=[2b77a53cbdc88a78867a10bd56f04e15]
entity 批处理--&gt;&lt;rect fill=&quot;#FEFECE&quot; filter=&quot;url(#f11o32g18m4ht)&quot; height=&quot;46.4883&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;82&quot; x=&quot;1289.7&quot; y=&quot;100&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; height=&quot;10&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;15&quot; x=&quot;1351.7&quot; y=&quot;105&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; height=&quot;2&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;4&quot; x=&quot;1349.7&quot; y=&quot;107&quot;/&gt;&lt;rect fill=&quot;#FEFECE&quot; height=&quot;2&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot; width=&quot;4&quot; x=&quot;1349.7&quot; y=&quot;111&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;1304.7&quot; y=&quot;133.5352&quot;&gt;批处理&lt;/text&gt;&lt;!--MD5=[0685e6528d0f5891f020493eb2bf8448]
entity PC端--&gt;&lt;ellipse cx=&quot;1196.7&quot; cy=&quot;246&quot; fill=&quot;#FEFECE&quot; filter=&quot;url(#f11o32g18m4ht)&quot; rx=&quot;8&quot; ry=&quot;8&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;32&quot; x=&quot;1180.7&quot; y=&quot;276.5352&quot;&gt;PC端&lt;/text&gt;&lt;!--MD5=[b9558b3f23e8d2475eefb523ba09a625]
entity 护工端--&gt;&lt;ellipse cx=&quot;803.7&quot; cy=&quot;355&quot; fill=&quot;#FEFECE&quot; filter=&quot;url(#f11o32g18m4ht)&quot; rx=&quot;8&quot; ry=&quot;8&quot; style=&quot;stroke: #A80036; stroke-width: 1.5;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;14&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;42&quot; x=&quot;782.7&quot; y=&quot;385.5352&quot;&gt;护工端&lt;/text&gt;&lt;!--MD5=[1403fcc89f8c666f3164917abfd0b123]
link 用户端 to 数据库--&gt;&lt;path d=&quot;M447.4,124.15 C383.64,125.35 15.03,134.8 69.7,193 C96.62,221.67 680.7,239.28 851.3,243.82 &quot; fill=&quot;none&quot; id=&quot;用户端-to-数据库&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;856.47,243.96,847.5879,239.7046,851.472,243.8172,847.3594,247.7013,856.47,243.96&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;150&quot; x=&quot;70.7&quot; y=&quot;189.5684&quot;&gt;1 用户自主下单(院外订单)&lt;/text&gt;&lt;!--MD5=[1403fcc89f8c666f3164917abfd0b123]
link 用户端 to 数据库--&gt;&lt;path d=&quot;M447.63,124.15 C402.5,125.17 206.45,133.06 261.7,193 C301.49,236.18 711.63,243.5 851.36,244.75 &quot; fill=&quot;none&quot; id=&quot;用户端-to-数据库-1&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;856.62,244.79,847.6546,240.713,851.6202,244.7471,847.586,248.7127,856.62,244.79&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;150&quot; x=&quot;262.7&quot; y=&quot;189.5684&quot;&gt;2 用户自主下单(院内订单)&lt;/text&gt;&lt;!--MD5=[1403fcc89f8c666f3164917abfd0b123]
link 用户端 to 数据库--&gt;&lt;path d=&quot;M453.18,132 C447.54,146.22 438.55,175.98 453.7,193 C479.85,222.39 743.15,237.85 851.5,243 &quot; fill=&quot;none&quot; id=&quot;用户端-to-数据库-2&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;856.54,243.24,847.7453,238.8069,851.5459,242.9967,847.356,246.7974,856.54,243.24&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;81&quot; x=&quot;454.7&quot; y=&quot;189.5684&quot;&gt;[￥支付 微信 ]&lt;/text&gt;&lt;!--MD5=[599b9d0ad13439e6d69084b152366eaf]
link 数据库 to 用户端--&gt;&lt;path d=&quot;M891.15,222.96 C885.27,207.23 875.02,186.99 858.7,176 C825.76,153.83 538.54,130.34 470.91,125.08 &quot; fill=&quot;none&quot; id=&quot;数据库-to-用户端&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;465.74,124.68,474.4047,129.3623,470.7251,125.0657,475.0217,121.3861,465.74,124.68&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;876.7&quot; y=&quot;189.5684&quot;&gt;查看订单信息&lt;/text&gt;&lt;!--MD5=[1403fcc89f8c666f3164917abfd0b123]
link 用户端 to 数据库--&gt;&lt;path d=&quot;M465.97,129.92 C489.88,145.09 553.37,184.72 576.7,193 C670.61,226.35 787.65,238.43 851.26,242.72 &quot; fill=&quot;none&quot; id=&quot;用户端-to-数据库-3&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;856.49,243.06,847.7725,238.4768,851.5008,242.7312,847.2464,246.4595,856.49,243.06&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;577.7&quot; y=&quot;189.5684&quot;&gt;发起结算&lt;/text&gt;&lt;!--MD5=[1403fcc89f8c666f3164917abfd0b123]
link 用户端 to 数据库--&gt;&lt;path d=&quot;M465.75,126.11 C492.2,132.39 571.49,152.01 634.7,176 C651.24,182.28 653.97,187.21 670.7,193 C731.7,214.11 804.92,229.12 851.38,237.42 &quot; fill=&quot;none&quot; id=&quot;用户端-to-数据库-4&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;856.35,238.3,848.2022,232.7671,851.4293,237.4131,846.7832,240.6402,856.35,238.3&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;182&quot; x=&quot;671.7&quot; y=&quot;189.5684&quot;&gt;用户评价、状态进入已评价状态&lt;/text&gt;&lt;!--MD5=[5014689344862f8cb479b85d62644362]
link POS机 to 数据库--&gt;&lt;path d=&quot;M906.35,20.1 C875,37.83 777.75,98.3 816.7,146 C858.87,197.65 921.52,124.35 963.7,176 C976.56,191.76 961.93,208.26 943.2,221.18 &quot; fill=&quot;none&quot; id=&quot;POS机-to-数据库&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;938.89,224.05,948.5973,222.3859,943.0503,221.2765,944.1597,215.7295,938.89,224.05&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;180&quot; x=&quot;817.7&quot; y=&quot;128.0684&quot;&gt;POS机管理老师接单、并且派工&lt;/text&gt;&lt;!--MD5=[5014689344862f8cb479b85d62644362]
link POS机 to 数据库--&gt;&lt;path d=&quot;M924.86,20.35 C943.73,31.99 986.55,61.66 1002.7,100 C1010.63,118.84 1005.04,125.69 1002.7,146 C1000.23,167.31 1004.64,175.89 991.7,193 C979.66,208.91 961.28,220.6 943.95,228.82 &quot; fill=&quot;none&quot; id=&quot;POS机-to-数据库-1&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;939.09,231.05,948.9381,230.93,943.634,228.9638,945.6002,223.6596,939.09,231.05&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;211&quot; x=&quot;1007.7&quot; y=&quot;128.0684&quot;&gt;[￥收款：微信/支付宝/银行卡/现金]&lt;/text&gt;&lt;!--MD5=[230f2467105a1e3ec7b253d5539b98aa]
link 批处理 to 数据库--&gt;&lt;path d=&quot;M1324.14,146.03 C1318.26,161.75 1308,181.99 1291.7,193 C1263.32,212.15 1042.18,232.86 944.18,241.2 &quot; fill=&quot;none&quot; id=&quot;批处理-to-数据库&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;939.04,241.64,948.3495,244.8545,944.0216,241.2118,947.6644,236.8839,939.04,241.64&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;151&quot; x=&quot;1308.7&quot; y=&quot;189.5684&quot;&gt;2小时无人反映，取消订单&lt;/text&gt;&lt;!--MD5=[230f2467105a1e3ec7b253d5539b98aa]
link 批处理 to 数据库--&gt;&lt;path d=&quot;M1372.01,129.8 C1423.34,138.63 1500.48,158.19 1468.7,193 C1464.27,197.85 1079.11,230.04 943.94,241.2 &quot; fill=&quot;none&quot; id=&quot;批处理-to-数据库-1&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;938.85,241.62,948.1503,244.861,943.8328,241.206,947.4879,236.8885,938.85,241.62&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;1476.7&quot; y=&quot;189.5684&quot;&gt;取消订单&lt;/text&gt;&lt;!--MD5=[230f2467105a1e3ec7b253d5539b98aa]
link 批处理 to 数据库--&gt;&lt;path d=&quot;M1371.71,124.73 C1445.17,127.39 1587.13,139.39 1537.7,193 C1537.38,193.34 1091.55,229.35 944.28,241.24 &quot; fill=&quot;none&quot; id=&quot;批处理-to-数据库-2&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;939.17,241.65,948.4703,244.891,944.1528,241.236,947.8079,236.9185,939.17,241.65&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;96&quot; x=&quot;1547.7&quot; y=&quot;189.5684&quot;&gt;待服务-&amp;gt;服务中&lt;/text&gt;&lt;!--MD5=[230f2467105a1e3ec7b253d5539b98aa]
link 批处理 to 数据库--&gt;&lt;path d=&quot;M1289.6,138.3 C1280.79,141.09 1271.49,143.81 1262.7,146 C1188.24,164.52 1165.24,151.03 1092.7,176 C1077.47,181.24 1075.54,186.75 1060.7,193 C1022.37,209.14 977.21,223.18 944.15,232.59 &quot; fill=&quot;none&quot; id=&quot;批处理-to-数据库-3&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;938.96,234.06,948.7077,235.468,943.7724,232.7034,946.5371,227.7681,938.96,234.06&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;189&quot; x=&quot;1093.7&quot; y=&quot;189.5684&quot;&gt;结算成功/结算失败 -&amp;gt; 更新状态&lt;/text&gt;&lt;!--MD5=[45b8d2a33a88fc8f7e21420f08f4d3ae]
link 批处理 to 批处理--&gt;&lt;path d=&quot;M1371.74,120.24 C1390.44,119.96 1406.7,120.88 1406.7,123 C1406.7,124.92 1393.35,125.86 1376.92,125.81 &quot; fill=&quot;none&quot; id=&quot;批处理-to-批处理&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;1371.74,125.76,1380.6937,129.8626,1376.7397,125.8171,1380.7851,121.8631,1371.74,125.76&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;185&quot; x=&quot;1412.7&quot; y=&quot;128.0684&quot;&gt;30分钟内不支付，支付状态超时&lt;/text&gt;&lt;!--MD5=[45b8d2a33a88fc8f7e21420f08f4d3ae]
link 批处理 to 批处理--&gt;&lt;path d=&quot;M1371.91,119.46 C1450.88,115.79 1603.7,116.96 1603.7,123 C1603.7,128.91 1457.38,130.16 1377.1,126.77 &quot; fill=&quot;none&quot; id=&quot;批处理-to-批处理-1&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;1371.91,126.54,1380.7179,130.9468,1376.9048,126.7683,1381.0833,122.9552,1371.91,126.54&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;367&quot; x=&quot;1609.7&quot; y=&quot;128.0684&quot;&gt;支付成功之后，2小时内处于待服务状态，超过2小时进入服务中&lt;/text&gt;&lt;!--MD5=[45b8d2a33a88fc8f7e21420f08f4d3ae]
link 批处理 to 批处理--&gt;&lt;path d=&quot;M1371.7,119.36 C1518.7,111.92 1982.7,113.13 1982.7,123 C1982.7,132.75 1529.51,134.05 1376.99,126.9 &quot; fill=&quot;none&quot; id=&quot;批处理-to-批处理-2&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;1371.7,126.64,1380.4947,131.0731,1376.6941,126.8833,1380.884,123.0826,1371.7,126.64&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;260&quot; x=&quot;1988.7&quot; y=&quot;128.0684&quot;&gt;发起结算、向银行请求数据、进入结算中状态&lt;/text&gt;&lt;!--MD5=[45b8d2a33a88fc8f7e21420f08f4d3ae]
link 批处理 to 批处理--&gt;&lt;path d=&quot;M1371.89,118.91 C1556.79,108.15 2254.7,109.52 2254.7,123 C2254.7,136.37 1569.01,137.82 1376.88,127.37 &quot; fill=&quot;none&quot; id=&quot;批处理-to-批处理-3&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;1371.89,127.09,1380.6471,131.5969,1376.8819,127.3752,1381.1035,123.61,1371.89,127.09&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;130&quot; x=&quot;2260.7&quot; y=&quot;128.0684&quot;&gt;判断结算申请的结果、&lt;/text&gt;&lt;!--MD5=[44f8ed35ad0c7c6de2f9825de75e4715]
link 数据库 to PC端--&gt;&lt;path d=&quot;M938.96,246 C1006.86,246 1138.98,246 1182.45,246 &quot; fill=&quot;none&quot; id=&quot;数据库-to-PC端&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;1187.53,246,1178.53,242,1182.53,246,1178.53,250,1187.53,246&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;1024.2&quot; y=&quot;239.5684&quot;&gt;查看订单信息&lt;/text&gt;&lt;!--MD5=[d41520bde73bec76697714e32d8a7ad2]
link 数据库 to 护工端--&gt;&lt;path d=&quot;M888.34,269.16 C881.54,283.57 871.32,302.18 858.7,316 C846.67,329.16 829.27,340.21 817.28,346.94 &quot; fill=&quot;none&quot; id=&quot;数据库-to-护工端&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;812.82,349.39,822.6354,348.5785,817.2062,346.9897,818.7949,341.5606,812.82,349.39&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;871.7&quot; y=&quot;312.5684&quot;&gt;查看订单信息&lt;/text&gt;&lt;!--MD5=[eac0f8dc815f95f437dfb31fb52a61ef]
link 护工端 to 数据库--&gt;&lt;path d=&quot;M799.66,345.87 C794.64,334.5 787.77,313.63 796.7,299 C808.77,279.2 831.06,266.62 851.63,258.8 &quot; fill=&quot;none&quot; id=&quot;护工端-to-数据库&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;856.54,257.02,846.7142,256.3461,851.8427,258.7333,849.4555,263.8618,856.54,257.02&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;797.7&quot; y=&quot;312.5684&quot;&gt;服务结算&lt;/text&gt;&lt;!--MD5=[86df75e36afc5657a281532ca8c6c33b]
link 护工端 to 用户端--&gt;&lt;path d=&quot;M794.61,353.55 C716.29,349.43 155.87,315.83 56.7,193 C6,130.22 366.09,124.54 442.6,124.05 &quot; fill=&quot;none&quot; id=&quot;护工端-to-用户端&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;447.61,124.02,438.5873,120.0715,442.6101,124.0486,438.633,128.0714,447.61,124.02&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;195.7&quot; y=&quot;251.0684&quot;&gt;推送服务日志&lt;/text&gt;&lt;!--MD5=[388b4e30257247210d19c87610a3e5b8]
link 用户端 to 护工端--&gt;&lt;path d=&quot;M447.41,123.76 C392.02,122.53 105.42,119.02 44.7,176 C14.41,204.41 8.8,237.36 35.7,269 C86.64,328.94 689,350.4 789.52,353.57 &quot; fill=&quot;none&quot; id=&quot;用户端-to-护工端&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;794.67,353.73,785.8001,349.4493,789.6725,353.5729,785.5488,357.4453,794.67,353.73&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;52&quot; x=&quot;36.7&quot; y=&quot;251.0684&quot;&gt;订单结算&lt;/text&gt;&lt;!--MD5=[78bb0e67741a59f0080c50bfe15f2cdf]
link 数据库 to 数据库--&gt;&lt;path d=&quot;M938.74,234.95 C957.44,233.82 973.7,237.5 973.7,246 C973.7,253.7 960.35,257.45 943.92,257.24 &quot; fill=&quot;none&quot; id=&quot;数据库-to-数据库&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;938.74,257.05,947.5849,261.3822,943.7365,257.2361,947.8827,253.3878,938.74,257.05&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;104&quot; x=&quot;979.7&quot; y=&quot;251.0684&quot;&gt;服务结束时间判断&lt;/text&gt;&lt;!--MD5=[9502e0edd3a3a35bd55387b20f2071db]
link POS机 to 用户端--&gt;&lt;path d=&quot;M906.33,16.08 C874.71,19.82 769.16,33.1 683.7,53 C601.87,72.05 506.33,104.55 470.87,116.97 &quot; fill=&quot;none&quot; id=&quot;POS机-to-用户端&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;466.09,118.65,475.9093,119.4126,470.8026,116.9792,473.236,111.8725,466.09,118.65&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;684.7&quot; y=&quot;66.5684&quot;&gt;订单强制结算&lt;/text&gt;&lt;!--MD5=[4f24360a2355e1f9bbe03fdd46658e19]
link POS机 to 护工端--&gt;&lt;path d=&quot;M924.75,15.15 C1048.31,17.19 2395.65,40.77 2451.7,100 C2465.75,114.85 2465.22,130.67 2451.7,146 C2336.6,276.53 973.32,345.83 818.06,353.32 &quot; fill=&quot;none&quot; id=&quot;POS机-to-护工端&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;polygon fill=&quot;#A80036&quot; points=&quot;813.06,353.56,822.2333,357.1448,818.0548,353.3317,821.8679,349.1532,813.06,353.56&quot; style=&quot;stroke: #A80036; stroke-width: 1.0;&quot;/&gt;&lt;text fill=&quot;#000000&quot; font-family=&quot;sans-serif&quot; font-size=&quot;13&quot; lengthAdjust=&quot;spacingAndGlyphs&quot; textLength=&quot;78&quot; x=&quot;2400.7&quot; y=&quot;189.5684&quot;&gt;订单强制结算&lt;/text&gt;&lt;!--MD5=[9222c13ce6476de6e0a39e4246ab1d13]
@startuml
用户端-&gt;[数据库]: 1 用户自主下单(院外订单)
用户端-&gt;[数据库]: 2 用户自主下单(院内订单)
POS机-&gt;[数据库]: POS机管理老师接单、并且派工
[批处理]-&gt;[数据库]: 2小时无人反映，取消订单
用户端-&gt;[数据库]: [￥支付 微信 ]
POS机-&gt;[数据库]: [￥收款：微信/支付宝/银行卡/现金]
[批处理]-&gt;[批处理]: 30分钟内不支付，支付状态超时
[批处理]- -&gt;[数据库]: 取消订单
[批处理]-&gt;[批处理]: 支付成功之后，2小时内处于待服务状态，超过2小时进入服务中
[批处理]- -&gt;[数据库]: 待服务-&gt;服务中
[数据库]- -&gt;用户端: 查看订单信息
[数据库]-&gt;PC端: 查看订单信息
[数据库]-&gt;护工端: 查看订单信息
护工端- -&gt;用户端: 推送服务日志
用户端-&gt;[数据库]: 发起结算
[批处理]- -&gt;[批处理]: 发起结算、向银行请求数据、进入结算中状态
[批处理]- -&gt;[批处理]: 判断结算申请的结果、
[批处理]- -&gt;[数据库]: 结算成功/结算失败 -&gt; 更新状态
[数据库]-&gt;[数据库]: 服务结束时间判断
用户端- -&gt;护工端: 订单结算
护工端- -&gt;[数据库]: 服务结算
POS机- -&gt;用户端: 订单强制结算
POS机- -&gt;护工端: 订单强制结算
用户端-&gt;[数据库]:用户评价、状态进入已评价状态
@enduml

PlantUML version 1.2020.18(Thu Oct 01 03:40:44 CST 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: CN
--&gt;&lt;/g&gt;&lt;/svg&gt;&lt;/div&gt;
&lt;h2 id=&quot;后台批处理接口说明&quot;&gt;后台批处理接口说明&lt;/h2&gt;

&lt;h3 id=&quot;01-支付超时的处理&quot;&gt;01. 支付超时的处理&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderCancelUnpaid&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 清理超过2小时的订单未支付的订单
 2 订单变更的处理，当2个小时内不支付，已经申请变更的订单自动变成过期未支付状态
 3 每天 8-20点之间，每分钟执行&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;02-订单变更审核超时的处理&quot;&gt;02. 订单变更审核超时的处理&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/cancelUnaplyToUnPayOrd&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 次日生效 24小时后 不审批 取消并且退款
 2 当日及时生效 6小时后 遍生效 取消并且退款&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;03-订单变更待服务的处理&quot;&gt;03. 订单变更待服务的处理&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderChangeSerStart&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 修改变更服务变成待服务(立即执行) 没有支付的订单变更
 2 只有审批通过的变更待服务才能进入服务状态，否者停留在永远待服务的状态
 3 每分钟执行&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;04-退款给用户的处理微信&quot;&gt;04. 退款给用户的处理（微信）&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderRefundToUser&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 判断订单状态为7，立即退款给用户
 2 每分钟执行&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;05-退款给用户的处理银联&quot;&gt;05. 退款给用户的处理（银联）&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/doRefundToUserUpay&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 判断订单状态为7，立即退款给用户
 2 每分钟执行&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;06-待服务进入服务中无需支付&quot;&gt;06. 待服务进入服务中(无需支付)&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderWaitSerToSer&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 订单支付成功2小时后，待服务进入服务中
 2 每分钟执行，订单支付时间到当前时间有2小时的订单&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;07-变更待服务进入服务中有支付&quot;&gt;07. 变更待服务进入服务中(有支付)&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/orderChangeWaitSerToSer&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 变更订单的等待状态变成开始服务 有支付状态的订单变更
 2 只有审批通过的变更待服务才能进入服务状态，否者停留在永远待服务的状态
 3 每分钟执行，订单支付时间到当前时间有2小时的订单&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;08-订单拆分&quot;&gt;08. 订单拆分&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/finSplitSttle&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 针对每个订单的拆分细则，拆分 护工工资、平台费、科室费、保险费、公司所得等费用&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;09-分账给护工站&quot;&gt;09. 分账给护工站&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/finInvoiceToStatn&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 针对每个订单的拆分细则，拆分 护工工资、平台费、科室费、保险费、公司所得等费用到具体的护工站&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;10-日结脚本&quot;&gt;10. 日结脚本&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/ordDayStt&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 针对每个订单做当日结算，消耗当天费用，并且拆分 护工工资、平台费、科室费、保险费、公司所得等费用
 2 每天12:30 23:30 跑该脚本&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;11-护工工资结算改变状态脚本&quot;&gt;11. 护工工资结算改变状态脚本&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/doSettleWrkfee&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 根据日结结果，计算每日护工工资
 2 每天1点15分 跑该脚本&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;12-订单逾期脚本&quot;&gt;12. 订单逾期脚本&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/ordFinishStt&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 结算到期订单用户未点击的订单 ，结算成逾期，并且释放床位
 2 每天1点30分 跑该脚本&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;13-订单结算状态脚本&quot;&gt;13. 订单结算状态脚本&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#&quot;&gt;http://localhost:8081/api/schd/doSttlement&lt;/a&gt;
    &lt;blockquote&gt;
      &lt;p&gt;说明：
 1 对于用户已经点击结算，护工已经点击结束服务的订单，跑的脚本
 2 分钟跑该脚本&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>kei gosling</name></author><summary type="html">01. 订单与结算逻辑.结算与支付</summary></entry><entry><title type="html">订单减免</title><link href="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E5%87%8F%E5%85%8D/" rel="alternate" type="text/html" title="订单减免" /><published>2020-10-03T00:00:00+08:00</published><updated>2020-10-03T00:00:00+08:00</updated><id>https://thefirstwind.github.io//%E8%AE%A2%E5%8D%95%E5%87%8F%E5%85%8D</id><content type="html" xml:base="https://thefirstwind.github.io//2020-10-03-%E8%AE%A2%E5%8D%95%E5%87%8F%E5%85%8D/">&lt;p&gt;qo_ord&lt;/p&gt;

&lt;p&gt;订单减免相关业务的设计&lt;/p&gt;

&lt;h3 id=&quot;订单主表--qordqo_ord&quot;&gt;订单主表  qord.qo_ord&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
1 修改条件：POS机代下单的时候，如果有优惠金额， discfg 和 discamount将发生变化
2 当有优惠的时候，影响的字段只有 discfg和 discamount
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| orduid|String|必须| 订单号|ORD_i7E_eQjRrXGKbYPscFqg7iOlsgK7|
| amount|Integer|必须| 订单初始预收金额| 90000|
| discfg|String|必须| 优惠标识discfg：0:无优惠，1：全免，2:减免医院管理费，3：减免公司收入，4：减免增收,5:团队制减免| 1，2，3，4 |
| discamount|Integer|必须| 优惠金额| 100 |&lt;/p&gt;

&lt;h3 id=&quot;订单价格表-qordqo_statn_item&quot;&gt;订单价格表 qord.qo_statn_item&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明： 无
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 字段名      |     参数类型 | 必须 | 参数说明   | 参考值|
| :——– | :——–|:——–| :—— |:—— |
| stimid|Integer|必须| 价格ID|332|
| statncd|String|必须| 护工站代码| 31010700052|
| statnnm|String|必须| 护工站名称| 同济医院(上海市同济大学附属同济医院)|
| price|String|必须| 价格| 10000|
| companyfee|String|必须| 平台费用| 500|
| plusfee|String|必须| 增收| 500|
| hospfee|String|必须| 医院管理费| 500|
| deptfee|Integer|必须| 科室费| 500|
| wrkfee|Integer|必须| 护工费| 8000|&lt;/p&gt;

&lt;h3 id=&quot;数据字典各个case相关的数据变化&quot;&gt;数据字典，各个case相关的数据变化&lt;/h3&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;说明：
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;| 优惠类型|   服务价格|  qo_ord.amount | 优惠类型&lt;br /&gt; qo_ord.discfg  | 优惠金额 &lt;br /&gt; qo_ord.discamount| 支付金额&lt;br /&gt; qo_pay_trade.amount|
| :——– | :——–|:——–| :—— |:—— |:—— |
| 0: 无优惠 |700元| 70000 |0|0|70000|
| 1: 全免 |700元|70000| 1,2,3,4| 10000|80000|
| 2: 减免医院管理费|700元|70000| 2| 30000 |40000|
| 3: 减免公司收入、4：减免增收|700元|70000| 3,4| 20000 |50000|
| 5: 团队制减免 |1700元|170000| 5| 10000 |160000|&lt;/p&gt;</content><author><name>kei gosling</name></author><summary type="html">qo_ord</summary></entry><entry><title type="html">Exclude Post from Search Index</title><link href="https://thefirstwind.github.io//jekyll/2017-11-28-post-exclude-search/" rel="alternate" type="text/html" title="Exclude Post from Search Index" /><published>2017-11-28T00:00:00+08:00</published><updated>2018-02-19T21:06:00+08:00</updated><id>https://thefirstwind.github.io//jekyll/post-exclude-search</id><content type="html" xml:base="https://thefirstwind.github.io//jekyll/2017-11-28-post-exclude-search/">&lt;p&gt;This post should not appear in the search index because it has the following YAML Front Matter:&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;false&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p class=&quot;notice--info&quot;&gt;&lt;strong&gt;Note:&lt;/strong&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;search: false&lt;/code&gt; only works to exclude posts when using Lunr as a search provider.&lt;/p&gt;

&lt;p&gt;To exclude files when using Algolia as a search provider add an array to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;algolia.files_to_exclude&lt;/code&gt; in your &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_config.yml&lt;/code&gt;. For more configuration options be sure to check their &lt;a href=&quot;https://community.algolia.com/jekyll-algolia/options.html&quot;&gt;full documentation&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;algolia&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Exclude more files from indexing&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;files_to_exclude&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;index.html&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;index.md&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;excluded-file.html&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;_posts/2017-11-28-post-exclude-search.md&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;subdirectory/*.html&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>kei gosling</name></author><category term="Jekyll" /><summary type="html">This post should not appear in the search index because it has the following YAML Front Matter:</summary></entry></feed>