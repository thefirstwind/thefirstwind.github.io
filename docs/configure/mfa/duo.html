<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | How to configure passbolt to use Duo OTP</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         Â© 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta property="og:image" content="https://thefirstwind.github.io/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="How to configure passbolt to use Duo OTP" />
    <meta property="og:description" content="" />
    <link rel="stylesheet" href="https://thefirstwind.github.io/assets/css/help.min.css">
    <link rel="stylesheet" href="https://thefirstwind.github.io/assets/css/highlight.css">
    <link rel="stylesheet" href="https://thefirstwind.github.io/assets/css/cookie-eu-banner.css">
    <link rel="canonical" href="https://thefirstwind.github.io/configure/mfa/duo">
    <link rel="shortcut icon" type="image/x-icon" href="https://thefirstwind.github.io/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Kei Gosling&#39;s blog" href="https://thefirstwind.github.io/feed.xml">

</head>


<body>
    <div id="container" class="help page background">
            <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com/"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="https://help.passbolt.com/"><span>help</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" class="highlighted" target="_blank" rel="noopener"><span>try it!</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_posts/configure/2018-11-14-configure-mfa-duo.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>

        <div class="panel main" aria-label="Content">
            <div class="panel left">
                
                







<div class="navigation-help" role="navigation">
    <ul>
        <li>
            <h2>Configure</h2>
        </li>
        
        <li >
            <a href="https://thefirstwind.github.io/configure/ldap/setup">Configure LDAP</a>
        </li>
        
        
        <li >
            <a href="https://thefirstwind.github.io/configure/mfa/yubikey">Configure Yubikey</a>
        </li>
        
        
        <li class="selected"
            >
            <a href="https://thefirstwind.github.io/configure/mfa/duo">Configure Duo</a>
        </li>
        
        
        <li >
            <a href="https://thefirstwind.github.io/configure/notification/email">Configure Email Notifications</a>
        </li>
        
        
        <li >
            <a href="https://thefirstwind.github.io/configure/ldap/ldap-with-ssl">Configure LDAP with ssl</a>
        </li>
        
        
        <li >
            <a href="https://thefirstwind.github.io/configure/ldap/ldap-common-sync-error-messages">Troubleshoot LDAP sync errors</a>
        </li>
        
        
        <li >
            <a href="https://thefirstwind.github.io/configure/environment/reference">Environment variable reference</a>
        </li>
        
        
        <li >
            <a href="https://thefirstwind.github.io/configure/email/setup">Configure Email providers</a>
        </li>
        
        
        <li >
            <a href="https://thefirstwind.github.io/configure/https">Configure HTTPS</a>
        </li>
        
        
        <li >
            <a href="https://thefirstwind.github.io/faq/hosting/why-email-not-sent">Troobleshoot Email config</a>
        </li>
        
        
    </ul>
</div>








                
            </div>
            <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
                <div class="grid grid-responsive-12">
                    <article>
                        <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="/"><span>help</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://thefirstwind.github.io/configure"><span>configure</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="https://thefirstwind.github.io/configure/mfa"><span>mfa</span></a>
                    </div>
                </li>
                
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://thefirstwind.github.io/configure/mfa/duo.html"><span>duo</span></a>
                    </div>
                </li>
                
            </ul>
        </div>
    </div>
</div>

                        <div class="row" markdown="1">
<div class="col7" markdown="1">
<h1>How to configure passbolt to use Duo OTP</h1>
</div>
</div>

                        <div class="row">
  <div class="col7">

    <p>Passbolt Pro Edition since v2.5 supports Duo as a multi factor authentication option.
Duo is a proprietary solution that is free for up to 10 users, and supports a bundle
of authentication channels (such as HOTP, mobile push, phone calls, etc.) configurable
by the Duo account administrator.</p>

    <figure>
    <img src="https://thefirstwind.github.io/assets/img/help/2018/11/mfa-duo-website.png" alt="Duo website" style="max-width:550px;" />
    <span class="legend">fig. Duo website</span>
</figure>

    <div class="message warning">
    <p>
        <strong>Important:</strong> Multi Factor Authentication is part of <a href="https://www.passbolt.com/pricing/pro">Passbolt Pro</a> only and is not available in the Community Edition.
    </p>
    
</div>

    <h2 id="security-considerations">Security considerations</h2>

    <p>It is important to enable and setup at least one additional multi factor authentication 
provider in case Duo service becomes temporarily not available.</p>

    <p>In order to use Duo authentication the user will need to interact with an iframe
with content served by passbolt. Make sure your users have access to internet or do
not enable this authentication provider if you are running passbolt on a private network
that is not connected to internet.</p>

    <h2 id="install-duo-app">Install Duo app</h2>

    <p>In order to use this authentication provider each of your users will need to install
the Duo mobile app on their phone or tablet.</p>

    <ul>
      <li><a href="https://play.google.com/store/apps/details?id=com.duosecurity.duomobile&amp;hl=en">Duo Mobile for Android</a> on google play store.</li>
      <li><a href="https://itunes.apple.com/us/app/duo-mobile/id422663827?mt=8">Duo Mobile for iOS</a> on apple itunes.</li>
    </ul>

    <figure>
    <img src="https://thefirstwind.github.io/assets/img/help/2018/11/mfa-duo-login.png" alt="Duo mobile application" style="max-width:250px;" />
    <span class="legend">fig. Duo mobile application</span>
</figure>

    <h2 id="get-a-duo-account">Get a Duo account</h2>

    <p>If you do not have a Duo account, first sign up at <a href="https://signup.duo.com/">https://signup.duo.com/</a>
Then log in to the Duo Admin panel at <a href="https://admin.duosecurity.com/login">https://admin.duosecurity.com/login</a></p>

    <p>Configure your Duo policies as required by your organization.</p>

    <h3 id="add-a-passbolt-application">Add a passbolt application</h3>

    <p>In order for passbolt to enable onboarding and authentication of new users with Duo,
you will need to create a passbolt application in Duo.</p>

    <figure>
    <img src="https://thefirstwind.github.io/assets/img/help/2018/11/mfa-duo-admin.png" alt="Duo administration" style="max-width:550px;" />
    <span class="legend">fig. Duo administration</span>
</figure>

    <p>When login in Duo Admin panel in the left menu, click on âApplicationsâ, then click on 
âProtect an Applicationâ. Find the âWeb SDKâ application and click on âProtect this Applicationâ.</p>

    <p>Note down the Integration Key, Secret Key, and API Hostname details, as you will need
them to configure the integration.</p>

    <h2 id="set-the-configuration-in-passbolt">Set the configuration in passbolt</h2>

    <p>You can configure Duo OTP using either the admin interface, config files or environment variables. If multiple settings providers are used the settings in the admin interface will override the one used in files. Similarly the settings in files will override environment variables.</p>

    <p>You will need to generate a random 40 character string to be used as salt, to help
secure your integration.</p>

    <h3 id="using-admin-user-interface">Using admin user interface</h3>

    <p>Since v2.6 a user interface is provided for administrators to setup MFA providers.
Click on âadministrationâ in the top menu, then âmulti factor authenticationâ on the left menu.
You can then enable or disable the Duo provider by providing the user id and secret key that
you gathered in the previous steps. Click âsave settingsâ when you are done.</p>

    <figure>
    <img src="https://thefirstwind.github.io/assets/img/help/2018/12/AD_mfa_org_settings_duo.png" alt="MFA organization settings for Duo" style="max-width:550px;" />
    <span class="legend">fig. MFA organization settings for Duo</span>
</figure>

    <h3 id="using-environment-variables">Using environment variables</h3>

    <table class="table-parameters">
<thead>
    <tr>
        <th>Variable name</th>
        <th>Description</th>
        <th>Type</th>
    </tr>
</thead>
<tbody>
    <tr>
        <td>PASSBOLT_PLUGINS_MFA_DUO_SALT</td>
        <td>Random salt</td>
        <td>string (40 chars min.)</td>
    </tr>
    <tr>
        <td>PASSBOLT_PLUGINS_MFA_DUO_INTEGRATIONKEY</td>
        <td>Integration key</td>
        <td>string</td>
    </tr>
    <tr>
        <td>PASSBOLT_PLUGINS_MFA_DUO_SECRETKEY</td>
        <td>Secret key</td>
        <td>string</td>
    </tr>
    <tr>
        <td>PASSBOLT_PLUGINS_MFA_DUO_HOST</td>
        <td>Host</td>
        <td>string</td>
    </tr>
</tbody>
</table>
    <p><br /></p>

    <p>When you using docker to set these environment variable you can pass them as arguments,
like other variables such as the database name, for example:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker run --name passbolt \
             -p 80:80 \
             -p 443:443 \
             -e PASSBOLT_PLUGINS_MFA_DUO_HOST=api-26e9f2fce.duosecurity.com \
             -e etc.
</code></pre></div>    </div>

    <h3 id="using-config-file">Using config file</h3>

    <p>In your install directory you can add the following section in <code class="language-plaintext highlighter-rouge">config/passbolt.php</code>
and replace the</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 'plugins' =&gt; [
        'multiFactorAuthentication' =&gt; [
            'providers' =&gt; [
                'totp' =&gt; true,
                'duo' =&gt; true,
                'yubikey' =&gt; false
            ],
            'duo' =&gt; [
                'salt' =&gt; 'THIS_MUST_BE_AT_LEAST_FOURTY_CHARACTERS',
                'integrationKey' =&gt; 'CCCCPRC95FF3FW21FR5SJ',
                'secretKey' =&gt; '7tkYNgxxXaGAuv3KWYYqhsJLfIc1NBnHDYC1siNYX',
                'hostName' =&gt; 'api-21e9fcfce.duosecurity.com'
            ]
        ]
    ]
]
</code></pre></div>    </div>

    <h2 id="setting-duo-for-a-given-passbolt-user-account">Setting Duo for a given passbolt user account</h2>

    <p>Once you have a the Duo integration configured and Duo app installed on your mobile you
can proceed with enabling Duo as provider for your user account. It is important you test
this to make sure the integration works.</p>

    <figure>
    <img src="https://thefirstwind.github.io/assets/img/help/2018/11/mfa-duo-setup.png" alt="Passbolt duo setup" style="max-width:550px;" />
    <span class="legend">fig. Passbolt duo setup</span>
</figure>

    <p>When logged in passbolt go to your profile section and click on âMulti factor authenticationâ
in the left sidebar. You should see the list of providers that are enabled for this instance.</p>

    <p>Click on the Duo provider. Passbolt will then display an iframe that will help you setup
your device if this is the first time you are using Duo with this instance. Follow the
instructions provided by Duo and you should be all set.</p>

    <p>The next time you try login from a new device, you will be presented with a Duo 
authentication prompt.</p>

    <figure>
    <img src="https://thefirstwind.github.io/assets/img/help/2018/11/mfa-duo-login2.png" alt="Login prompt" style="max-width:550px;" />
    <span class="legend">fig. Login prompt</span>
</figure>

    <div class="last-updated">
      <h3>Last updated</h3>
      <p>This article was last updated on 
November
15th,
2018.</p>
    </div>

  </div>
  <div class="col4 last push1">

    <div class="message tldr notice">
    <p>Are you experiencing issues with Passbolt Pro Edition?</p>
    <a href="mailto:contact@passbolt.com" class="button primary">Contact Pro support</a>
    <p>or <a href="https://community.passbolt.com">ask the community</a></p>

</div>

  </div>
</div>

                    </article>
                </div>
            </div>
        </div>
            <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
    <div id="cookies-eu-banner" class="visually-hidden">
        ðª &nbsp; Do you accept cookies for statistical purposes?
        <a href="https://www.passbolt.com/privacy" id="cookies-eu-more">(Read more)</a>
        <a class="button primary" id="cookies-eu-accept">Accept</a>
        <a id="cookies-eu-reject">No thanks!</a>
    </div>


    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-23506466-3"></script>
<script src="https://code.jquery.com/jquery-3.5.0.slim.min.js" integrity="sha384-/IFzzQmt1S744I+IQO4Mc1uphkxbXt1tEwjQ/qSw2p8pXWck09sLvqHmKDYYwReJ" crossorigin="anonymous"></script>
<script src="https://thefirstwind.github.io/assets/js/cookies-eu-banner.js"></script>
<script src="https://thefirstwind.github.io/assets/js/analytics.js"></script>
<script src="https://thefirstwind.github.io/assets/js/greedynav.js"></script>
</body>

</html>